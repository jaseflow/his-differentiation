(function(){var e=[/^uitk/,/\.hbs$/,/^urgency/,/^modernizr$/,/jquery/];window.define=function(h){var c=!1;try{return window.modulizr.apply(this,arguments)}catch(b){c=/^Dependency already defined/.test(b.message);if(!(c=!c)){a:{for(var c=h,d=0;d<e.length;d++)if(e[d].test(c)){c=!0;break a}c=!1}c=!c}if(c)throw b;}};window.define.amd=window.modulizr.amd={jQuery:!0};window.jQuery&&!require("jquery")&&define("jquery",function(){return window.jQuery})})();
(function(){function e(a){return function(b,c,d,k){c=w(c,k,4);var f=!x(b)&&m.keys(b),g=(f||b).length,p=0<a?0:g-1;3>arguments.length&&(d=b[f?f[p]:p],p+=a);for(var e=c,l=d;0<=p&&p<g;p+=a)var n=f?f[p]:p,l=e(l,b[n],n,b);return l}}function h(a){return function(b,c,d){c=u(c,d);d=A(b);for(var k=0<a?0:d-1;0<=k&&k<d;k+=a)if(c(b[k],k,b))return k;return-1}}function c(a,b,c){return function(d,f,g){var p=0,e=A(d);if("number"==typeof g)0<a?p=0<=g?g:Math.max(g+e,p):e=0<=g?Math.min(g+1,e):g+e+1;else if(c&&g&&e)return g=c(d,f),d[g]===f?g:-1;if(f!==f)return g=b(k.call(d,p,e),m.isNaN),0<=g?g+p:-1;for(g=0<a?p:e-1;0<=g&&g<e;g+=a)if(d[g]===f)return g;return-1}}function b(a,b){var c=K.length,d=a.constructor,d=m.isFunction(d)&&d.prototype||f,k="constructor";for(m.has(a,k)&&!m.contains(b,k)&&b.push(k);c--;)k=K[c],k in a&&a[k]!==d[k]&&!m.contains(b,k)&&b.push(k)}var d=this,l=d._,g=Array.prototype,f=Object.prototype,a=g.push,k=g.slice,p=f.toString,n=f.hasOwnProperty,q=Array.isArray,r=Object.keys,s=Function.prototype.bind,t=Object.create,v=function(){},m=function(a){if(a instanceof m)return a;if(!(this instanceof m))return new m(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=m),exports._=m):d._=m;m.VERSION="1.8.3";var w=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,k){return a.call(b,c,d,k)};case 4:return function(c,d,k,f){return a.call(b,c,d,k,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return null==a?m.identity:m.isFunction(a)?w(a,b,c):m.isObject(a)?m.matcher(a):m.property(a)};m.iteratee=function(a,b){return u(a,b,Infinity)};var z=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var k=1;k<d;k++)for(var f=arguments[k],g=a(f),p=g.length,e=0;e<p;e++){var l=g[e];b&&void 0!==c[l]||(c[l]=f[l])}return c}},y=function(a){if(!m.isObject(a))return{};if(t)return t(a);v.prototype=a;a=new v;v.prototype=null;return a},D=function(a){return function(b){return null==b?void 0:b[a]}},G=Math.pow(2,53)-1,A=D("length"),x=function(a){a=A(a);return"number"==typeof a&&0<=a&&a<=G};m.each=m.forEach=function(a,b,c){b=w(b,c);var d;if(x(a))for(c=0,d=a.length;c<d;c++)b(a[c],c,a);else{var k=m.keys(a);c=0;for(d=k.length;c<d;c++)b(a[k[c]],k[c],a)}return a};m.map=m.collect=function(a,b,c){b=u(b,c);c=!x(a)&&m.keys(a);for(var d=(c||a).length,k=Array(d),f=0;f<d;f++){var g=c?c[f]:f;k[f]=b(a[g],g,a)}return k};m.reduce=m.foldl=m.inject=e(1);m.reduceRight=m.foldr=e(-1);m.find=m.detect=function(a,b,c){b=x(a)?m.findIndex(a,b,c):m.findKey(a,b,c);if(void 0!==b&&-1!==b)return a[b]};m.filter=m.select=function(a,b,c){var d=[];b=u(b,c);m.each(a,function(a,c,k){b(a,c,k)&&d.push(a)});return d};m.reject=function(a,b,c){return m.filter(a,m.negate(u(b)),c)};m.every=m.all=function(a,b,c){b=u(b,c);c=!x(a)&&m.keys(a);for(var d=(c||a).length,k=0;k<d;k++){var f=c?c[k]:k;if(!b(a[f],f,a))return!1}return!0};m.some=m.any=function(a,b,c){b=u(b,c);c=!x(a)&&m.keys(a);for(var d=(c||a).length,k=0;k<d;k++){var f=c?c[k]:k;if(b(a[f],f,a))return!0}return!1};m.contains=m.includes=m.include=function(a,b,c,d){x(a)||(a=m.values(a));if("number"!=typeof c||d)c=0;return 0<=m.indexOf(a,b,c)};m.invoke=function(a,b){var c=k.call(arguments,2),d=m.isFunction(b);return m.map(a,function(a){var k=d?b:a[b];return null==k?k:k.apply(a,c)})};m.pluck=function(a,b){return m.map(a,m.property(b))};m.where=function(a,b){return m.filter(a,m.matcher(b))};m.findWhere=function(a,b){return m.find(a,m.matcher(b))};m.max=function(a,b,c){var d=-Infinity,k=-Infinity,f;if(null==b&&null!=a){a=x(a)?a:m.values(a);for(var g=0,p=a.length;g<p;g++)c=a[g],c>d&&(d=c)}else b=u(b,c),m.each(a,function(a,c,g){f=b(a,c,g);if(f>k||-Infinity===f&&-Infinity===d)d=a,k=f});return d};m.min=function(a,b,c){var d=Infinity,k=Infinity,f;if(null==b&&null!=a){a=x(a)?a:m.values(a);for(var g=0,p=a.length;g<p;g++)c=a[g],c<d&&(d=c)}else b=u(b,c),m.each(a,function(a,c,g){f=b(a,c,g);if(f<k||Infinity===f&&Infinity===d)d=a,k=f});return d};m.shuffle=function(a){a=x(a)?a:m.values(a);for(var b=a.length,c=Array(b),d=0,k;d<b;d++)k=m.random(0,d),k!==d&&(c[d]=c[k]),c[k]=a[d];return c};m.sample=function(a,b,c){return null==b||c?(x(a)||(a=m.values(a)),a[m.random(a.length-1)]):m.shuffle(a).slice(0,Math.max(0,b))};m.sortBy=function(a,b,c){b=u(b,c);return m.pluck(m.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var F=function(a){return function(b,c,d){var k={};c=u(c,d);m.each(b,function(d,f){var g=c(d,f,b);a(k,d,g)});return k}};m.groupBy=F(function(a,b,c){m.has(a,c)?a[c].push(b):a[c]=[b]});m.indexBy=F(function(a,b,c){a[c]=b});m.countBy=F(function(a,b,c){m.has(a,c)?a[c]++:a[c]=1});m.toArray=function(a){return a?m.isArray(a)?k.call(a):x(a)?m.map(a,m.identity):m.values(a):[]};m.size=function(a){return null==a?0:x(a)?a.length:m.keys(a).length};m.partition=function(a,b,c){b=u(b,c);var d=[],k=[];m.each(a,function(a,c,f){(b(a,c,f)?d:k).push(a)});return[d,k]};m.first=m.head=m.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:m.initial(a,a.length-b)};m.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))};m.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:m.rest(a,Math.max(0,a.length-b))};m.rest=m.tail=m.drop=function(a,b,c){return k.call(a,null==b||c?1:b)};m.compact=function(a){return m.filter(a,m.identity)};var B=function(a,b,c,d){var k=[],f=0;d=d||0;for(var g=A(a);d<g;d++){var p=a[d];if(x(p)&&(m.isArray(p)||m.isArguments(p))){b||(p=B(p,b,c));var e=0,l=p.length;for(k.length+=l;e<l;)k[f++]=p[e++]}else c||(k[f++]=p)}return k};m.flatten=function(a,b){return B(a,b,!1)};m.without=function(a){return m.difference(a,k.call(arguments,1))};m.uniq=m.unique=function(a,b,c,d){m.isBoolean(b)||(d=c,c=b,b=!1);null!=c&&(c=u(c,d));d=[];for(var k=[],f=0,g=A(a);f<g;f++){var p=a[f],e=c?c(p,f,a):p;b?(f&&k===e||d.push(p),k=e):c?m.contains(k,e)||(k.push(e),d.push(p)):m.contains(d,p)||d.push(p)}return d};m.union=function(){return m.uniq(B(arguments,!0,!0))};m.intersection=function(a){for(var b=[],c=arguments.length,d=0,k=A(a);d<k;d++){var f=a[d];if(!m.contains(b,f)){for(var g=1;g<c&&m.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b};m.difference=function(a){var b=B(arguments,!0,!0,1);return m.filter(a,function(a){return!m.contains(b,a)})};m.zip=function(){return m.unzip(arguments)};m.unzip=function(a){for(var b=a&&m.max(a,A).length||0,c=Array(b),d=0;d<b;d++)c[d]=m.pluck(a,d);return c};m.object=function(a,b){for(var c={},d=0,k=A(a);d<k;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};m.findIndex=h(1);m.findLastIndex=h(-1);m.sortedIndex=function(a,b,c,d){c=u(c,d,1);b=c(b);d=0;for(var k=A(a);d<k;){var f=Math.floor((d+k)/2);c(a[f])<b?d=f+1:k=f}return d};m.indexOf=c(1,m.findIndex,m.sortedIndex);m.lastIndexOf=c(-1,m.findLastIndex);m.range=function(a,b,c){null==b&&(b=a||0,a=0);c=c||1;b=Math.max(Math.ceil((b-a)/c),0);for(var d=Array(b),k=0;k<b;k++,a+=c)d[k]=a;return d};var C=function(a,b,c,d,k){if(!(d instanceof b))return a.apply(c,k);b=y(a.prototype);a=a.apply(b,k);return m.isObject(a)?a:b};m.bind=function(a,b){if(s&&a.bind===s)return s.apply(a,k.call(arguments,1));if(!m.isFunction(a))throw new TypeError("Bind must be called on a function");var c=k.call(arguments,2),d=function(){return C(a,d,b,this,c.concat(k.call(arguments)))};return d};m.partial=function(a){var b=k.call(arguments,1),c=function(){for(var d=0,k=b.length,f=Array(k),g=0;g<k;g++)f[g]=b[g]===m?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return C(a,c,this,this,f)};return c};m.bindAll=function(a){var b,c=arguments.length,d;if(1>=c)throw Error("bindAll must be passed function names");for(b=1;b<c;b++)d=arguments[b],a[d]=m.bind(a[d],a);return a};m.memoize=function(a,b){var c=function(d){var k=
c.cache,f=""+(b?b.apply(this,arguments):d);m.has(k,f)||(k[f]=a.apply(this,arguments));return k[f]};c.cache={};return c};m.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};m.defer=m.partial(m.delay,m,1);m.throttle=function(a,b,c){var d,k,f,g=null,p=0;c||(c={});var e=function(){p=!1===c.leading?0:m.now();g=null;f=a.apply(d,k);g||(d=k=null)};return function(){var l=m.now();p||!1!==c.leading||(p=l);var n=b-(l-p);d=this;k=arguments;0>=n||n>b?(g&&(clearTimeout(g),g=null),p=l,f=a.apply(d,k),g||(d=k=null)):g||!1===c.trailing||(g=setTimeout(e,n));return f}};m.debounce=function(a,b,c){var d,k,f,g,p,e=function(){var l=m.now()-g;l<b&&0<=l?d=setTimeout(e,b-l):(d=null,c||(p=a.apply(f,k),d||(f=k=null)))};return function(){f=this;k=arguments;g=m.now();var l=c&&!d;d||(d=setTimeout(e,b));l&&(p=a.apply(f,k),f=k=null);return p}};m.wrap=function(a,b){return m.partial(b,a)};m.negate=function(a){return function(){return!a.apply(this,arguments)}};m.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}};m.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};m.before=function(a,b){var c;return function(){0<--a&&(c=b.apply(this,arguments));1>=a&&(b=null);return c}};m.once=m.partial(m.before,2);var I=!{toString:null}.propertyIsEnumerable("toString"),K="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" ");m.keys=function(a){if(!m.isObject(a))return[];if(r)return r(a);var c=[],d;for(d in a)m.has(a,d)&&c.push(d);I&&b(a,c);return c};m.allKeys=function(a){if(!m.isObject(a))return[];var c=[],d;for(d in a)c.push(d);I&&b(a,c);return c};m.values=function(a){for(var b=m.keys(a),c=b.length,d=Array(c),k=0;k<c;k++)d[k]=a[b[k]];return d};m.mapObject=function(a,b,c){b=u(b,c);c=m.keys(a);for(var d=c.length,k={},f,g=0;g<d;g++)f=c[g],k[f]=b(a[f],f,a);return k};m.pairs=function(a){for(var b=m.keys(a),c=b.length,d=Array(c),k=0;k<c;k++)d[k]=[b[k],a[b[k]]];return d};m.invert=function(a){for(var b={},c=m.keys(a),d=0,k=c.length;d<k;d++)b[a[c[d]]]=c[d];return b};m.functions=m.methods=function(a){var b=[],c;for(c in a)m.isFunction(a[c])&&b.push(c);return b.sort()};m.extend=z(m.allKeys);m.extendOwn=m.assign=z(m.keys);m.findKey=function(a,b,c){b=u(b,c);c=m.keys(a);for(var d,k=0,f=c.length;k<f;k++)if(d=c[k],b(a[d],d,a))return d};m.pick=function(a,b,c){var d={},k=a,f,g;if(null==k)return d;m.isFunction(b)?(g=m.allKeys(k),f=w(b,c)):(g=B(arguments,!1,!1,1),f=function(a,b,c){return b in c},k=Object(k));for(var p=0,e=g.length;p<e;p++){var l=g[p],n=k[l];f(n,l,k)&&(d[l]=n)}return d};m.omit=function(a,b,c){if(m.isFunction(b))b=m.negate(b);else{var d=m.map(B(arguments,!1,!1,1),String);b=function(a,b){return!m.contains(d,b)}}return m.pick(a,b,c)};m.defaults=z(m.allKeys,!0);m.create=function(a,b){var c=y(a);b&&m.extendOwn(c,b);return c};m.clone=function(a){return m.isObject(a)?m.isArray(a)?a.slice():m.extend({},a):a};m.tap=function(a,b){b(a);return a};m.isMatch=function(a,b){var c=m.keys(b),d=c.length;if(null==a)return!d;for(var k=Object(a),f=0;f<d;f++){var g=c[f];if(b[g]!==k[g]||!(g in k))return!1}return!0};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof m&&(a=a._wrapped);b instanceof m&&(b=b._wrapped);var k=p.call(a);if(k!==p.call(b))return!1;switch(k){case "[object RegExp]":case "[object String]":return""+a===""+b;case "[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case "[object Date]":case "[object Boolean]":return+a===+b}k="[object Array]"===k;if(!k){if("object"!=typeof a||"object"!=typeof b)return!1;var f=a.constructor,g=b.constructor;if(f!==g&&!(m.isFunction(f)&&f instanceof f&&m.isFunction(g)&&g instanceof g)&&"constructor"in a&&"constructor"in b)return!1}c=c||[];d=d||[];for(f=c.length;f--;)if(c[f]===a)return d[f]===b;c.push(a);d.push(b);if(k){f=a.length;if(f!==b.length)return!1;for(;f--;)if(!H(a[f],b[f],c,d))return!1}else{k=m.keys(a);f=k.length;if(m.keys(b).length!==f)return!1;for(;f--;)if(g=k[f],!m.has(b,g)||!H(a[g],b[g],c,d))return!1}c.pop();d.pop();return!0};m.isEqual=function(a,b){return H(a,b)};m.isEmpty=function(a){return null==a?!0:x(a)&&(m.isArray(a)||m.isString(a)||m.isArguments(a))?0===a.length:0===m.keys(a).length};m.isElement=function(a){return!(!a||1!==a.nodeType)};m.isArray=q||function(a){return"[object Array]"===p.call(a)};m.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a};m.each("Arguments Function String Number Date RegExp Error".split(" "),function(a){m["is"+a]=function(b){return p.call(b)==="[object "+a+"]"}});m.isArguments(arguments)||(m.isArguments=function(a){return m.has(a,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(a){return"function"==typeof a||!1});m.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};m.isNaN=function(a){return m.isNumber(a)&&a!==+a};m.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===p.call(a)};m.isNull=function(a){return null===a};m.isUndefined=function(a){return void 0===a};m.has=function(a,b){return null!=a&&n.call(a,b)};m.noConflict=function(){d._=l;return this};m.identity=function(a){return a};m.constant=function(a){return function(){return a}};m.noop=function(){};m.property=D;m.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}};m.matcher=m.matches=function(a){a=m.extendOwn({},a);return function(b){return m.isMatch(b,a)}};m.times=function(a,b,c){var d=Array(Math.max(0,a));b=w(b,c,1);for(c=0;c<a;c++)d[c]=b(c);return d};m.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};m.now=Date.now||function(){return(new Date).getTime()};q={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","`":"\x26#x60;"};z=m.invert(q);D=function(a){var b=function(b){return a[b]},c="(?:"+m.keys(a).join("|")+")",d=RegExp(c),k=RegExp(c,"g");return function(a){a=null==a?"":""+a;return d.test(a)?a.replace(k,b):a}};m.escape=D(q);m.unescape=D(z);m.result=function(a,b,c){b=null==a?void 0:a[b];void 0===b&&(b=c);return m.isFunction(b)?b.call(a):b};var J=0;m.uniqueId=function(a){var b=++J+"";return a?a+b:b};m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(a){return"\\"+M[a]};m.template=function(a,b,c){!b&&c&&(b=c);b=m.defaults({},b,m.templateSettings);c=RegExp([(b.escape||E).source,(b.interpolate||E).source,(b.evaluate||E).source].join("|")+"|$","g");var d=0,k="__p+\x3d'";a.replace(c,function(b,c,f,g,p){k+=a.slice(d,p).replace(N,O);d=p+b.length;c?k+="'+\n((__t\x3d("+c+"))\x3d\x3dnull?'':_.escape(__t))+\n'":f?k+="'+\n((__t\x3d("+f+"))\x3d\x3dnull?'':__t)+\n'":g&&(k+="';\n"+g+"\n__p+\x3d'");return b});k+="';\n";b.variable||(k="with(obj||{}){\n"+k+"}\n");k="var __t,__p\x3d'',__j\x3dArray.prototype.join,print\x3dfunction(){__p+\x3d__j.call(arguments,'');};\n"+k+"return __p;\n";try{var f=new Function(b.variable||"obj","_",k)}catch(g){throw g.source=k,g;}c=function(a){return f.call(this,a,m)};c.source="function("+(b.variable||"obj")+"){\n"+k+"}";return c};m.chain=function(a){a=m(a);a._chain=!0;return a};var L=function(a,b){return a._chain?m(b).chain():b};m.mixin=function(b){m.each(m.functions(b),function(c){var d=m[c]=b[c];m.prototype[c]=function(){var b=[this._wrapped];a.apply(b,arguments);return L(this,d.apply(m,b))}})};m.mixin(m);m.each("pop push reverse shift sort splice unshift".split(" "),function(a){var b=g[a];m.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);"shift"!==a&&"splice"!==a||0!==c.length||delete c[0];return L(this,c)}});m.each(["concat","join","slice"],function(a){var b=g[a];m.prototype[a]=function(){return L(this,b.apply(this._wrapped,arguments))}});m.prototype.value=function(){return this._wrapped};m.prototype.valueOf=m.prototype.toJSON=
m.prototype.value;m.prototype.toString=function(){return""+this._wrapped};"function"===typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);
(function(e){var h="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"===typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(b,c,d){h.Backbone=e(h,d,b,c)});else if("undefined"!==typeof exports){var c=require("underscore"),b;try{b=require("jquery")}catch(d){}e(h,exports,c,b)}else h.Backbone=e(h,{},h._,h.jQuery||h.Zepto||h.ender||h.$)})(function(e,h,c,b){var d=e.Backbone,l=[].slice;h.VERSION="1.2.1";h.$=b;h.noConflict=function(){e.Backbone=d;return this};h.emulateHTTP=!1;h.emulateJSON=!1;var g=function(a,b,d){switch(a){case 1:return function(){return c[b](this[d])};case 2:return function(a){return c[b](this[d],a)};case 3:return function(a,k){return c[b](this[d],a,k)};case 4:return function(a,k,f){return c[b](this[d],a,k,f)};default:return function(){var a=l.call(arguments);a.unshift(this[d]);return c[b].apply(c,a)}}},f=function(a,b,d){c.each(b,function(b,k){c[k]&&(a.prototype[k]=g(b,k,d))})};b=h.Events={};var a=/\s+/,k=function(b,d,k,f,g){var p=0,e;if(k&&"object"===typeof k)for(void 0!==f&&("context"in g)&&void 0===g.context&&(g.context=f),e=c.keys(k);p<e.length;p++)d=b(d,e[p],k[e[p]],g);else if(k&&a.test(k))for(e=k.split(a);p<e.length;p++)d=b(d,e[p],f,g);else d=b(d,k,f,g);return d};b.on=function(a,b,c){return p(this,a,b,c)};var p=function(a,b,c,d,f){a._events=k(n,a._events||{},b,c,{context:d,ctx:a,listening:f});f&&((a._listeners||(a._listeners={}))[f.id]=f);return a};b.listenTo=function(a,b,d){if(!a)return this;var k=a._listenId||(a._listenId=c.uniqueId("l")),f=this._listeningTo||(this._listeningTo={}),g=f[k];g||(g=this._listenId||(this._listenId=c.uniqueId("l")),g=f[k]={obj:a,objId:k,id:g,listeningTo:f,count:0});p(a,b,d,this,g);return this};var n=function(a,b,c,d){if(c){b=a[b]||(a[b]=[]);var k=d.context,f=d.ctx;(d=d.listening)&&d.count++;b.push({callback:c,context:k,ctx:k||f,listening:d})}return a};b.off=function(a,b,c){if(!this._events)return this;this._events=k(q,this._events,a,b,{context:c,listeners:this._listeners});return this};b.stopListening=function(a,b,d){var k=this._listeningTo;if(!k)return this;a=a?[a._listenId]:c.keys(k);for(var f=0;f<a.length;f++){var g=k[a[f]];if(!g)break;g.obj.off(b,d,this)}c.isEmpty(k)&&(this._listeningTo=void 0);return this};var q=function(a,b,d,k){if(a){var f=0,g,p=k.context;k=k.listeners;if(b||d||p){for(var e=b?[b]:c.keys(a);f<e.length;f++){b=e[f];var l=a[b];if(!l)break;for(var n=[],m=0;m<l.length;m++)g=l[m],d&&d!==g.callback&&d!==g.callback._callback||p&&p!==g.context?n.push(g):(g=g.listening)&&0===--g.count&&(delete k[g.id],delete g.listeningTo[g.objId]);n.length?a[b]=n:delete a[b]}if(c.size(a))return a}else for(a=c.keys(k);f<a.length;f++)g=k[a[f]],delete k[g.id],delete g.listeningTo[g.objId]}};b.once=function(a,b,d){a=k(r,{},a,b,c.bind(this.off,this));return this.on(a,void 0,d)};b.listenToOnce=function(a,b,d){b=k(r,{},b,d,c.bind(this.stopListening,this,a));return this.listenTo(a,b)};var r=function(a,b,d,k){if(d){var f=a[b]=c.once(function(){k(b,f);d.apply(this,arguments)});f._callback=d}return a};b.trigger=function(a){if(!this._events)return this;for(var b=Math.max(0,arguments.length-1),c=Array(b),d=0;d<b;d++)c[d]=arguments[d+1];k(s,this._events,a,void 0,c);return this};var s=function(a,b,c,d){if(a){c=a[b];var k=a.all;c&&k&&(k=k.slice());c&&t(c,d);k&&t(k,[b].concat(d))}return a},t=function(a,b){var c,d=-1,k=a.length,f=b[0],g=b[1],p=b[2];switch(b.length){case 0:for(;++d<k;)(c=a[d]).callback.call(c.ctx);break;case 1:for(;++d<k;)(c=a[d]).callback.call(c.ctx,f);break;case 2:for(;++d<k;)(c=a[d]).callback.call(c.ctx,f,g);break;case 3:for(;++d<k;)(c=a[d]).callback.call(c.ctx,f,g,p);break;default:for(;++d<k;)(c=a[d]).callback.apply(c.ctx,b)}};b.bind=b.on;b.unbind=b.off;c.extend(h,b);var v=h.Model=function(a,b){var d=a||{};b||(b={});this.cid=c.uniqueId(this.cidPrefix);this.attributes={};b.collection&&(this.collection=b.collection);b.parse&&(d=this.parse(d,b)||{});d=c.defaults({},d,c.result(this,"defaults"));this.set(d,b);this.changed={};this.initialize.apply(this,arguments)};c.extend(v.prototype,b,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return h.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},matches:function(a){return!!c.iteratee(a,this)(this.attributes)},set:function(a,b,d){if(null==a)return this;var k;"object"===typeof a?(k=a,d=b):(k={})[a]=b;d||(d={});if(!this._validate(k,d))return!1;var f=d.unset;a=d.silent;var g=[],p=this._changing;this._changing=!0;p||(this._previousAttributes=c.clone(this.attributes),this.changed={});var e=this.attributes,l=this.changed,n=this._previousAttributes;this.idAttribute in k&&(this.id=k[this.idAttribute]);for(var m in k)b=k[m],c.isEqual(e[m],b)||g.push(m),c.isEqual(n[m],b)?delete l[m]:l[m]=b,f?delete e[m]:e[m]=b;if(!a)for(g.length&&(this._pending=d),b=0;b<g.length;b++)this.trigger("change:"+g[b],this,e[g[b]],d);if(p)return this;if(!a)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);this._changing=this._pending=!1;return this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={},d;for(d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b=this._changing?this._previousAttributes:this.attributes,d={},k;for(k in a){var f=a[k];c.isEqual(b[k],f)||(d[k]=f)}return c.size(d)?d:!1},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=c.extend({parse:!0},a);var b=this,d=a.success;a.success=function(c){var k=a.parse?b.parse(c,a):c;if(!b.set(k,a))return!1;d&&d.call(a.context,b,c,a);b.trigger("sync",b,c,a)};E(this,a);return this.sync("read",this,a)},save:function(a,b,d){var k;null==a||"object"===typeof a?(k=a,d=b):(k={})[a]=b;d=c.extend({validate:!0,parse:!0},d);var f=d.wait;if(k&&!f){if(!this.set(k,d))return!1}else if(!this._validate(k,d))return!1;var g=this,p=d.success,e=this.attributes;d.success=function(a){g.attributes=e;var b=d.parse?g.parse(a,d):a;f&&(b=c.extend({},k,b));if(b&&!g.set(b,d))return!1;p&&p.call(d.context,g,a,d);g.trigger("sync",g,a,d)};E(this,d);k&&f&&(this.attributes=c.extend({},e,k));a=this.isNew()?"create":d.patch?"patch":"update";"patch"!==a||d.attrs||(d.attrs=k);a=this.sync(a,this,d);this.attributes=e;return a},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,k=a.wait,f=function(){b.stopListening();b.trigger("destroy",b,b.collection,a)};a.success=function(c){k&&f();d&&d.call(a.context,b,c,a);b.isNew()||b.trigger("sync",b,c,a)};var g=!1;this.isNew()?c.defer(a.success):(E(this,a),g=this.sync("delete",this,a));k||f();return g},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||J();if(this.isNew())return a;var b=this.get(this.idAttribute);return a.replace(/[^\/]$/,"$\x26/")+encodeURIComponent(b)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.defaults({validate:!0},a))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;if(!d)return!0;this.trigger("invalid",this,d,c.extend(b,{validationError:d}));return!1}});f(v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var m=h.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);
a&&this.reset(a,c.extend({silent:!0},b))},w={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1};c.extend(m.prototype,b,{model:v,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return h.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,u))},remove:function(a,b){b=c.extend({},b);var d=!c.isArray(a);a=d?[a]:c.clone(a);var k=this._removeModels(a,b);!b.silent&&k&&this.trigger("update",this,b);return d?k[0]:k},set:function(a,b){b=c.defaults({},b,w);b.parse&&!this._isModel(a)&&(a=this.parse(a,b));var d=!c.isArray(a);a=d?a?[a]:[]:a.slice();var k,f,g,p,e=b.at;null!=e&&(e=+e);0>e&&(e+=this.length+1);for(var l=this.comparator&&null==e&&!1!==b.sort,n=c.isString(this.comparator)?this.comparator:null,m=[],h=[],v={},q=b.add,y=b.merge,r=b.remove,s=!l&&q&&r?[]:!1,t=!1,u=0;u<a.length;u++){k=a[u];if(g=this.get(k))r&&(v[g.cid]=!0),y&&k!==g&&(k=this._isModel(k)?k.attributes:k,b.parse&&(k=g.parse(k,b)),g.set(k,b),l&&!p&&g.hasChanged(n)&&(p=!0)),a[u]=g;else if(q){f=a[u]=this._prepareModel(k,b);if(!f)continue;m.push(f);this._addReference(f,b)}if(f=g||f)k=this.modelId(f.attributes),!s||!f.isNew()&&v[k]||(s.push(f),t=t||!this.models[u]||f.cid!==this.models[u].cid),v[k]=!0}if(r){for(u=0;u<this.length;u++)v[(f=this.models[u]).cid]||h.push(f);h.length&&this._removeModels(h,b)}if(m.length||t)if(l&&(p=!0),this.length+=m.length,null!=e)for(u=0;u<m.length;u++)this.models.splice(e+u,0,m[u]);else for(s&&(this.models.length=0),l=s||m,u=0;u<l.length;u++)this.models.push(l[u]);p&&this.sort({silent:!0});if(!b.silent){l=null!=e?c.clone(b):b;for(u=0;u<m.length;u++)null!=e&&(l.index=e+u),(f=m[u]).trigger("add",f,this,l);(p||t)&&this.trigger("sort",this,b);(m.length||h.length)&&this.trigger("update",this,b)}return d?a[0]:a},reset:function(a,b){b=b?c.clone(b):{};for(var d=0;d<this.models.length;d++)this._removeReference(this.models[d],b);b.previousModels=this.models;this._reset();a=this.add(a,c.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a)},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a)},slice:function(){return l.apply(this.models,arguments)},get:function(a){if(null!=a){var b=this.modelId(this._isModel(a)?a.attributes:a);return this._byId[a]||this._byId[b]||this._byId[a.cid]}},at:function(a){0>a&&(a+=this.length);return this.models[a]},where:function(a,b){var d=c.matches(a);return this[b?"find":"filter"](function(a){return d(a.attributes)})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");a||(a={});c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){a=c.extend({parse:!0},a);var b=a.success,d=this;a.success=function(c){d[a.reset?"reset":"set"](c,a);b&&b.call(a.context,d,c,a);d.trigger("sync",d,c,a)};E(this,a);return this.sync("read",this,a)},create:function(a,b){b=b?c.clone(b):{};var d=b.wait;a=this._prepareModel(a,b);if(!a)return!1;d||this.add(a,b);var k=this,f=b.success;b.success=function(a,b,c){d&&k.add(a,c);f&&f.call(c.context,a,b,c)};a.save(null,b);return a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(a){return a[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(this._isModel(a))return a.collection||(a.collection=this),a;b=b?c.clone(b):{};b.collection=this;var d=new this.model(a,b);if(!d.validationError)return d;this.trigger("invalid",this,d.validationError,b);return!1},_removeModels:function(a,b){for(var c=[],d=0;d<a.length;d++){var k=this.get(a[d]);if(k){var f=this.indexOf(k);this.models.splice(f,1);this.length--;b.silent||(b.index=f,k.trigger("remove",k,this,b));c.push(k);this._removeReference(k,b)}}return c.length?c:!1},_isModel:function(a){return a instanceof v},_addReference:function(a,b){this._byId[a.cid]=a;var c=this.modelId(a.attributes);null!=c&&(this._byId[c]=a);a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){delete this._byId[a.cid];var c=this.modelId(a.attributes);null!=c&&delete this._byId[c];this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if("add"!==a&&"remove"!==a||c===this){"destroy"===a&&this.remove(b,d);if("change"===a){var k=this.modelId(b.previousAttributes()),f=this.modelId(b.attributes);k!==f&&(null!=k&&delete this._byId[k],null!=f&&(this._byId[f]=b))}this.trigger.apply(this,arguments)}}});f(m,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3},"models");c.each(["groupBy","countBy","sortBy","indexBy"],function(a){c[a]&&(m.prototype[a]=function(b,d){var k=c.isFunction(b)?b:function(a){return a.get(b)};return c[a](this.models,k,d)})});var f=h.View=function(a){this.cid=c.uniqueId("view");c.extend(this,c.pick(a,y));this._ensureElement();this.initialize.apply(this,arguments)},z=/^(\S+)\s*(.*)$/,y="model collection el id attributes className tagName events".split(" ");c.extend(f.prototype,b,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(a){this.undelegateEvents();this._setElement(a);this.delegateEvents();return this},_setElement:function(a){this.$el=a instanceof h.$?a:h.$(a);this.el=this.$el[0]},delegateEvents:function(a){a||(a=c.result(this,"events"));if(!a)return this;this.undelegateEvents();for(var b in a){var d=a[b];c.isFunction(d)||(d=this[d]);if(d){var k=b.match(z);this.delegate(k[1],k[2],c.bind(d,this))}}return this},delegate:function(a,b,c){this.$el.on(a+".delegateEvents"+this.cid,b,c);return this},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid);return this},undelegate:function(a,b,c){this.$el.off(a+".delegateEvents"+this.cid,b,c);return this},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"));else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id"));this.className&&(a["class"]=c.result(this,"className"));this.setElement(this._createElement(c.result(this,"tagName")));this._setAttributes(a)}},_setAttributes:function(a){this.$el.attr(a)}});h.sync=function(a,b,d){var k=D[a];c.defaults(d||(d={}),{emulateHTTP:h.emulateHTTP,emulateJSON:h.emulateJSON});var f={type:k,dataType:"json"};d.url||(f.url=c.result(b,"url")||J());null!=d.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(f.contentType="application/json",f.data=JSON.stringify(d.attrs||b.toJSON(d)));d.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{});if(d.emulateHTTP&&("PUT"===k||"DELETE"===k||"PATCH"===k)){f.type="POST";d.emulateJSON&&(f.data._method=k);var g=d.beforeSend;d.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",k);if(g)return g.apply(this,arguments)}}"GET"===f.type||d.emulateJSON||(f.processData=!1);var p=d.error;d.error=function(a,b,c){d.textStatus=b;d.errorThrown=c;p&&p.call(d.context,a,b,c)};a=d.xhr=h.ajax(c.extend(f,d));b.trigger("request",b,a,d);return a};var D={create:"POST",update:"PUT",
patch:"PATCH","delete":"DELETE",read:"GET"};h.ajax=function(){return h.$.ajax.apply(h.$,arguments)};var G=h.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,F=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(G.prototype,b,{initialize:function(){},route:function(a,b,d){c.isRegExp(a)||(a=this._routeToRegExp(a));c.isFunction(b)&&(d=b,b="");d||(d=this[b]);var k=this;h.history.route(a,function(c){c=k._extractParameters(a,c);!1!==k.execute(d,c,b)&&(k.trigger.apply(k,["route:"+b].concat(c)),k.trigger("route",b,c),h.history.trigger("route",k,b,c))});return this},execute:function(a,b,c){a&&a.apply(this,b)},navigate:function(a,b){h.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){a=a.replace(B,"\\$\x26").replace(A,"(?:$1)?").replace(x,function(a,b){return b?a:"([^/?]+)"}).replace(F,"([^?]*?)");return new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var C=h.History=function(){this.handlers=[];c.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,K=/^\/+|\/+$/g,H=/#.*$/;C.started=!1;c.extend(C.prototype,b,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$\x26/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(a){return decodeURI(a.replace(/%25/g,"%2525"))},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getPath:function(){var a=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){null==a&&(a=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash());return a.replace(I,"")},start:function(a){if(C.started)throw Error("Backbone.history has already been started");C.started=!0;this.options=c.extend({root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._hasHashChange="onhashchange"in window;this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.history||!this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(K,"/");if(this._wantsHashChange&&this._wantsPushState)if(this._hasPushState||this.atRoot())this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});else return a=this.root.slice(0,-1)||"/",this.location.replace(a+"#"+this.getPath()),!0;this._hasHashChange||!this._wantsHashChange||this._usePushState||(this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1,a=document.body,a=a.insertBefore(this.iframe,a.firstChild).contentWindow,a.document.open(),a.document.close(),a.location.hash="#"+this.fragment);a=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?a("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(!this.options.silent)return this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&a("hashchange",this.checkUrl,!1);this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null);this._checkUrlInterval&&clearInterval(this._checkUrlInterval);C.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getHash(this.iframe.contentWindow));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()},loadUrl:function(a){if(!this.matchRoot())return!1;a=this.fragment=this.getFragment(a);return c.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!C.started)return!1;b&&!0!==b||(b={trigger:!!b});a=this.getFragment(a||"");var c=this.root;if(""===a||"?"===a.charAt(0))c=c.slice(0,-1)||"/";c+=a;a=this.decodeFragment(a.replace(H,""));if(this.fragment!==a){this.fragment=a;if(this._usePushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getHash(this.iframe.contentWindow)&&(c=this.iframe.contentWindow,b.replace||(c.document.open(),c.document.close()),this._updateHash(c.location,a,b.replace));else return this.location.assign(c);if(b.trigger)return this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});h.history=new C;v.extend=m.extend=G.extend=f.extend=C.extend=function(a,b){var d=this,k;k=a&&c.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)};c.extend(k,d,b);var f=function(){this.constructor=k};f.prototype=d.prototype;k.prototype=new f;a&&c.extend(k.prototype,a);k.__super__=d.prototype;return k};var J=function(){throw Error('A "url" property or function must be specified');},E=function(a,b){var c=b.error;b.error=function(d){c&&c.call(b.context,a,d,b);a.trigger("error",a,d,b)}};return h});
(function(e,h){if("function"===typeof define&&define.amd)define("marionette",["backbone","underscore"],function(b,c){return e.Marionette=e.Mn=h(e,b,c)});else if("undefined"!==typeof exports){var c=require("backbone"),b=require("underscore");module.exports=h(e,c,b)}else e.Marionette=e.Mn=h(e,e.Backbone,e._)})(this,function(e,h,c){(function(a,b){var c=a.ChildViewContainer;a.ChildViewContainer=function(a,b){var c=function(a){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();b.each(a,this.add,this)};b.extend(c.prototype,{add:function(a,b){var c=a.cid;this._views[c]=a;a.model&&(this._indexByModel[a.model.cid]=c);b&&(this._indexByCustom[b]=c);this._updateLength();return this},findByModel:function(a){return this.findByModelCid(a.cid)},findByModelCid:function(a){return this.findByCid(this._indexByModel[a])},findByCustom:function(a){return this.findByCid(this._indexByCustom[a])},findByIndex:function(a){return b.values(this._views)[a]},findByCid:function(a){return this._views[a]},remove:function(a){var c=a.cid;a.model&&delete this._indexByModel[a.model.cid];b.any(this._indexByCustom,function(a,b){if(a===c)return delete this._indexByCustom[b],!0},this);delete this._views[c];this._updateLength();return this},call:function(a){this.apply(a,b.tail(arguments))},apply:function(a,c){b.each(this._views,function(d){b.isFunction(d[a])&&d[a].apply(d,c||[])})},_updateLength:function(){this.length=b.size(this._views)}});b.each("forEach each map find detect filter select reject every all some any include contains invoke toArray first initial rest last without isEmpty pluck reduce".split(" "),function(a){c.prototype[a]=function(){var c=[b.values(this._views)].concat(b.toArray(arguments));return b[a].apply(b,c)}});return c}(a,b);a.ChildViewContainer.VERSION="0.1.10";a.ChildViewContainer.noConflict=function(){a.ChildViewContainer=c;return this};return a.ChildViewContainer})(h,c);(function(a,b){var c=a.Wreqr,d=a.Wreqr={};a.Wreqr.VERSION="1.3.5";a.Wreqr.noConflict=function(){a.Wreqr=c;return this};d.Handlers=function(a,b){var c=function(a){this.options=a;this._wreqrHandlers={};b.isFunction(this.initialize)&&this.initialize(a)};c.extend=a.Model.extend;b.extend(c.prototype,a.Events,{setHandlers:function(a){b.each(a,function(a,c){var d=null;b.isObject(a)&&!b.isFunction(a)&&(d=a.context,a=a.callback);this.setHandler(c,a,d)},this)},setHandler:function(a,b,c){this._wreqrHandlers[a]={callback:b,context:c};this.trigger("handler:add",a,b,c)},hasHandler:function(a){return!!this._wreqrHandlers[a]},getHandler:function(a){var b=this._wreqrHandlers[a];if(b)return function(){return b.callback.apply(b.context,arguments)}},removeHandler:function(a){delete this._wreqrHandlers[a]},removeAllHandlers:function(){this._wreqrHandlers={}}});return c}(a,b);d.CommandStorage=function(){var c=function(a){this.options=a;this._commands={};b.isFunction(this.initialize)&&this.initialize(a)};b.extend(c.prototype,a.Events,{getCommands:function(a){var b=this._commands[a];b||(b={command:a,instances:[]},this._commands[a]=b);return b},addCommand:function(a,b){this.getCommands(a).instances.push(b)},clearCommands:function(a){this.getCommands(a).instances=[]}});return c}();d.Commands=function(a,b){return a.Handlers.extend({storageType:a.CommandStorage,constructor:function(b){this.options=b||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);a.Handlers.prototype.constructor.apply(this,arguments)},execute:function(a){a=arguments[0];var c=b.rest(arguments);this.hasHandler(a)?this.getHandler(a).apply(this,c):this.storage.addCommand(a,c)},_executeCommands:function(a,c,d){var k=this.storage.getCommands(a);b.each(k.instances,function(a){c.apply(d,a)});this.storage.clearCommands(a)},_initializeStorage:function(a){a=a.storageType||this.storageType;this.storage=b.isFunction(a)?new a:a}})}(d,b);d.RequestResponse=function(a,b){return a.Handlers.extend({request:function(a){if(this.hasHandler(a))return this.getHandler(a).apply(this,b.rest(arguments))}})}(d,b);d.EventAggregator=function(a,b){var c=function(){};c.extend=a.Model.extend;b.extend(c.prototype,a.Events);return c}(a,b);d.Channel=function(c){c=function(b){this.vent=new a.Wreqr.EventAggregator;this.reqres=new a.Wreqr.RequestResponse;this.commands=new a.Wreqr.Commands;this.channelName=b};b.extend(c.prototype,{reset:function(){this.vent.off();this.vent.stopListening();this.reqres.removeAllHandlers();this.commands.removeAllHandlers();return this},connectEvents:function(a,b){this._connect("vent",a,b);return this},connectCommands:function(a,b){this._connect("commands",a,b);return this},connectRequests:function(a,b){this._connect("reqres",a,b);return this},_connect:function(a,c,d){if(c){d=d||this;var f="vent"===a?"on":"setHandler";b.each(c,function(c,g){this[a][f](g,b.bind(c,d))},this)}}});return c}(d);d.radio=function(a,b){var c=function(){this._channels={};this.vent={};this.commands={};this.reqres={};this._proxyMethods()};b.extend(c.prototype,{channel:function(a){if(!a)throw Error("Channel must receive a name");return this._getChannel(a)},_getChannel:function(b){var c=this._channels[b];c||(c=new a.Channel(b),this._channels[b]=c);return c},_proxyMethods:function(){b.each(["vent","commands","reqres"],function(a){b.each(d[a],function(b){this[a][b]=k(this,a,b)},this)},this)}});var d={vent:"on off trigger once stopListening listenTo listenToOnce".split(" "),commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},k=function(a,c,d){return function(k){var f=a._getChannel(k)[c];return f[d].apply(f,b.rest(arguments))}};return new c}(d,b);return a.Wreqr})(h,c);var b=e.Marionette,d=e.Mn,l=h.Marionette={};l.VERSION="2.4.4";l.noConflict=function(){e.Marionette=b;e.Mn=d;return this};h.Marionette=l;l.Deferred=h.$.Deferred;l.extend=h.Model.extend;l.isNodeAttached=function(a){return h.$.contains(document.documentElement,a)};l.mergeOptions=function(a,b){a&&c.extend(this,c.pick(a,b))};l.getOption=function(a,b){if(a&&b)return a.options&&void 0!==a.options[b]?a.options[b]:a[b]};l.proxyGetOption=function(a){return l.getOption(this,a)};l._getValue=function(a,b,d){c.isFunction(a)&&(a=d?a.apply(b,d):a.call(b));return a};l.normalizeMethods=function(a){return c.reduce(a,function(a,b,d){c.isFunction(b)||(b=this[b]);b&&(a[d]=b);return a},{},this)};l.normalizeUIString=function(a,b){return a.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(a){return b[a.slice(4)]})};l.normalizeUIKeys=function(a,b){return c.reduce(a,function(a,c,d){d=l.normalizeUIString(d,b);a[d]=c;return a},{})};l.normalizeUIValues=function(a,b,d){c.each(a,function(f,g){c.isString(f)?a[g]=l.normalizeUIString(f,b):c.isObject(f)&&c.isArray(d)&&(c.extend(f,l.normalizeUIValues(c.pick(f,d),b)),c.each(d,function(a){var d=f[a];c.isString(d)&&(f[a]=l.normalizeUIString(d,b))}))});return a};l.actAsCollection=function(a,b){c.each("forEach each map find detect filter select reject every all some any include contains invoke toArray first initial rest last without isEmpty pluck".split(" "),function(d){a[d]=function(){var a=[c.values(c.result(this,b))].concat(c.toArray(arguments));return c[d].apply(c,a)}})};var g=l.deprecate=function(a,b){c.isObject(a)&&(a=a.prev+" is going to be removed in the future. Please use "+a.next+" instead."+(a.url?" See: "+a.url:""));void 0!==b&&b||g._cache[a]||(g._warn("Deprecation warning: "+a),g._cache[a]=!0)};g._warn="undefined"!==typeof console&&(console.warn||console.log)||function(){};g._cache={};l._triggerMethod=function(){function a(a,b,c){return c.toUpperCase()}var b=/(^|:)(\w)/gi;return function(d,f,g){var e=3>arguments.length;e&&(g=f,f=g[0]);var l="on"+f.replace(b,a),l=d[l],h;c.isFunction(l)&&(h=l.apply(d,e?c.rest(g):g));c.isFunction(d.trigger)&&(1<e+g.length?d.trigger.apply(d,e?g:[f].concat(c.drop(g,0))):d.trigger(f));return h}}();l.triggerMethod=function(a){return l._triggerMethod(this,arguments)};l.triggerMethodOn=function(a){return(c.isFunction(a.triggerMethod)?
a.triggerMethod:l.triggerMethod).apply(a,c.rest(arguments))};l.MonitorDOMRefresh=function(a){function b(){a._isShown=!0;d()}function c(){a._isRendered=!0;d()}function d(){a._isShown&&a._isRendered&&l.isNodeAttached(a.el)&&l.triggerMethodOn(a,"dom:refresh",a)}a._isDomRefreshMonitored||(a._isDomRefreshMonitored=!0,a.on({show:b,render:c}))};(function(a){function b(d,k,f,g){g=g.split(/\s+/);c.each(g,function(b){var c=d[b];if(!c)throw new a.Error('Method "'+b+'" was configured as an event handler, but does not exist.');d.listenTo(k,f,c)})}function d(a,b,c,k){a.listenTo(b,c,k)}function f(a,b,d,k){k=k.split(/\s+/);c.each(k,function(c){a.stopListening(b,d,a[c])})}function g(a,b,c,d){a.stopListening(b,c,d)}function e(b,d,k,f,g){if(d&&k){if(!c.isObject(k))throw new a.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});k=a._getValue(k,b);c.each(k,function(a,k){c.isFunction(a)?f(b,d,k,a):g(b,d,k,a)})}}a.bindEntityEvents=function(a,c,f){e(a,c,f,d,b)};a.unbindEntityEvents=function(a,b,c){e(a,b,c,g,f)};a.proxyBindEntityEvents=function(b,c){return a.bindEntityEvents(this,b,c)};a.proxyUnbindEntityEvents=function(b,c){return a.unbindEntityEvents(this,b,c)}})(l);var f="description fileName lineNumber name message number".split(" ");l.Error=l.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+l.VERSION+"/",constructor:function(a,b){c.isObject(a)?(b=a,a=b.message):b||(b={});var d=Error.call(this,a);c.extend(this,c.pick(d,f),c.pick(b,f));this.captureStackTrace();b.url&&(this.url=this.urlRoot+b.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,l.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});l.Error.extend=l.extend;l.Callbacks=function(){this._deferred=l.Deferred();this._callbacks=[]};c.extend(l.Callbacks.prototype,{add:function(a,b){var d=c.result(this._deferred,"promise");this._callbacks.push({cb:a,ctx:b});d.then(function(c){b&&(c.context=b);a.call(c.context,c.options)})},run:function(a,b){this._deferred.resolve({options:a,context:b})},reset:function(){var a=this._callbacks;this._deferred=l.Deferred();this._callbacks=[];c.each(a,function(a){this.add(a.cb,a.ctx)},this)}});l.Controller=function(a){this.options=a||{};c.isFunction(this.initialize)&&this.initialize(this.options)};l.Controller.extend=l.extend;c.extend(l.Controller.prototype,h.Events,{destroy:function(){l._triggerMethod(this,"before:destroy",arguments);l._triggerMethod(this,"destroy",arguments);this.stopListening();this.off();return this},triggerMethod:l.triggerMethod,mergeOptions:l.mergeOptions,getOption:l.proxyGetOption});l.Object=function(a){this.options=c.extend({},c.result(this,"options"),a);this.initialize.apply(this,arguments)};l.Object.extend=l.extend;c.extend(l.Object.prototype,h.Events,{initialize:function(){},destroy:function(a){a=a||{};this.triggerMethod("before:destroy",a);this.triggerMethod("destroy",a);this.stopListening();return this},triggerMethod:l.triggerMethod,mergeOptions:l.mergeOptions,getOption:l.proxyGetOption,bindEntityEvents:l.proxyBindEntityEvents,unbindEntityEvents:l.proxyUnbindEntityEvents});l.Region=l.Object.extend({constructor:function(a){this.options=a||{};this.el=this.getOption("el");this.el=this.el instanceof h.$?this.el[0]:this.el;if(!this.el)throw new l.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el);l.Object.call(this,a)},show:function(a,b){if(this._ensureElement()){this._ensureViewIsIntact(a);l.MonitorDOMRefresh(a);var d=b||{},f=a!==this.currentView,g=!!d.preventDestroy,e=!!d.forceShow,h=!!this.currentView,g=f&&!g,f=f||e;h&&this.triggerMethod("before:swapOut",this.currentView,this,b);this.currentView&&delete this.currentView._parent;g?this.empty():h&&f&&this.currentView.off("destroy",this.empty,this);f&&(a.once("destroy",this.empty,this),a._parent=this,this._renderView(a),h&&this.triggerMethod("before:swap",a,this,b),this.triggerMethod("before:show",a,this,b),l.triggerMethodOn(a,"before:show",a,this,b),h&&this.triggerMethod("swapOut",this.currentView,this,b),f=l.isNodeAttached(this.el),e=[],d=c.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},d),f&&d.triggerBeforeAttach&&(e=this._displayedViews(a),this._triggerAttach(e,"before:")),this.attachHtml(a),this.currentView=a,f&&d.triggerAttach&&(e=this._displayedViews(a),this._triggerAttach(e)),h&&this.triggerMethod("swap",a,this,b),this.triggerMethod("show",a,this,b),l.triggerMethodOn(a,"show",a,this,b));return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(a,b){var d=(b||"")+"attach";c.each(a,function(a){l.triggerMethodOn(a,d,a,this)},this)},_displayedViews:function(a){return c.union([a],c.result(a,"_getNestedViews")||[])},_renderView:function(a){a.supportsRenderLifecycle||l.triggerMethodOn(a,"before:render",a);a.render();a.supportsRenderLifecycle||l.triggerMethodOn(a,"render",a)},_ensureElement:function(){c.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]);if(!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new l.Error('An "el" '+this.$el.selector+" must exist in DOM");}return!0},_ensureViewIsIntact:function(a){if(!a)throw new l.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(a.isDestroyed)throw new l.Error({name:"ViewDestroyedError",message:'View (cid: "'+a.cid+'") has already been destroyed and cannot be used.'});},getEl:function(a){return h.$(a,l._getValue(this.options.parentEl,this))},attachHtml:function(a){this.$el.contents().detach();this.el.appendChild(a.el)},empty:function(a){var b=this.currentView;a=!!(a||{}).preventDestroy;if(!b)return this;b.off("destroy",this.empty,this);this.triggerMethod("before:empty",b);a||this._destroyView();this.triggerMethod("empty",b);delete this.currentView;a&&this.$el.contents().detach();return this},_destroyView:function(){var a=this.currentView;a.isDestroyed||(a.supportsDestroyLifecycle||l.triggerMethodOn(a,"before:destroy",a),a.destroy?a.destroy():(a.remove(),a.isDestroyed=!0),a.supportsDestroyLifecycle||l.triggerMethodOn(a,"destroy",a))},attachView:function(a){this.currentView&&delete this.currentView._parent;a._parent=this;this.currentView=a;return this},hasView:function(){return!!this.currentView},reset:function(){this.empty();this.$el&&(this.el=this.$el.selector);delete this.$el;return this}},{buildRegion:function(a,b){if(c.isString(a))return this._buildRegionFromSelector(a,b);if(a.selector||a.el||a.regionClass)return this._buildRegionFromObject(a,b);if(c.isFunction(a))return this._buildRegionFromRegionClass(a);throw new l.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"});},_buildRegionFromSelector:function(a,b){return new b({el:a})},_buildRegionFromObject:function(a,b){var d=a.regionClass||b,f=c.omit(a,"selector","regionClass");a.selector&&!f.el&&(f.el=a.selector);return new d(f)},_buildRegionFromRegionClass:function(a){return new a}});l.RegionManager=l.Controller.extend({constructor:function(a){this._regions={};this.length=0;l.Controller.call(this,a);this.addRegions(this.getOption("regions"))},addRegions:function(a,b){a=l._getValue(a,this,arguments);return c.reduce(a,function(a,d,f){c.isString(d)&&(d={selector:d});d.selector&&(d=c.defaults({},d,b));a[f]=this.addRegion(f,d);return a},{},this)},addRegion:function(a,b){var c;c=b instanceof l.Region?b:l.Region.buildRegion(b,l.Region);this.triggerMethod("before:add:region",a,c);c._parent=this;this._store(a,c);this.triggerMethod("add:region",a,c);return c},get:function(a){return this._regions[a]},getRegions:function(){return c.clone(this._regions)},removeRegion:function(a){var b=this._regions[a];this._remove(a,b);return b},removeRegions:function(){var a=this.getRegions();c.each(this._regions,function(a,b){this._remove(b,a)},this);return a},emptyRegions:function(){var a=
this.getRegions();c.invoke(a,"empty");return a},destroy:function(){this.removeRegions();return l.Controller.prototype.destroy.apply(this,arguments)},_store:function(a,b){this._regions[a]||this.length++;this._regions[a]=b},_remove:function(a,b){this.triggerMethod("before:remove:region",a,b);b.empty();b.stopListening();delete b._parent;delete this._regions[a];this.length--;this.triggerMethod("remove:region",a,b)}});l.actAsCollection(l.RegionManager.prototype,"_regions");l.TemplateCache=function(a){this.templateId=a};c.extend(l.TemplateCache,{templateCaches:{},get:function(a,b){var c=this.templateCaches[a];c||(c=new l.TemplateCache(a),this.templateCaches[a]=c);return c.load(b)},clear:function(){var a,b=c.toArray(arguments),d=b.length;if(0<d)for(a=0;a<d;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}});c.extend(l.TemplateCache.prototype,{load:function(a){if(this.compiledTemplate)return this.compiledTemplate;var b=this.loadTemplate(this.templateId,a);return this.compiledTemplate=this.compileTemplate(b,a)},loadTemplate:function(a,b){var c=h.$(a);if(!c.length)throw new l.Error({name:"NoTemplateError",message:'Could not find template: "'+a+'"'});return c.html()},compileTemplate:function(a,b){return c.template(a,b)}});l.Renderer={render:function(a,b){if(!a)throw new l.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});return(c.isFunction(a)?a:l.TemplateCache.get(a))(b)}};l.View=h.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(a){this.render=c.bind(this.render,this);a=l._getValue(a,this);this.options=c.extend({},c.result(this,"options"),a);this._behaviors=l.Behaviors(this);h.View.call(this,this.options);l.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(a){return a.toJSON.apply(a,c.rest(arguments))},mixinTemplateHelpers:function(a){a=a||{};var b=this.getOption("templateHelpers"),b=l._getValue(b,this);return c.extend(a,b)},normalizeUIKeys:function(a){var b=c.result(this,"_uiBindings");return l.normalizeUIKeys(a,b||c.result(this,"ui"))},normalizeUIValues:function(a,b){var d=c.result(this,"ui"),f=c.result(this,"_uiBindings");return l.normalizeUIValues(a,f||d,b)},configureTriggers:function(){if(this.triggers){var a=this.normalizeUIKeys(c.result(this,"triggers"));return c.reduce(a,function(a,b,c){a[c]=this._buildViewTrigger(b);return a},{},this)}},delegateEvents:function(a){this._delegateDOMEvents(a);this.bindEntityEvents(this.model,this.getOption("modelEvents"));this.bindEntityEvents(this.collection,this.getOption("collectionEvents"));c.each(this._behaviors,function(a){a.bindEntityEvents(this.model,a.getOption("modelEvents"));a.bindEntityEvents(this.collection,a.getOption("collectionEvents"))},this);return this},_delegateDOMEvents:function(a){var b=l._getValue(a||this.events,this),b=this.normalizeUIKeys(b);c.isUndefined(a)&&(this.events=b);a={};var d=c.result(this,"behaviorEvents")||{},f=this.configureTriggers(),g=c.result(this,"behaviorTriggers")||{};c.extend(a,d,b,f,g);h.View.prototype.delegateEvents.call(this,a)},undelegateEvents:function(){h.View.prototype.undelegateEvents.apply(this,arguments);this.unbindEntityEvents(this.model,this.getOption("modelEvents"));this.unbindEntityEvents(this.collection,this.getOption("collectionEvents"));c.each(this._behaviors,function(a){a.unbindEntityEvents(this.model,a.getOption("modelEvents"));a.unbindEntityEvents(this.collection,a.getOption("collectionEvents"))},this);return this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new l.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'});},destroy:function(){if(this.isDestroyed)return this;var a=c.toArray(arguments);this.triggerMethod.apply(this,["before:destroy"].concat(a));this.isDestroyed=!0;this.triggerMethod.apply(this,["destroy"].concat(a));this.unbindUIElements();this.isRendered=!1;this.remove();c.invoke(this._behaviors,"destroy",a);return this},bindUIElements:function(){this._bindUIElements();c.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var a=c.result(this,"_uiBindings");this.ui={};c.each(a,function(a,b){this.ui[b]=this.$(a)},this)}},unbindUIElements:function(){this._unbindUIElements();c.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(c.each(this.ui,function(a,b){delete this.ui[b]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(a){var b=c.defaults({},a,{preventDefault:!0,stopPropagation:!0}),d=c.isObject(a)?b.event:a;return function(a){a&&(a.preventDefault&&b.preventDefault&&a.preventDefault(),a.stopPropagation&&b.stopPropagation&&a.stopPropagation());this.triggerMethod(d,{view:this,model:this.model,collection:this.collection})}},setElement:function(){var a=h.View.prototype.setElement.apply(this,arguments);c.invoke(this._behaviors,"proxyViewProperties",this);return a},triggerMethod:function(){var a=l._triggerMethod(this,arguments);this._triggerEventOnBehaviors(arguments);this._triggerEventOnParentLayout(arguments[0],c.rest(arguments));return a},_triggerEventOnBehaviors:function(a){for(var b=l._triggerMethod,c=this._behaviors,d=0,f=c&&c.length;d<f;d++)b(c[d],a)},_triggerEventOnParentLayout:function(a,b){var d=this._parentLayoutView();if(d){var f=l.getOption(d,"childViewEventPrefix")+":"+a,g=[this].concat(b);l._triggerMethod(d,f,g);f=l.getOption(d,"childEvents");f=l._getValue(f,d);(f=d.normalizeMethods(f))&&c.isFunction(f[a])&&f[a].apply(d,g)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var a=this._getImmediateChildren();return a.length?c.reduce(a,function(a,b){return b._getNestedViews?a.concat(b._getNestedViews()):a},a):a},_parentLayoutView:function(){for(var a=this._parent;a;){if(a instanceof l.LayoutView)return a;a=a._parent}},normalizeMethods:l.normalizeMethods,mergeOptions:l.mergeOptions,getOption:l.proxyGetOption,bindEntityEvents:l.proxyBindEntityEvents,unbindEntityEvents:l.proxyUnbindEntityEvents});l.ItemView=l.View.extend({constructor:function(){l.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var a=[this.model||this.collection];arguments.length&&a.push.apply(a,arguments);return this.model?this.serializeModel.apply(this,a):{items:this.serializeCollection.apply(this,a)}},serializeCollection:function(a){return a.toJSON.apply(a,c.rest(arguments))},render:function(){this._ensureViewIsIntact();this.triggerMethod("before:render",this);this._renderTemplate();this.isRendered=!0;this.bindUIElements();this.triggerMethod("render",this);return this},_renderTemplate:function(){var a=this.getTemplate();if(!1!==a){if(!a)throw new l.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var b=this.mixinTemplateHelpers(this.serializeData()),a=l.Renderer.render(a,b,this);this.attachElContent(a);return this}},attachElContent:function(a){this.$el.html(a);return this}});l.CollectionView=l.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(a){this.once("render",this._initialEvents);this._initChildViewStorage();l.View.apply(this,arguments);this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled});this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer();this.isBuffering=!0},endBuffering:function(){var a=this._isShown&&l.isNodeAttached(this.el),b;this.isBuffering=!1;this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show");a&&this._triggerBeforeAttach&&(b=this._getNestedViews(),this._triggerMethodMany(b,this,"before:attach"));this.attachBuffer(this,this._createBuffer());a&&this._triggerAttach&&(b=this._getNestedViews(),
this._triggerMethodMany(b,this,"attach"));this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show");this.initRenderBuffer()},_triggerMethodMany:function(a,b,d){var f=c.drop(arguments,3);c.each(a,function(a){l.triggerMethodOn.apply(a,[a,d,a,b].concat(f))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(a,b,d){b=void 0!==d.at&&(d.index||b.indexOf(a));if(this.getOption("filter")||!1===b)b=c.indexOf(this._filteredSortedModels(b),a);this._shouldAddChild(a,b)&&(this.destroyEmptyView(),d=this.getChildView(a),this.addChild(a,d,b))},_onCollectionRemove:function(a){a=this.children.findByModel(a);this.removeChildView(a);this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1;this.children.each(function(a){l.triggerMethodOn(a,"before:show",a)})},_onShowCalled:function(){this.children.each(function(a){l.triggerMethodOn(a,"show",a)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){this._ensureViewIsIntact();this.triggerMethod("before:render",this);this._renderChildren();this.isRendered=!0;this.triggerMethod("render",this);return this},reorder:function(){var a=this.children,b=this._filteredSortedModels();if(c.some(b,function(b){return!a.findByModel(b)}))this.render();else{var d=c.map(b,function(b,c){var d=a.findByModel(b);d._index=c;return d.el}),b=a.filter(function(a){return!c.contains(d,a.el)});this.triggerMethod("before:reorder");this._appendReorderedChildren(d);c.each(b,this.removeChildView,this);this.checkEmpty();this.triggerMethod("reorder")}},resortView:function(){l.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var a=this._filteredSortedModels();c.find(a,function(a,b){var c=this.children.findByModel(a);return!c||c._index!==b},this)&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(a){this.$el.append(a)},_renderChildren:function(){this.destroyEmptyView();this.destroyChildren({checkEmpty:!1});this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var a,b=this._filteredSortedModels();c.each(b,function(b,c){a=this.getChildView(b);this.addChild(b,a,c)},this)},_filteredSortedModels:function(a){var b=this.getViewComparator(),d=this.collection.models;a=Math.min(Math.max(a,0),d.length-1);if(b){var f;a&&(f=d[a],d=d.slice(0,a).concat(d.slice(a+1)));d=this._sortModelsBy(d,b);f&&d.splice(a,0,f)}this.getOption("filter")&&(d=c.filter(d,function(a,b){return this._shouldAddChild(a,b)},this));return d},_sortModelsBy:function(a,b){return"string"===typeof b?c.sortBy(a,function(a){return a.get(b)},this):1===b.length?c.sortBy(a,b,this):a.sort(c.bind(b,this))},showEmptyView:function(){var a=this.getEmptyView();if(a&&!this._showingEmptyView){this.triggerMethod("before:render:empty");this._showingEmptyView=!0;var b=new h.Model;this.addEmptyView(b,a);this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(a,b){var d=this._isShown&&!this.isBuffering&&l.isNodeAttached(this.el),f,g=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");c.isFunction(g)&&(g=g.call(this,a,this._emptyViewIndex));var e=this.buildChildView(a,b,g);e._parent=this;this.proxyChildEvents(e);e.once("render",function(){this._isShown&&l.triggerMethodOn(e,"before:show",e);d&&this._triggerBeforeAttach&&(f=this._getViewAndNested(e),this._triggerMethodMany(f,this,"before:attach"))},this);this.children.add(e);this.renderChildView(e,this._emptyViewIndex);d&&this._triggerAttach&&(f=this._getViewAndNested(e),this._triggerMethodMany(f,this,"attach"));this._isShown&&l.triggerMethodOn(e,"show",e)},getChildView:function(a){a=this.getOption("childView");if(!a)throw new l.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return a},addChild:function(a,b,c){var d=this.getOption("childViewOptions"),d=l._getValue(d,this,[a,c]);a=this.buildChildView(a,b,d);this._updateIndices(a,!0,c);this.triggerMethod("before:add:child",a);this._addChildView(a,c);this.triggerMethod("add:child",a);a._parent=this;return a},_updateIndices:function(a,b,c){this.getOption("sort")&&(b&&(a._index=c),this.children.each(function(c){c._index>=a._index&&(c._index+=b?1:-1)}))},_addChildView:function(a,b){var c=this._isShown&&!this.isBuffering&&l.isNodeAttached(this.el),d;this.proxyChildEvents(a);a.once("render",function(){this._isShown&&!this.isBuffering&&l.triggerMethodOn(a,"before:show",a);c&&this._triggerBeforeAttach&&(d=this._getViewAndNested(a),this._triggerMethodMany(d,this,"before:attach"))},this);this.children.add(a);this.renderChildView(a,b);c&&this._triggerAttach&&(d=this._getViewAndNested(a),this._triggerMethodMany(d,this,"attach"));this._isShown&&!this.isBuffering&&l.triggerMethodOn(a,"show",a)},renderChildView:function(a,b){a.supportsRenderLifecycle||l.triggerMethodOn(a,"before:render",a);a.render();a.supportsRenderLifecycle||l.triggerMethodOn(a,"render",a);this.attachHtml(this,a,b);return a},buildChildView:function(a,b,d){a=c.extend({model:a},d);b=new b(a);l.MonitorDOMRefresh(b);return b},removeChildView:function(a){if(!a)return a;this.triggerMethod("before:remove:child",a);a.supportsDestroyLifecycle||l.triggerMethodOn(a,"before:destroy",a);a.destroy?a.destroy():a.remove();a.supportsDestroyLifecycle||l.triggerMethodOn(a,"destroy",a);delete a._parent;this.stopListening(a);this.children.remove(a);this.triggerMethod("remove:child",a);this._updateIndices(a,!1);return a},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(a,b){a.$el.append(b)},_createBuffer:function(){var a=document.createDocumentFragment();c.each(this._bufferedChildren,function(b){a.appendChild(b.el)});return a},attachHtml:function(a,b,c){a.isBuffering?a._bufferedChildren.splice(c,0,b):a._insertBefore(b,c)||a._insertAfter(b)},_insertBefore:function(a,b){var c;this.getOption("sort")&&b<this.children.length-1&&(c=this.children.find(function(a){return a._index===b+1}));return c?(c.$el.before(a.el),!0):!1},_insertAfter:function(a){this.$el.append(a.el)},_initChildViewStorage:function(){this.children=new h.ChildViewContainer},destroy:function(){if(this.isDestroyed)return this;this.triggerMethod("before:destroy:collection");this.destroyChildren({checkEmpty:!1});this.triggerMethod("destroy:collection");return l.View.prototype.destroy.apply(this,arguments)},destroyChildren:function(a){a=a||{};var b=!0,d=this.children.map(c.identity);c.isUndefined(a.checkEmpty)||(b=a.checkEmpty);this.children.each(this.removeChildView,this);b&&this.checkEmpty();return d},_shouldAddChild:function(a,b){var d=this.getOption("filter");return!c.isFunction(d)||d.call(this,a,b,this.collection)},proxyChildEvents:function(a){var b=this.getOption("childViewEventPrefix");this.listenTo(a,"all",function(){var d=c.toArray(arguments),f=d[0],g=this.normalizeMethods(c.result(this,"childEvents"));d[0]=b+":"+f;d.splice(1,0,a);"undefined"!==typeof g&&c.isFunction(g[f])&&g[f].apply(this,d.slice(1));this.triggerMethod.apply(this,d)})},_getImmediateChildren:function(){return c.values(this.children._views)},_getViewAndNested:function(a){return[a].concat(c.result(a,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}});
l.CompositeView=l.CollectionView.extend({constructor:function(){l.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(a){return this.getOption("childView")||this.constructor},serializeData:function(){var a={};this.model&&(a=c.partial(this.serializeModel,this.model).apply(this,arguments));return a},render:function(){this._ensureViewIsIntact();this._isRendering=!0;this.resetChildViewContainer();this.triggerMethod("before:render",this);this._renderTemplate();this._renderChildren();this._isRendering=!1;this.isRendered=!0;this.triggerMethod("render",this);return this},_renderChildren:function(){(this.isRendered||this._isRendering)&&l.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var a={},a=this.serializeData(),a=this.mixinTemplateHelpers(a);this.triggerMethod("before:render:template");var b=this.getTemplate(),a=l.Renderer.render(b,a,this);this.attachElContent(a);this.bindUIElements();this.triggerMethod("render:template")},attachElContent:function(a){this.$el.html(a);return this},attachBuffer:function(a,b){this.getChildViewContainer(a).append(b)},_insertAfter:function(a){this.getChildViewContainer(this,a).append(a.el)},_appendReorderedChildren:function(a){this.getChildViewContainer(this).append(a)},getChildViewContainer:function(a,b){if(a.$childViewContainer)return a.$childViewContainer;var c;if(c=l.getOption(a,"childViewContainer")){if(c=l._getValue(c,a),c="@"===c.charAt(0)&&a.ui?a.ui[c.substr(4)]:a.$(c),0>=c.length)throw new l.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+a.childViewContainer});}else c=a.$el;return a.$childViewContainer=c},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}});l.LayoutView=l.ItemView.extend({regionClass:l.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(a){a=a||{};this._firstRender=!0;this._initializeRegions(a);l.ItemView.call(this,a)},render:function(){this._ensureViewIsIntact();this._firstRender?this._firstRender=!1:this._reInitializeRegions();return l.ItemView.prototype.render.apply(this,arguments)},destroy:function(){if(this.isDestroyed)return this;!0===this.getOption("destroyImmediate")&&this.$el.remove();this.regionManager.destroy();return l.ItemView.prototype.destroy.apply(this,arguments)},showChildView:function(a,b,d){var f=this.getRegion(a);return f.show.apply(f,c.rest(arguments))},getChildView:function(a){return this.getRegion(a).currentView},addRegion:function(a,b){var c={};c[a]=b;return this._buildRegions(c)[a]},addRegions:function(a){this.regions=c.extend({},this.regions,a);return this._buildRegions(a)},removeRegion:function(a){delete this.regions[a];return this.regionManager.removeRegion(a)},getRegion:function(a){return this.regionManager.get(a)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(a){var b={regionClass:this.getOption("regionClass"),parentEl:c.partial(c.result,this,"el")};return this.regionManager.addRegions(a,b)},_initializeRegions:function(a){var b;this._initRegionManager();b=l._getValue(this.regions,this,[a])||{};var d=this.getOption.call(a,"regions"),d=l._getValue(d,this,[a]);c.extend(b,d);b=this.normalizeUIValues(b,["selector","el"]);this.addRegions(b)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new l.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager();this.regionManager._parent=this;this.listenTo(this.regionManager,"before:add:region",function(a){this.triggerMethod("before:add:region",a)});this.listenTo(this.regionManager,"add:region",function(a,b){this[a]=b;this.triggerMethod("add:region",a,b)});this.listenTo(this.regionManager,"before:remove:region",function(a){this.triggerMethod("before:remove:region",a)});this.listenTo(this.regionManager,"remove:region",function(a,b){delete this[a];this.triggerMethod("remove:region",a,b)})},_getImmediateChildren:function(){return c.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}});l.Behavior=l.Object.extend({constructor:function(a,b){this.view=b;this.defaults=c.result(this,"defaults")||{};this.options=c.extend({},this.defaults,a);this.ui=c.extend({},c.result(b,"ui"),c.result(this,"ui"));l.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){this.stopListening();return this},proxyViewProperties:function(a){this.$el=a.$el;this.el=a.el}});l.Behaviors=function(a,b){function c(a,d){if(!b.isObject(a.behaviors))return{};d=c.parseBehaviors(a,d||b.result(a,"behaviors"));c.wrap(a,d,b.keys(g));return d}function d(a,b){this._view=a;this._behaviors=b;this._triggers={}}var f=/^(\S+)\s*(.*)$/,g={behaviorTriggers:function(a,b){return(new d(this,b)).buildBehaviorTriggers()},behaviorEvents:function(c,d){var g={};b.each(d,function(c,d){var e={},l=b.clone(b.result(c,"events"))||{},l=a.normalizeUIKeys(l,c._uiBindings||c.ui),p=0;b.each(l,function(a,g){var l=g.match(f),l=l[1]+"."+[this.cid,d,p++," "].join("")+l[2],h=b.isFunction(a)?a:c[a];e[l]=b.bind(h,c)},this);g=b.extend(g,e)},this);return g}};b.extend(c,{behaviorsLookup:function(){throw new a.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"});},getBehaviorClass:function(b,d){return b.behaviorClass?b.behaviorClass:a._getValue(c.behaviorsLookup,this,[b,d])[d]},parseBehaviors:function(a,d){return b.chain(d).map(function(d,f){var g=new (c.getBehaviorClass(d,f))(d,a),e=c.parseBehaviors(a,b.result(g,"behaviors"));return[g].concat(e)}).flatten().value()},wrap:function(a,c,d){b.each(d,function(d){a[d]=b.partial(g[d],a[d],c)})}});b.extend(d.prototype,{buildBehaviorTriggers:function(){b.each(this._behaviors,this._buildTriggerHandlersForBehavior,this);return this._triggers},_buildTriggerHandlersForBehavior:function(c,d){var f=b.clone(b.result(c,"triggers"))||{},f=a.normalizeUIKeys(f,c._uiBindings||c.ui);b.each(f,b.bind(this._setHandlerForBehavior,this,c,d))},_setHandlerForBehavior:function(a,b,c,d){a=d.replace(/^\S+/,function(a){return a+".behaviortriggers"+b});this._triggers[a]=this._view._buildViewTrigger(c)}});return c}(l,c);l.AppRouter=h.Router.extend({constructor:function(a){this.options=a||{};h.Router.apply(this,arguments);var b=this.getOption("appRoutes"),c=this._getController();this.processAppRoutes(c,b);this.on("route",this._processOnRoute,this)},appRoute:function(a,b){var c=this._getController();this._addAppRoute(c,a,b)},_processOnRoute:function(a,b){if(c.isFunction(this.onRoute)){var d=c.invert(this.getOption("appRoutes"))[a];this.onRoute(a,d,b)}},processAppRoutes:function(a,b){if(b){var d=c.keys(b).reverse();c.each(d,function(c){this._addAppRoute(a,c,b[c])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(a,b,d){var f=a[d];if(!f)throw new l.Error('Method "'+d+'" was not found on the controller');this.route(b,d,c.bind(f,a))},mergeOptions:l.mergeOptions,getOption:l.proxyGetOption,triggerMethod:l.triggerMethod,bindEntityEvents:l.proxyBindEntityEvents,unbindEntityEvents:l.proxyUnbindEntityEvents});l.Application=l.Object.extend({constructor:function(a){this._initializeRegions(a);this._initCallbacks=new l.Callbacks;this.submodules={};c.extend(this,a);this._initChannel();l.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(a){this._initCallbacks.add(a)},start:function(a){this.triggerMethod("before:start",a);this._initCallbacks.run(a,this);this.triggerMethod("start",a)},
addRegions:function(a){return this._regionManager.addRegions(a)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(a){return this._regionManager.removeRegion(a)},getRegion:function(a){return this._regionManager.get(a)},getRegions:function(){return this._regionManager.getRegions()},module:function(a,b){var d=l.Module.getClass(b),f=c.toArray(arguments);f.unshift(this);return d.create.apply(d,f)},getRegionManager:function(){return new l.RegionManager},_initializeRegions:function(a){var b=c.isFunction(this.regions)?this.regions(a):this.regions||{};this._initRegionManager();var d=l.getOption(a,"regions");c.isFunction(d)&&(d=d.call(this,a));c.extend(b,d);this.addRegions(b);return this},_initRegionManager:function(){this._regionManager=this.getRegionManager();this._regionManager._parent=this;this.listenTo(this._regionManager,"before:add:region",function(){l._triggerMethod(this,"before:add:region",arguments)});this.listenTo(this._regionManager,"add:region",function(a,b){this[a]=b;l._triggerMethod(this,"add:region",arguments)});this.listenTo(this._regionManager,"before:remove:region",function(){l._triggerMethod(this,"before:remove:region",arguments)});this.listenTo(this._regionManager,"remove:region",function(a){delete this[a];l._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=c.result(this,"channelName")||"global";this.channel=c.result(this,"channel")||h.Wreqr.radio.channel(this.channelName);this.vent=c.result(this,"vent")||this.channel.vent;this.commands=c.result(this,"commands")||this.channel.commands;this.reqres=c.result(this,"reqres")||this.channel.reqres}});l.Module=function(a,b,d){this.moduleName=a;this.options=c.extend({},this.options,d);this.initialize=d.initialize||this.initialize;this.submodules={};this._setupInitializersAndFinalizers();this.app=b;c.isFunction(this.initialize)&&this.initialize(a,b,this.options)};l.Module.extend=l.extend;c.extend(l.Module.prototype,h.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){this._isInitialized||(c.each(this.submodules,function(b){b.startWithParent&&b.start(a)}),this.triggerMethod("before:start",a),this._initializerCallbacks.run(a,this),this._isInitialized=!0,this.triggerMethod("start",a))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),c.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,b){if(a){var d=c.flatten([this,this.app,h,l,h.$,c,b]);a.apply(this,d)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new l.Callbacks;this._finalizerCallbacks=new l.Callbacks},triggerMethod:l.triggerMethod});c.extend(l.Module,{create:function(a,b,d){var f=a,g=c.drop(arguments,3);b=b.split(".");var e=[];e[b.length-1]=d;c.each(b,function(b,c){var k=f;f=this._getModule(k,b,a,d);this._addModuleDefinition(k,f,e[c],g)},this);return f},_getModule:function(a,b,d,f,g){g=c.extend({},f);f=this.getClass(f);var e=a[b];e||(e=new f(b,d,g),a[b]=e,a.submodules[b]=e);return e},getClass:function(a){var b=l.Module;return a?a.prototype instanceof b?a:a.moduleClass||b:b},_addModuleDefinition:function(a,b,c,d){var f=this._getDefine(c);c=this._getStartWithParent(c,b);f&&b.addDefinition(f,d);this._addStartWithParent(a,b,c)},_getStartWithParent:function(a,b){var d;return c.isFunction(a)&&a.prototype instanceof l.Module?(d=b.constructor.prototype.startWithParent,c.isUndefined(d)?!0:d):c.isObject(a)?(d=a.startWithParent,c.isUndefined(d)?!0:d):!0},_getDefine:function(a){return!c.isFunction(a)||a.prototype instanceof l.Module?c.isObject(a)?a.define:null:a},_addStartWithParent:function(a,b,c){b.startWithParent=b.startWithParent&&c;b.startWithParent&&!b.startWithParentIsConfigured&&(b.startWithParentIsConfigured=!0,a.addInitializer(function(a){b.startWithParent&&b.start(a)}))}});return l});(function(e,h){"function"===typeof define&&define.amd?define("namedconstructor",["exports","underscore","backbone"],h):"object"===typeof exports?h(exports,require("underscore"),require("backbone")):h(e.NamedConstructor={},e._,e.Backbone)})(this,function(e,h,c){var b=c.Model.extend,d=function(b,c){return(new Function("constructor","return function "+b+"() {\n  return constructor.apply(this, arguments);\n};"))(c)};c.Model.extend=c.Collection.extend=c.Router.extend=c.View.extend=function(c,g){if(c&&h.has(c,"constructorName")){var f=h.has(c,"constructor")?c.constructor:this;c=h.extend(c,{constructor:d(c.constructorName,f)})}return b.call(this,c,g)}});(function(){define("dctk",["dctk/dctk"],function(e){return e});define("modernizr",function(){return window.Modernizr})})();(function(e,h){if("function"===typeof define&&define.amd)try{define("animateWithCss",["jquery"],h)}catch(c){}else h(window.jQuery)})(this,function(e){var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)},c=/([A-Z])/g;e.fn.stopCssAnimation=function(){this.each(function(){var b=e(this),d=b.data("cssAnimatedProps"),l=window.getComputedStyle(this,null),g={},f;for(f in d)f=f.replace(c,"-$1").toLowerCase(),g[f]=l.getPropertyValue(f);b.css({"transition-property":"none","transition-duration":"","transition-timing-function":""});for(f in g)b.css(f,g[f]);b.data("cssAnimatedProps",null);if(d=b.data("cssTimeoutId"))clearTimeout(d),b.data("cssTimeoutId",null)})};e.fn.animateWithCss=function(b,d,l,g){var f=this,a=jQuery.speed(d,l,g);if(jQuery.isEmptyObject(b))return this.each(a.complete);d={bounce:"cubic-bezier(0.0, 0.35, .5, 1.3)",linear:"linear",swing:"ease-in-out"};a.easing=a.easing||"swing";a.easing=d[a.easing]?d[a.easing]:a.easing;h(function(){f.each(function(){var a=e(this);a.data("cssAnimatedProps",b);var d=window.getComputedStyle(this,null),f;for(f in b)f=f.replace(c,"-$1").toLowerCase(),a.css(f,d.getPropertyValue(f))});f.css({"transition-property":"all","transition-duration":a.duration+"ms","transition-timing-function":a.easing});f.css(b);var d=setTimeout(function(){f.css({"transition-property":"none","transition-duration":"","transition-timing-function":""});f.data("cssAnimatedProps",null);f.data("cssTimeoutId",null);jQuery.isFunction(a.complete)&&a.complete.apply(f)},a.duration);f.data("cssTimeoutId",d)});return f};return e});
define("notifier",["jquery","handlebars","uitk","modernizr","animateWithCss"],function(e,h,c,b){function d(){p=!0}function l(){p=!1}function g(a){setTimeout(function(){p?g(a):a()},s.displayDuration)}function f(b){return function(f){var g=b.find(".notification-text").text();c.utils.liveAnnounce(g,"polite");b.find(".btn-close").attr("tabindex",0).on("click",function(){p=!1;a(e(this).parent(".notification"))()}).on("focus",d).on("blur",l);b.css("pointer-events","auto")[r]({opacity:.95},s.fadeTime,f)}}function a(a){return function(b){a.find(".btn-close").attr("tabindex",-1);a[r]({opacity:0},s.fadeTime,function(){a[r]({height:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},s.fadeTime,b);q--;1>q&&c.publish("notifier.complete")})}}function k(){try{n&&(n.remove(),n=void 0)}catch(a){}}var p=!1,n,q=0,r=b.csstransitions?"animateWithCss":"animate",s={displayDuration:5E3,initialWait:!0,fadeTime:750,insert:function(a){a.prependTo("body")}},t={template:function(){var a=h.templates;if(a&&a.notifier)return a.notifier.apply(a,arguments);throw Error("template not implemented");},overrideConfig:function(){t.config.apply(arguments)},config:function(a){"object"===typeof a&&e.extend(s,a);return t},notify:function(){var b,c,h,p=[];e.each([].concat.apply([],arguments).reverse(),function(a,b){var c;(c="object"!==typeof b)||(c=b,c=Array.isArray?Array.isArray(c):"[object Array]"===Object.prototype.toString.call(c));c&&(b=e.trim(b));b&&p.push(b)});n&&k();n=e(this.template({notifications:p}));s.insert(n);c=e(n.find(".notification").get().reverse());n.on("mouseenter",d).on("mouseleave",l);s.initialWait&&n.queue(g);n.queue(f(c.eq(0))).queue(g);q=c.length;b=0;for(h=c.length;b<h;b++)n.queue(f(c.eq(b+1))).queue(g).queue(a(c.eq(b)));n.queue(g).queue(a(c.eq(h-1))).queue(k)}};return t});require(["handlebars"],function(e){var h=e.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,b,d,e,g){var f;return'\x3cdiv class\x3d"notifier"\x3e\n'+(null!=(f=d.each.call(null!=b?b:{},null!=b?b.notifications:b,{name:"each",hash:{},fn:c.program(1,g,0),inverse:c.noop,data:g}))?f:"")+"\x3c/div\x3e"},1:function(c,b,d,e,g){var f;return null!=(f=(d.ifString||b&&b.ifString||d.helperMissing).call(null!=b?b:{},b,{name:"ifString",hash:{},fn:c.program(2,g,0),inverse:c.program(4,g,0),data:g}))?f:""},2:function(c,b,d,e,g){var f,a;return'            \x3cdiv class\x3d"notification"\x3e\n                \x3cdiv class\x3d"notification-text"\x3e\n                    '+(null!=(f=c.lambda(b,b))?f:"")+'\n                \x3c/div\x3e\n                \x3cbutton type\x3d"button" class\x3d"btn-close btn-primary" tabindex\x3d"-1"\x3e\n                    \x3cspan class\x3d"icon icon-close" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                    \x3cspan class\x3d"alt"\x3e'+c.escapeExpression((a=null!=(a=d.closeThisMessage||(null!=b?b.closeThisMessage:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"closeThisMessage",hash:{},data:g}):a))+"\x3c/span\x3e\n                \x3c/button\x3e\n            \x3c/div\x3e\n"},4:function(c,b,d,e,g){var f,a;return'            \x3cdiv class\x3d"notification"\x3e\n                \x3cdiv class\x3d"notification-text"\x3e\n'+(null!=(f=(d.if_eq||b&&b.if_eq||d.helperMissing).call(null!=b?b:{},null!=b?b.dir:b,{name:"if_eq",hash:{compare:"up"},fn:c.program(5,g,0),inverse:c.program(7,g,0),data:g}))?f:"")+'                    \x3cspan class\x3d"text_space"\x3e'+c.escapeExpression((a=null!=(a=d.msg||(null!=b?b.msg:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"msg",hash:{},data:g}):a))+'\x3c/span\x3e\n                \x3c/div\x3e\n                \x3cbutton type\x3d"button" class\x3d"btn-close btn-primary" tabindex\x3d"-1" data-track\x3d"HOT.HIS.PriceTrends.CLOSE"\x3e\n                    \x3cspan class\x3d"icon icon-close" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                    \x3cspan class\x3d"alt"\x3e'+c.escapeExpression((a=null!=(a=d.closeThisMessage||(null!=b?b.closeThisMessage:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"closeThisMessage",hash:{},data:g}):a))+"\x3c/span\x3e\n                \x3c/button\x3e\n            \x3c/div\x3e\n"},5:function(c,b,d,e,g){return'                        \x3cdiv class\x3d"icon_space"\x3e\n                            \x3cspan class\x3d"icon icon-deltadot up" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                            \x3cspan class\x3d"alt"\x3ePrices have gone up\x3c/span\x3e\n                        \x3c/div\x3e\n'},7:function(c,b,d,e,g){return'                        \x3cdiv class\x3d"icon_space"\x3e\n                            \x3cspan class\x3d"icon icon-deltadot down" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                            \x3cspan class\x3d"alt"\x3ePrices have gone down\x3c/span\x3e\n                        \x3c/div\x3e\n'},useData:!0});e.templates=e.templates||{};e.templates.notifier=h;e.partials=e.partials||{};e.partials.notifier=h});(function(){function e(c,b,d){require(["logger"],function(e){e.logError(c,b,d)})}var h=!1;setTimeout(function(){try{var c=window.modulizr._getBlockingUndefined().join(",");h||""===c||e("initializationTimeout","Undefined modules stalling dependency chain",{undefinedModules:c})}catch(b){e("initializationTimeout",b)}},15E3);define("infositeApplication",["configurator","runnableModules","utils"],function(c,b,d){function l(){require(["urgencyApplication"],function(b){b.start()});require(["expads","adsData","useAdtk"],function(b,c,a){a.enabled?define("expads.targeting",function(){return c}):void 0!==b&&"function"===typeof b.initialize&&b.initialize(c)});require(["ads"],function(b){b.run()})}return{runModules:function(b){var c,a;for(c=0;c<b.length;c++){a=b[c];try{"function"===typeof a.run&&a.run()}catch(k){a=d.findModuleId(a),e("runModules",k,{module:a})}}},start:function(){c.configure();this.runModules(b);this.started=h=!0;l()}}});define("runnableModules","allExperiments liveCodeReporter search availability reviews airAttach competitors googleAnalytics photos roomsAndRates maps eds mrp feedback coupon leadprice meta loyalty recommendations navigation subscribeView priceChangeLogger membership".split(" "),function(){return Array.prototype.slice.call(arguments)});define("packagesApplication",["infositeApplication","packageRoomsAndRates","packageSession","multiStepIndicatorRunner"],function(c,b,d,e){return{start:function(){c.start();c.runModules([b,d,e]);this.started=h=!0}}})})();
define("uitk_hb_template_helper",["uitk_hb_shared_utilities","handlebars"],function(e,h){h=h||Handlebars;var c={HEADING_ENUM:{h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6"},YOUTUBE_URL:"http://www.youtube.com/watch?feature\x3dplayer_embedded\x26v\x3d",publishedHelpers:{},validate:function(b,c,e,g){if(e&&!this[b].hasOwnProperty(e))throw new ReferenceError("Parameter '"+c+"' with value '"+e+"' is invalid for the '"+g+"'.");return this[b][e]},isContentJson:function(b){var c=!0,e,g;if(b)try{if((g=JSON.parse(b))&&"[object Array]"===Object.prototype.toString.call(g)&&0!==g.length){e=!0;for(b=0;b<g.length;b++)if("object"!==typeof g[b]){e=!1;break}c=e}else c=!1}catch(f){c=!1}return c},toContentJson:function(b){var c;b&&"function"===typeof b.toString&&(b=b.toString(),c=b.trim().slice(0,-1),c="["+c+"]");return this.isContentJson(c)?c:""},addPartialData:function(b){var c=b.partialData,e,g,f;"[object Array]"!==Object.prototype.toString.call(c)&&(c=[c]);e=c.length;for(f=0;f<e;f++)g=c[f],b[g.objectName]=JSON.parse(h.helpers[g.tagName+"_modelGenerator"]({hash:g.params})),"undefined"!==typeof window&&uitk_hb_utilities.normalizePartialTemplate(g.tagName.split("uitk_")[1]+"-tag");b.partialData=void 0;return b},logError:function(b){if("undefined"!==typeof console)console.error?console.error(b):console.log(b);else throw b;},modelGenerator:function(b,c){try{var e=c.hash,g,f,a,k="",h="";c.fn&&((g=c.fn(b))&&"function"===typeof g.toString&&(g=g.toString()),c.hash.content=g);if(f=this.toContentJson(g))c.hash.content=f,c.hash._jsonContent="true";a=JSON.parse(e._tag.help(b,c));a.partialData&&(a=this.addPartialData(a));a.id=e.id||"";a.classes=void 0!==e.classes?" "+e.classes:"";a.dataAttributes=void 0!==a.dataAttributes?uitk_hb_utilities.parseAttributes(a.dataAttributes,"data")||"":uitk_hb_utilities.parseAttributes(e.dataAttributes,"data")||"";a.attributes=uitk_hb_utilities.parseAttributes(e.attributes)||"";this.validate("HEADING_ENUM","headingLevel",e.headingLevel,a._templateName);e.childTag&&(a.childTag=e.childTag,"undefined"!==typeof window&&(k="#child#",h="#/child#"));e.childTag||this.publishEvent(a._templateName);return k+JSON.stringify(a)+h}catch(n){this.logError(n)}},help:function(b,c){var e=JSON.parse(this.modelGenerator(b,c)),g=e._templateName;"undefined"!==typeof window&&(g+=".hbs");e=h.templates[g](e);return new h.SafeString(e)},publishEvent:function(b){var c=this.publishedHelpers,e;b&&!c[b]&&(e=c[b]={name:b,rendered:!0},require(["uitk"],function(b){b.publish("uitk.hbs.helper.render",e)}))},getRenderedHelpers:function(){return this.publishedHelpers}};h.registerHelper("uitk_templateHelperJs",function(b,d){d||(d=b,b=this);return new h.SafeString(c.help(b,d))});h.registerHelper("uitk_templateHelperJs_modelGenerator",function(b,d){d||(d=b,b=this);return new h.SafeString(c.modelGenerator(b,d))});"undefined"!==typeof h&&"undefined"===typeof h.helpers&&(h.helpers={},h.helpers.uitk_templateHelperJs=function(b,d){d||(d=b,b=this);return c.help(b,d)},h.helpers.uitk_templateHelperJs_modelGenerator=function(b,d){d||(d=b,b=this);return c.modelGenerator(b,d)});return c});define("uitk_hb_template_utility",["handlebars","uitk_hb_template_helper"],function(e){e=e||Handlebars;var h;h=function(c,b,d){e.registerHelper(b+"_modelGenerator",function(b,d){d||(d=b,b=this);d.hash._tag=c;return e.helpers.uitk_templateHelperJs_modelGenerator(b,d)});e.registerHelper(b,function(b,g){g||(g=b,b=this);g.hash._tag=c;if(d)return e.helpers.uitk_templateHelperJs(b,g);g.hash.childTag="true";return e.helpers.uitk_templateHelperJs_modelGenerator(b,g)})};return window.registerUitkHelper=h});var uitk_hb_utilities;define("uitk_hb_shared_utilities",["handlebars"],function(e){e=e||Handlebars;var h={validateEnum:function(c,b,d,e){var g=/\{|\}/g;if(void 0!==e&&g.test(e)||!e||d.hasOwnProperty(e))return e;this.throwMessage("'"+e+"' is an invalid value for the '"+b+"' parameter on the 'uitk-"+c+"'.","reference")},validateRequired:function(c,b,d){"string"===typeof d&&""!==d.trim()||this.throwMessage("'"+b+"' is required, in string format, for the '"+c+"'","reference");return d},validateBool:function(c,b,d){typeof c!==Boolean&&"false"!==c&&"true"!==c&&this.throwMessage("The "+b+' parameter must be either "true" or "false". - '+d);return c},lowerCase:function(c,b){return c&&c.toLowerCase?c.toLowerCase():b},parseBoolean:function(c){return"true"===c||!0===c?c:""},validateInt:function(c,b,d){isNaN(c)&&this.throwMessage("The "+b+" parameter must be an integer. - "+d);return parseInt(c)},throwMessage:function(c,b){switch(b){case "reference":throw new ReferenceError(c);case "type":throw new TypeError(c);default:throw Error(c);}},parseAttributes:function(c,b){var d,e,g;if(c){c=c.replace('"\n',"").replace("||","\x3c\x3c!PIPE!\x3e\x3e").replace("::","\x3c\x3c!COLON!\x3e\x3e");d=c.split("|");e="";for(var f=0;f<d.length;f++)g=d[f].split(":"),0<g.length&&(b&&(e+=b+"-"),e+=g[0].trim(),2===g.length&&(e+='\x3d"'+g[1].trim()+'"'),e+=" ");return e=e.replace("\x3c\x3c!PIPE!\x3e\x3e","|").replace("\x3c\x3c!COLON!\x3e\x3e",":")}},parseContent:function(c){var b="",d="",e="",g="",f,a,k;if(void 0!==c)if(c=String(c).trim(),g=c.length,-1<c.indexOf("#child#")){f=c.indexOf("#child#");0<f&&(b=c.substring(0,f),c=c.substring(f));f=c.lastIndexOf("#/child#");f!==g&&(d=c.substring(f+8).trim(),c=c.substring(0,f+8));f=[];a=c.indexOf("#child#");for(c.indexOf("#child#",a+7);0<=a;)g=c.indexOf("#child#",a+7),0<g?(k=c.substring(a,g),k=k.split("#/child#"),a=k[0],e+=k[1]):a=c.substring(a),a=a.replace(/#child#/g,"").replace(/#\/child#/g,""),f.push(JSON.parse(a)),a=g;e=e.replace(/\s{2,}/g," ").trim();g=b+e+d}else g=c;return{preJsonContent:b,postJsonContent:d,noneJsonContent:e,allNoneJsonContent:g,jsonContent:f}},validateHTMLElement:function(c,b){if((new RegExp(/^[a-zA-Z0-9]+$/)).test(c))return c;this.throwMessage("'"+c+"' is not a valid HTML element name. - "+b)},normalizePartialTemplate:function(c){"undefined"!==typeof window&&void 0===e.partials[c]&&(e.partials[c]=e.partials[c+".hbs"])}};return uitk_hb_utilities=h});
define("uitk_hb_button",["uitk_hb_shared_utilities","uitk_hb_template_utility","button-tag.hbs"],function(){var e=uitk_hb_utilities,h={TEMPLATE_NAME:"button-tag",TYPE_DEFAULT:"button",TYPE_ENUM:{button:"button",submit:"submit",reset:"reset",link:"link"},LEVEL_DEFAULT:"primary",LEVEL_ENUM:{primary:"btn-primary",secondary:"btn-secondary"},BTNTYPE_DEFAULT:"action",BTNTYPE_ENUM:{action:"btn-action","sub-action":"btn-sub-action",utility:"btn-utility",close:"btn-close","module-close":"btn-close module-close","modal-close":"btn-close icon icon-close modal-close",pager:"btn-paging","slider-control":"image-slider-control",text:"btn-text"},DISABLED_DEFAULT:!1,isLink:function(c){return"undefined"!==typeof c&&"link"===c},isDisabledLink:function(c,b){return b&&"true"===c},isDisabledButton:function(c,b){return!b&&"true"===c},isBtnTypeClose:function(c){return"close"===c||"module-close"===c||"modal-close"===c},validateParameters:function(c,b,d,l,g,f,a,k){e.validateEnum(this.TEMPLATE_NAME,"type",this.TYPE_ENUM,c);e.validateEnum(this.TEMPLATE_NAME,"level",this.LEVEL_ENUM,b);e.validateEnum(this.TEMPLATE_NAME,"btnType",this.BTNTYPE_ENUM,d);l&&e.validateRequired(this.TEMPLATE_NAME,"href",g);f&&isNaN(f)&&e.throwMessage("The tabIndex parameter should be a number ["+this.TEMPLATE_NAME+"]","type");!a||"undefined"!==typeof k&&""!==k.trim()||e.throwMessage("The targetId parameter is required for close buttons ["+this.TEMPLATE_NAME+"]","type")},createCssClass:function(c,b,d){var e="";c&&(e+="btn ");e+=this.LEVEL_ENUM[b]+" ";return e+=this.BTNTYPE_ENUM[d]},help:function(c,b){var d=b.hash,l=d.id,g=e.lowerCase(d.type,this.TYPE_DEFAULT),f=this.isLink(g),a=e.lowerCase(d.level,this.LEVEL_DEFAULT),k=e.lowerCase(d.btnType,this.BTNTYPE_DEFAULT),h=e.lowerCase(d.disabled,this.DISABLED_DEFAULT),n=this.isDisabledLink(h,f),q=this.isDisabledButton(h,f),h=this.isBtnTypeClose(k),r=d.href,s=d.title,t=d.targetId,v=d.tabIndex,d=d.content,l={id:l,type:g,cssClass:this.createCssClass(f,a,k),isLink:e.parseBoolean(f),isDisabledLink:e.parseBoolean(n),isDisabledButton:e.parseBoolean(q),isBtnTypeClose:e.parseBoolean(h),href:r,title:s,targetId:t,tabIndex:v,content:d,_templateName:this.TEMPLATE_NAME};this.validateParameters(g,a,k,f,r,v,h,t);return JSON.stringify(l)}};registerUitkHelper(h,"uitk_button",!0);return h});require("uitk_hb_button",function(){});define("uitk_hb_icon",["uitk_hb_shared_utilities","uitk_hb_template_utility","icon-tag.hbs"],function(){var e={TEMPLATE_NAME:"icon-tag",iconContent:function(e,c){return void 0===e||""==e||null===e?c:e},help:function(e,c){var b=c.hash,d=b.id,l=b.name,b=this.iconContent(b.content,b.altContent);return JSON.stringify({_templateName:this.TEMPLATE_NAME,id:d,name:l,altContent:b})}};registerUitkHelper(e,"uitk_icon",!0);return e});require("uitk_hb_icon",function(){});
define("datepicker-tag.hbs",["handlebars"],function(e){var h=e.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,b,d,e,g){var f,a;c=(f=null!=(f=d.compress||(null!=b?b.compress:b))?f:d.helperMissing,a={name:"compress",hash:{},fn:c.program(1,g,0),inverse:c.noop,data:g},"function"===typeof f?f.call(null!=b?b:{},a):f);d.compress||(c=d.blockHelperMissing.call(b,c,a));return null!=c?c:""},1:function(c,b,d,e,g){var f,a;return"\x3cdiv "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.id:b,{name:"if",hash:{},fn:c.program(2,g,0),inverse:c.noop,data:g}))?f:"")+'data-control\x3d"datepicker" class\x3d"datepicker theme-standard pin-'+c.escapeExpression((a=null!=(a=d.position||(null!=b?b.position:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"position",hash:{},data:g}):a))+c.escapeExpression((a=null!=(a=d.classes||(null!=b?b.classes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"classes",hash:{},data:g}):a))+'"\n'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.startDate:b,{name:"if",hash:{},fn:c.program(4,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.endDate:b,{name:"if",hash:{},fn:c.program(6,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.firstValidDate:b,{name:"if",hash:{},fn:c.program(8,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.lastValidDate:b,{name:"if",hash:{},fn:c.program(10,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.blackoutDates:b,{name:"if",hash:{},fn:c.program(12,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.defaultRangeLength:b,{name:"if",hash:{},fn:c.program(14,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.maxRangeLength:b,{name:"if",hash:{},fn:c.program(16,g,0),inverse:c.noop,data:g}))?f:"")+"\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.autoPosIsTrue:b,{name:"if",hash:{},fn:c.program(18,g,0),inverse:c.noop,data:g}))?f:"")+" \n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.showKeyboardIsTrue:b,{name:"if",hash:{},fn:c.program(20,g,0),inverse:c.noop,data:g}))?f:"")+" \n"+(null!=(f=d.unless.call(null!=b?b:{},null!=b?b.closeIsTrue:b,{name:"unless",hash:{},fn:c.program(22,g,0),inverse:c.noop,data:g}))?f:"")+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+" "+(null!=(f=(a=null!=(a=d.attributes||(null!=b?b.attributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"attributes",hash:{},data:g}):a))?f:"")+"\x3e\n    \x3clabel "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.labelId:b,{name:"if",hash:{},fn:c.program(24,g,0),inverse:c.noop,data:g}))?f:"")+' class\x3d"datepicker-label datepicker-arrow text icon-before'+c.escapeExpression((a=null!=(a=d.labelClasses||(null!=b?b.labelClasses:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"labelClasses",hash:{},data:g}):a))+'" for\x3d"'+c.escapeExpression((a=null!=(a=d.inputId||(null!=b?b.inputId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"inputId",hash:{},data:g}):a))+'" '+(null!=(f=(a=null!=(a=d.labelDataAttributes||(null!=b?b.labelDataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"labelDataAttributes",hash:{},data:g}):a))?f:"")+" "+(null!=(f=(a=null!=(a=d.labelAttributes||(null!=b?b.labelAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"labelAttributes",hash:{},data:g}):a))?f:"")+'\x3e\n        \x3cspan class\x3d"label"\x3e'+(null!=(f=(a=null!=(a=d.labelText||(null!=b?b.labelText:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"labelText",hash:{},data:g}):a))?f:"")+'\x3c/span\x3e\n        \x3cinput id\x3d"'+c.escapeExpression((a=null!=(a=d.inputId||(null!=b?b.inputId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"inputId",hash:{},data:g}):a))+'" class\x3d"text datepicker-trigger-input'+c.escapeExpression((a=null!=(a=d.inputClasses||(null!=b?b.inputClasses:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"inputClasses",hash:{},data:g}):a))+'" type\x3d"text" placeholder\x3d"'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.placeholder:b,{name:"if",hash:{},fn:c.program(26,g,0),inverse:c.program(28,g,0),data:g}))?f:"")+'" autocomplete\x3d"off" '+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.minRangeLength:b,{name:"if",hash:{},fn:c.program(30,g,0),inverse:c.noop,data:g}))?f:"")+" "+(null!=(f=(a=null!=(a=d.inputDataAttributes||(null!=b?b.inputDataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"inputDataAttributes",hash:{},data:g}):a))?f:"")+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.value:b,{name:"if",hash:{},fn:c.program(32,g,0),inverse:c.noop,data:g}))?f:"")+" "+(null!=(f=(a=null!=(a=d.inputAttributes||(null!=b?b.inputAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"inputAttributes",hash:{},data:g}):a))?f:"")+" /\x3e\n"+(null!=(f=c.invokePartial(e["icon-tag"],null!=b?b.iconTag:b,{name:"icon-tag",data:g,indent:"        ",helpers:d,partials:e,decorators:c.decorators}))?f:"")+"    \x3c/label\x3e\n    \x3cdiv "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.dropDownId:b,{name:"if",hash:{},fn:c.program(34,g,0),inverse:c.noop,data:g}))?f:"")+' class\x3d"datepicker-dropdown'+c.escapeExpression((a=null!=(a=d.dropDownClasses||(null!=b?b.dropDownClasses:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dropDownClasses",hash:{},data:g}):a))+'" '+(null!=(f=(a=null!=(a=d.dropDownAttributes||(null!=b?b.dropDownAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dropDownAttributes",hash:{},data:g}):a))?f:"")+" "+(null!=(f=(a=null!=(a=d.dropDownDataAttributes||(null!=b?b.dropDownDataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dropDownDataAttributes",hash:{},data:g}):a))?f:"")+' aria-hidden\x3d"true"\x3e\x3c/div\x3e\n\x3c/div\x3e\n'},2:function(c,b,d,e,g){var f;return'id\x3d"'+c.escapeExpression((f=null!=(f=d.id||(null!=b?b.id:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"id",hash:{},data:g}):f))+'" '},4:function(c,b,d,e,g){var f;return'data-start-date\x3d"'+c.escapeExpression((f=null!=(f=d.startDate||(null!=b?b.startDate:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"startDate",hash:{},data:g}):f))+'"'},6:function(c,b,d,e,g){var f;return'data-end-date\x3d"'+c.escapeExpression((f=null!=(f=d.endDate||(null!=b?b.endDate:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"endDate",hash:{},data:g}):f))+'"'},8:function(c,b,d,e,g){var f;return'data-first-valid-date\x3d"'+c.escapeExpression((f=null!=(f=d.firstValidDate||(null!=b?b.firstValidDate:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"firstValidDate",hash:{},data:g}):f))+'"'},10:function(c,b,d,e,g){var f;return'data-last-valid-date\x3d"'+c.escapeExpression((f=null!=(f=d.lastValidDate||(null!=b?b.lastValidDate:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"lastValidDate",hash:{},data:g}):f))+'"'},12:function(c,b,d,e,g){var f,a;return"data-blackout-dates\x3d'"+(null!=(f=(a=null!=(a=d.blackoutDates||(null!=b?b.blackoutDates:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"blackoutDates",hash:{},data:g}):a))?f:"")+"'"},14:function(c,b,d,e,g){var f;return'data-default-range-length\x3d"'+c.escapeExpression((f=null!=(f=d.defaultRangeLength||(null!=b?b.defaultRangeLength:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"defaultRangeLength",hash:{},data:g}):f))+'"'},16:function(c,b,d,e,g){var f;return'data-max-range-length\x3d"'+c.escapeExpression((f=null!=(f=d.maxRangeLength||(null!=b?b.maxRangeLength:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=
b?b:{},{name:"maxRangeLength",hash:{},data:g}):f))+'"'},18:function(c,b,d,e,g){return'data-auto-pos\x3d"true"'},20:function(c,b,d,e,g){return'data-show-keyboard\x3d"true"'},22:function(c,b,d,e,g){return'data-close\x3d"false"'},24:function(c,b,d,e,g){var f;return'id\x3d"'+c.escapeExpression((f=null!=(f=d.labelId||(null!=b?b.labelId:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"labelId",hash:{},data:g}):f))+'" '},26:function(c,b,d,e,g){var f,a;return null!=(f=(a=null!=(a=d.placeholder||(null!=b?b.placeholder:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"placeholder",hash:{},data:g}):a))?f:""},28:function(c,b,d,e,g){var f;return null!=(f=(d.i18n||b&&b.i18n||d.helperMissing).call(null!=b?b:{},"date_picker_date_hbs_placeholder",{name:"i18n",hash:{bundle:"uitk_messages",locale:null!=b?b.locale:b},data:g}))?f:""},30:function(c,b,d,e,g){var f;return'data-min-range-length\x3d"'+c.escapeExpression((f=null!=(f=d.minRangeLength||(null!=b?b.minRangeLength:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"minRangeLength",hash:{},data:g}):f))+'"'},32:function(c,b,d,e,g){var f,a;return' value\x3d"'+(null!=(f=(a=null!=(a=d.value||(null!=b?b.value:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"value",hash:{},data:g}):a))?f:"")+'"'},34:function(c,b,d,e,g){var f;return'id\x3d"'+c.escapeExpression((f=null!=(f=d.dropDownId||(null!=b?b.dropDownId:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"dropDownId",hash:{},data:g}):f))+'"'},usePartial:!0,useData:!0});(e.templates=e.templates||{})["datepicker-tag.hbs"]=h;return(e.partials=e.partials||{})["datepicker-tag.hbs"]=h});define("uitk_hb_datepicker",["uitk_hb_shared_utilities","uitk_hb_template_utility","uitk_hb_button","uitk_hb_icon","datepicker-tag.hbs"],function(){var e=uitk_hb_utilities,h={TEMPLATE_NAME:"datepicker-tag",DATEPICKER_TYPE_DEFAULT:"single",DATEPICKER_TYPE_ENUM:{single:"single",startdate:"startdate",enddate:"enddate"},POSITION_DEFAULT:"left",POSITION_ENUM:{left:"left",right:"right",center:"center"},AUTOPOS_DEFAULT:"true",TRIGGER_TYPE_DEFAULT:"input",TRIGGER_TYPE_ENUM:{input:"input",button:"button"},CLOSE_DEFAULT:"true",SHOWKEYBOARD_DEFAULT:"false",isButton:function(c){return"button"===c},isInput:function(c){return"input"===c},isSingle:function(c){return"single"===c},isStartDate:function(c){return"startdate"===c},isEndDate:function(c){return"enddate"===c},autoPosIsTrue:function(c){return"true"===c},showKeyboardIsTrue:function(c){return"true"===c},closeIsTrue:function(c){return"true"===c},validateParameters:function(c,b,d,l,g,f,a,k,h,n,q,r,s,t,v,m){e.validateEnum(this.TEMPLATE_NAME,"datePickerType",this.DATEPICKER_TYPE_ENUM,c);e.validateEnum(this.TEMPLATE_NAME,"triggerType",this.TRIGGER_TYPE_ENUM,b);e.validateEnum(this.TEMPLATE_NAME,"position",this.POSITION_ENUM,g);e.validateRequired(this.TEMPLATE_NAME,"labelText",d);e.validateRequired(this.TEMPLATE_NAME,"inputId",l);e.validateBool(f,"autoPos",this.TEMPLATE_NAME);n&&!k&&e.throwMessage("The 'endDate' parameter is required for a datePickerType of 'startDate' on the ["+this.TEMPLATE_NAME+"]","reference");q&&!a&&e.throwMessage("The 'startDate' parameter is required for a datePickerType of 'endDate' on the ["+this.TEMPLATE_NAME+"]","reference");k&&!n&&e.throwMessage("The datePickerType parameter must equal 'startDate' if an endDate exists on the ["+this.TEMPLATE_NAME+"]","type");a&&!q&&e.throwMessage("The datePickerType parameter must equal 'endDate' if a startDate exists on the ["+this.TEMPLATE_NAME+"]","type");m||!n&&!q||e.throwMessage("The 'id' parameter is required for a pair of Date Pickers on the ["+this.TEMPLATE_NAME+"]","type");r&&(s||t||v)&&e.throwMessage("This parameter is not valid for a datePickerType of 'single' on the ["+this.TEMPLATE_NAME+"]","type")},help:function(c,b){var d=b.hash,l=d.id,g=e.lowerCase(d.datePickerType,this.DATEPICKER_TYPE_DEFAULT),f=d.inputId,a=e.lowerCase(d.position,this.POSITION_DEFAULT),k=d.autoPos?e.lowerCase(d.autoPos):this.AUTOPOS_DEFAULT,h=this.autoPosIsTrue(k),n=e.lowerCase(d.triggerType,this.TRIGGER_TYPE_DEFAULT),q=this.isButton(n),r=this.isInput(n),s=d.inputClasses?" "+e.lowerCase(d.inputClasses):"",t=d.inputAttributes?e.parseAttributes(d.inputAttributes):"",v=d.inputDataAttributes?e.parseAttributes(d.inputDataAttributes,"data"):"",m=d.placeholder,w=d.labelText,u=d.labelId,z=d.labelClasses?" "+e.lowerCase(d.labelClasses):"",y=d.labelAttributes?e.parseAttributes(d.labelAttributes):"",D=d.labelDataAttributes?e.parseAttributes(d.labelDataAttributes,"data"):"",G=d.firstValidDate,A=d.lastValidDate,x=d.blackoutDates,F=this.isSingle(g),B=d.startDate,C=this.isStartDate(g),I=d.endDate,K=this.isEndDate(g),H=d.defaultRangeLength,J=d.minRangeLength,E=d.maxRangeLength,M=d.dropDownClasses?" "+e.lowerCase(d.dropDownClasses):"",N=d.dropDownId,O=d.dropDownAttributes?e.parseAttributes(d.dropDownAttributes):"",L=d.dropDownDataAttributes?e.parseAttributes(d.dropDownDataAttributes,"data"):"",P=d.showKeyboard?e.lowerCase(d.showKeyboard):this.SHOWKEYBOARD_DEFAULT,R=this.showKeyboardIsTrue(P),Q=d.close?e.lowerCase(d.close):this.CLOSE_DEFAULT,S=this.closeIsTrue(Q),d=d.value,h={id:l,datePickerType:g,inputId:f,position:a,autoPosIsTrue:h,triggerType:n,isButton:e.parseBoolean(q),isInput:e.parseBoolean(r),inputClasses:s,inputAttributes:t,inputDataAttributes:v,placeholder:m,labelText:w,labelId:u,labelClasses:z,labelAttributes:y,labelDataAttributes:D,firstValidDate:G,lastValidDate:A,blackoutDates:x,startDate:B,endDate:I,defaultRangeLength:H,minRangeLength:J,maxRangeLength:E,dropDownClasses:M,dropDownId:N,dropDownAttributes:O,dropDownDataAttributes:L,showKeyboard:P,showKeyboardIsTrue:R,close:Q,closeIsTrue:S,value:d,partialData:{objectName:"iconTag",tagName:"uitk_icon",params:{name:"calendar"}},_templateName:this.TEMPLATE_NAME};this.validateParameters(g,n,w,f,a,k,B,I,r,C,K,F,H,J,E,l);return JSON.stringify(h)}};registerUitkHelper(h,"uitk_datePicker",!0);return h});require("uitk_hb_datepicker",function(){});
define("uitk_hb_figure",["uitk_hb_template_utility","uitk_hb_src","uitk_hb_loader","figure-tag.hbs"],function(){var e=uitk_hb_utilities,h={TEMPLATE_NAME:"figure-tag",ALT_DEFAULT:"",MEDIATYPE_DEFAULT:"image",MEDIATYPE_ENUM:{image:"image",background:"background",youtube:"youtube"},AR_DEFAULT:"16-9",AR_ENUM:{"1-1":"aspect-ratio1-1","3-2":"aspect-ratio3-2","4-3":"aspect-ratio4-3","16-9":"aspect-ratio16-9","5-1":"aspect-ratio5-1"},FLUID_IMAGE:{desktop:" fluid-height-desktop",tablet:" fluid-height-tablet",smallTablet:" fluid-height-smallTablet",mobile:" fluid-height-mobile"},isItImage:function(c){c=c?c.toLowerCase():"";return"image"===c||"background"===c?!0:!1},setCssClasses:function(c,b,d,e,g,f,a){var k;if(c)switch(c){case "image":k="image";break;case "background":k="image background";break;case "youtube":k="media";break;default:k=""}g&&(k=f?k+(" aspect-ratio"+g):k+(" "+this.AR_ENUM[g]));if(b||d||"youtube"===c)k+=" loading";e&&(k+=" resize-shrink");a&&(k+=this.FLUID_IMAGE[a]);return k},getSrcSet:function(c){var b,d,e="";if(void 0!==c&&"object"===typeof c)for(d=c.length,e=c[0].src,b=1;b<d;b++)e+=", "+c[b].src;return e},getLoading:function(c,b,d){var h={};"true"===b&&"true"===d&&e.throwMessage("Image cannot be both lazy and late loaded. Choose one.","type");c&&0<c.length&&!b&&!d?(h.lazy=!0,h.late=!1):(h.lazy="true"===b,h.late="true"===d);return h},setSvgLazy:function(c){var b=c.late,d=c.svgFallback;d&&0<d.length&&(c.lazy=!0,c.lazyIsTrue=!0);b&&d&&0<d.length&&(c.lazy=!1);return c},validateParameters:function(c,b){var d=c.src,h=c.mediaType,g=c.aspectRatio,f=c.mediaId;h&&-1===h.indexOf("{")&&!this.MEDIATYPE_ENUM.hasOwnProperty(h)&&e.throwMessage('"'+h+'" is invalid value for the "mediaType" parameter on the '+this.TEMPLATE_NAME+" tag.","type");g&&-1===g.indexOf("{")&&!this.AR_ENUM.hasOwnProperty(g)&&e.throwMessage('"'+g+'" is invalid value for the "aspectRatio" parameter on the '+this.TEMPLATE_NAME+" tag.","type");f&&d&&e.throwMessage('"'+d+'" is invalid value for the "src" parameter when used together with "mediaId" parameter on the '+this.TEMPLATE_NAME+" tag.","type");"image"===h&&f&&e.throwMessage('"'+f+'" is invalid value for the "mediaId" parameter when used in an image on the '+this.TEMPLATE_NAME+" tag.","type");b&&!this.FLUID_IMAGE.hasOwnProperty(b)&&e.throwMessage('"'+b+'" is invalid value for the "fluidHeight" parameter on the '+this.TEMPLATE_NAME+" tag.","type")},help:function(c,b){var d=b.hash,h=e.parseContent(d.content),g=d.template,f=d.mediaType?d.mediaType:this.MEDIATYPE_DEFAULT,a=d.mediaId,k=d.mediaOptions,p=d.mediaUrl,n=this.isItImage(f),q=!n,r=d.path,s=d.src,t=this.getSrcSet(h.jsonContent),v=this.getLoading(t,d.lazy,d.late),m=v.lazy,w=v.late,u=m||w,z=d.downgrade,y=d.aspectRatio?d.aspectRatio:this.AR_DEFAULT,D=d.svgFallback,G=d.videoParameters,v=d.fluidHeight,A=d.alt?d.alt:this.ALT_DEFAULT,x=d.caption,d=d.resizeShrink,F=m||w||q,B=this.setCssClasses(f,m,w,d,y,g,v),h={_templateName:"figure-tag",content:h.allNoneJsonContent,template:g,mediaType:f,mediaId:a,mediaOptions:k,mediaUrl:p,isImage:n,isYouTube:q,lazy:m,late:w,lazyIsTrue:u,downgrade:z,path:r,src:s,srcSet:t,aspectRatio:y,svgFallback:D,videoParameters:G,alt:A,caption:x,resizeShrink:d,useMediaLoader:F,cssClass:B,partialData:{objectName:"loaderPartial",tagName:"uitk_loader",params:{color:n?"light":"dark",classes:"loading",type:"static"}}};this.setSvgLazy(h);this.validateParameters(h,v);return JSON.stringify(h).trim()}};registerUitkHelper(h,"uitk_figure",!0);return h});require("uitk_hb_figure",function(){});define("loader-tag.hbs",["handlebars"],function(e){var h=e.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,b,d,e,g){var f,a;c=(f=null!=(f=d.compress||(null!=b?b.compress:b))?f:d.helperMissing,a={name:"compress",hash:{},fn:c.program(1,g,0),inverse:c.noop,data:g},"function"===typeof f?f.call(null!=b?b:{},a):f);d.compress||(c=d.blockHelperMissing.call(b,c,a));return null!=c?c:""},1:function(c,b,d,e,g){var f,a;return(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.overlayIsTrue:b,{name:"if",hash:{},fn:c.program(2,g,0),inverse:c.noop,data:g}))?f:"")+"\n  \x3cspan "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.id:b,{name:"if",hash:{},fn:c.program(4,g,0),inverse:c.noop,data:g}))?f:"")+'\n      class\x3d"loader'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.overlayIsTrue:b,{name:"if",hash:{},fn:c.program(6,g,0),inverse:c.program(8,g,0),data:g}))?f:"")+c.escapeExpression((a=null!=(a=d.classes||(null!=b?b.classes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"classes",hash:{},data:g}):a))+'"'+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+" "+(null!=(f=d.unless.call(null!=b?b:{},null!=b?b.isYouTube:b,{name:"unless",hash:{},fn:c.program(10,g,0),inverse:c.noop,data:g}))?f:"")+' title\x3d"Loading..."\x3e\n  \x3c/span\x3e\n'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.overlayIsTrue:b,{name:"if",hash:{},fn:c.program(12,g,0),inverse:c.noop,data:g}))?f:"")+"\n"},2:function(c,b,d,e,g){return'\x3cdiv class\x3d"loader-overlay loading"\x3e'},4:function(c,b,d,e,g){var f;return'id\x3d"'+c.escapeExpression((f=null!=(f=d.id||(null!=b?b.id:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"id",hash:{},data:g}):f))+'"'},6:function(c,b,d,e,g){return" loader-dark"},8:function(c,b,d,e,g){var f;return" "+c.escapeExpression((f=null!=(f=d.cssClass||(null!=b?b.cssClass:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"cssClass",hash:{},data:g}):f))},10:function(c,b,d,e,g){return'aria-hidden\x3d"true"'},12:function(c,b,d,e,g){return"\x3c/div\x3e"},useData:!0});(e.templates=e.templates||{})["loader-tag.hbs"]=h;return(e.partials=e.partials||{})["loader-tag.hbs"]=h});define("uitk_hb_loader",["uitk_hb_shared_utilities","uitk_hb_template_utility","loader-tag.hbs"],function(){var e=uitk_hb_utilities,h={TEMPLATE_NAME:"loader-tag",LEVEL_DEFAULT:"primary",LEVEL_ENUM:{primary:"loader-primary",secondary:"loader-secondary"},COLOR_DEFAULT:"light",COLOR_ENUM:{light:"loader-light",dark:"loader-dark"},TYPE_DEFAULT:"animated",TYPE_ENUM:{animated:"loader-animated","static":"loader-static"},getCssClasses:function(c,b,d,h){c=e.validateEnum(this.TEMPLATE_NAME,"level",this.LEVEL_ENUM,c);b=e.validateEnum(this.TEMPLATE_NAME,"color",this.COLOR_ENUM,b);d=e.validateEnum(this.TEMPLATE_NAME,"type",this.TYPE_ENUM,d);h&&(c=this.LEVEL_DEFAULT,b="dark",d=this.TYPE_DEFAULT);return this.LEVEL_ENUM[c]+" "+this.COLOR_ENUM[b]+" "+this.TYPE_ENUM[d]},help:function(c,b){var d=b.hash,h="true"===(d.overlay?d.overlay.toLowerCase():"false")?!0:void 0,g=e.lowerCase(d.level,this.LEVEL_DEFAULT),f=e.lowerCase(d.color,this.COLOR_DEFAULT),a=e.lowerCase(d.type,this.TYPE_DEFAULT),g=this.getCssClasses(g,f,a,h);return JSON.stringify({_templateName:this.TEMPLATE_NAME,id:d.id,overlayIsTrue:h,cssClass:g})}};registerUitkHelper(h,"uitk_loader",!0);return h});require("uitk_hb_loader",function(){});
define("uitk_hb_src",["uitk_hb_shared_utilities","uitk_hb_template_utility"],function(){var e=uitk_hb_utilities,h={TAG_NAME:"src-tag",MEDIA_DEFAULT:"desktop",MEDIA_ENUM:{desktop:1176,tablet:959,smallTablet:725,mobile:491},RATIO_DEFAULT:"16-9",RATIO_ENUM:{"1-1":"1-1","3-2":"3-2","4-3":"4-3","16-9":"16-9","5-1":"5-1"},generateMediaQueryWidth:function(c,b){var d;c?d=this.MEDIA_ENUM[c]:b&&(d=b);return d},generateSrcString:function(c,b,d,e,g){c=c?c.trim():"";d&&(b!==this.MEDIA_DEFAULT&&b||(c+=" "+d+"w"));b&&b!==this.MEDIA_DEFAULT&&(c+=" "+this.MEDIA_ENUM[b]+"w");e&&e!==this.RATIO_DEFAULT&&(c+=" "+this.RATIO_ENUM[e]);g&&(c+=" 2x");return c.trim()},validateParameters:function(c,b){e.validateEnum(this.TAG_NAME,"media",this.MEDIA_ENUM,c);e.validateEnum(this.TAG_NAME,"ratio",this.RATIO_ENUM,b)},help:function(c,b){var d=b.hash,e=d.src,g=d.media?d.media:this.MEDIA_DEFAULT,f=d.width,a=this.generateMediaQueryWidth(d.media,f),k="true"===d.retina?d.retina:void 0,h=d.ratio?d.ratio:this.RATIO_DEFAULT,d={src:this.generateSrcString(e,g,f,h,k),retina:k,fileName:d.src,mediaQueryWidth:a?" and (max-width: "+parseInt(a)/16+"em)":void 0};this.validateParameters(g,h);return JSON.stringify(d).trim()}};registerUitkHelper(h,"uitk_src",!1);return h});require("uitk_hb_src",function(){});
define("image-gallery-tag.hbs",["handlebars"],function(e){var h=e.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,b,d,e,g){var f,a;return"\x3csection"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.id:b,{name:"if",hash:{},fn:c.program(1,g,0),inverse:c.program(3,g,0),data:g}))?f:"")+' class\x3d"media-viewer resize-shrink'+c.escapeExpression((a=null!=(a=d.classes||(null!=b?b.classes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"classes",hash:{},data:g}):a))+'" data-control\x3d"media-viewer" data-slider-id\x3d"'+c.escapeExpression((a=null!=(a=d.slideId||(null!=b?b.slideId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"slideId",hash:{},data:g}):a))+'" '+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+'\x3e\n  \x3cspan class\x3d"media-loader animated"\x3e'+(null!=(f=c.invokePartial(e["loader-tag"],null!=b?b.loaderTag:b,{name:"loader-tag",data:g,helpers:d,partials:e,decorators:c.decorators}))?f:"")+'\x3c/span\x3e\n\x3c/section\x3e\n\n\x3csection class\x3d"image-slider" data-control\x3d"image-slider" data-slider-id\x3d"'+c.escapeExpression((a=null!=(a=d.slideId||(null!=b?b.slideId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"slideId",hash:{},data:g}):a))+'" '+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.id:b,{name:"if",hash:{},fn:c.program(5,g,0),inverse:c.program(7,g,0),data:g}))?f:"")+'\x3e\n  \x3cbutton class\x3d"image-slider-control prev"\x3e\x3cspan class\x3d"icon icon-toggle270" aria-hidden\x3d"true"\x3e\x3c/span\x3e\x3cspan class\x3d"visuallyhidden"\x3ePrevious image\x3c/span\x3e\x3c/button\x3e\n  \x3cdiv class\x3d"image-slider-mask"\x3e\n    \x3cul class\x3d"image-slider-thumbs"\x3e\n'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.outputTemplate:b,{name:"if",hash:{},fn:c.program(9,g,0),inverse:c.program(21,g,0),data:g}))?f:"")+'    \x3c/ul\x3e\n  \x3c/div\x3e\n\x3cbutton class\x3d"image-slider-control next"\x3e\x3cspan class\x3d"visuallyhidden"\x3eNext image\x3c/span\x3e\x3cspan class\x3d"icon icon-toggle90" aria-hidden\x3d"true"\x3e\x3c/span\x3e\x3c/button\x3e\n\x3c/section\x3e\n'},1:function(c,b,d,e,g){var f;return' id\x3d"'+c.escapeExpression((f=null!=(f=d.id||(null!=b?b.id:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"id",hash:{},data:g}):f))+'" '},3:function(c,b,d,e,g){return' id\x3d"media-viewer" '},5:function(c,b,d,e,g){var f;return' aria-controls\x3d"'+c.escapeExpression((f=null!=(f=d.id||(null!=b?b.id:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"id",hash:{},data:g}):f))+'" '},7:function(c,b,d,e,g){return' aria-controls\x3d"media-viewer" '},9:function(c,b,d,e,g){var f,a;return"          "+(null!=(f=(a=null!=(a=d.beforeContent||(null!=b?b.beforeContent:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"beforeContent",hash:{},data:g}):a))?f:"")+"\n"+(null!=(f=d.each.call(null!=b?b:{},null!=b?b.images:b,{name:"each",hash:{},fn:c.program(10,g,0),inverse:c.noop,data:g}))?f:"")+"          "+(null!=(f=(a=null!=(a=d.afterContent||(null!=b?b.afterContent:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"afterContent",hash:{},data:g}):a))?f:"")+"\n"},10:function(c,b,d,e,g){var f,a;return"            \x3cli\x3e\n              "+(null!=(f=(a=null!=(a=d.ifHelper||(null!=b?b.ifHelper:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"ifHelper",hash:{},data:g}):a))?f:"")+'\n              \x3ca href\x3d"https://www.youtube.com/embed/'+(null!=(f=(a=null!=(a=d.mediaId||(null!=b?b.mediaId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaId",hash:{},data:g}):a))?f:"")+"?enablejsapi\x3d1"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.videoParameters:b,{name:"if",hash:{},fn:c.program(11,g,0),inverse:c.noop,data:g}))?f:"")+'"\n                '+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.videoParameters:b,{name:"if",hash:{},fn:c.program(13,g,0),inverse:c.noop,data:g}))?f:"")+' data-media-type\x3d"'+c.escapeExpression((a=null!=(a=d.mediaType||(null!=b?b.mediaType:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaType",hash:{},data:g}):a))+'" data-media-id\x3d"'+c.escapeExpression((a=null!=(a=d.mediaId||(null!=b?b.mediaId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaId",hash:{},data:g}):a))+'"\n                 class\x3d"video'+c.escapeExpression((a=null!=(a=d.classes||(null!=b?b.classes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"classes",hash:{},data:g}):a))+'"'+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+'\x3e\n                \x3cimg src\x3d"'+c.escapeExpression((a=null!=(a=d.thumb||(null!=b?b.thumb:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"thumb",hash:{},data:g}):a))+'" alt\x3d"'+(null!=(f=(a=null!=(a=d.alt||(null!=b?b.alt:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"alt",hash:{},data:g}):a))?f:"")+'" /\x3e\n                \x3cspan class\x3d"icon icon-play"\x3e\x3c/span\x3e\n              \x3c/a\x3e\n              '+(null!=(f=(a=null!=(a=d.ifHelperElse||(null!=b?b.ifHelperElse:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"ifHelperElse",hash:{},data:g}):a))?f:"")+'\n              \x3ca href\x3d"'+c.escapeExpression((a=null!=(a=d.main||(null!=b?b.main:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"main",hash:{},data:g}):a))+'"'+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.classes:b,{name:"if",hash:{},fn:c.program(15,g,0),inverse:c.noop,data:g}))?f:"")+' data-media-type\x3d"image"'+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.srcSet:b,{name:"if",hash:{},fn:c.program(17,g,0),inverse:c.noop,data:g}))?f:"")+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.caption:b,{name:"if",hash:{},fn:c.program(19,g,0),inverse:c.noop,data:g}))?f:"")+'\x3e\n                \x3cimg src\x3d"'+c.escapeExpression((a=null!=(a=d.thumb||(null!=b?b.thumb:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"thumb",hash:{},data:g}):a))+'" alt\x3d"'+(null!=(f=(a=null!=(a=d.alt||(null!=b?b.alt:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"alt",hash:{},data:g}):a))?f:"")+'" /\x3e\n              \x3c/a\x3e\n              '+(null!=(f=(a=null!=(a=d.ifHelperIf||(null!=b?b.ifHelperIf:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"ifHelperIf",hash:{},data:g}):a))?f:"")+"\n            \x3c/li\x3e\n"},11:function(c,b,d,e,g){var f;return c.escapeExpression((f=null!=(f=d.videoParameters||(null!=b?b.videoParameters:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"videoParameters",hash:{},data:g}):f))},13:function(c,b,d,e,g){var f;return' data-video-parameters\x3d"'+c.escapeExpression((f=null!=(f=d.videoParameters||(null!=b?b.videoParameters:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"videoParameters",hash:{},data:g}):f))+'"'},15:function(c,b,d,e,g){var f;return' class\x3d"'+c.escapeExpression((f=null!=(f=d.classes||(null!=b?b.classes:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"classes",hash:{},data:g}):f))+'"'},17:function(c,b,d,e,g){var f;return' data-srcset\x3d"'+c.escapeExpression((f=null!=(f=d.srcSet||(null!=b?b.srcSet:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"srcSet",hash:{},data:g}):f))+'"'},19:function(c,b,d,e,g){var f,a;return' data-caption\x3d"'+(null!=(f=(a=null!=(a=d.caption||(null!=b?b.caption:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"caption",hash:{},data:g}):
a))?f:"")+'"'},21:function(c,b,d,e,g){var f;return null!=(f=d.each.call(null!=b?b:{},null!=b?b.images:b,{name:"each",hash:{},fn:c.program(22,g,0),inverse:c.noop,data:g}))?f:""},22:function(c,b,d,e,g){var f;return"          \x3cli\x3e\n"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.isImage:b,{name:"if",hash:{},fn:c.program(23,g,0),inverse:c.program(28,g,0),data:g}))?f:"")+"          \x3c/li\x3e\n"},23:function(c,b,d,e,g){var f,a;return'             \x3ca href\x3d"'+c.escapeExpression((a=null!=(a=d.main||(null!=b?b.main:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"main",hash:{},data:g}):a))+'" data-media-type\x3d"image"\n                '+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.classes:b,{name:"if",hash:{},fn:c.program(15,g,0),inverse:c.noop,data:g}))?f:"")+"\n                "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.path:b,{name:"if",hash:{},fn:c.program(24,g,0),inverse:c.noop,data:g}))?f:"")+"\n                "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.srcSet:b,{name:"if",hash:{},fn:c.program(17,g,0),inverse:c.noop,data:g}))?f:"")+"\n                "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.downgradeIsTrue:b,{name:"if",hash:{},fn:c.program(26,g,0),inverse:c.noop,data:g}))?f:"")+"\n                "+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.caption:b,{name:"if",hash:{},fn:c.program(19,g,0),inverse:c.noop,data:g}))?f:"")+"\n                "+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+'\x3e\n               \x3cimg src\x3d"'+c.escapeExpression((a=null!=(a=d.thumb||(null!=b?b.thumb:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"thumb",hash:{},data:g}):a))+'" alt\x3d"'+(null!=(f=(a=null!=(a=d.alt||(null!=b?b.alt:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"alt",hash:{},data:g}):a))?f:"")+'" /\x3e\n             \x3c/a\x3e\n'},24:function(c,b,d,e,g){var f;return' data-path\x3d"'+c.escapeExpression((f=null!=(f=d.path||(null!=b?b.path:b))?f:d.helperMissing,"function"===typeof f?f.call(null!=b?b:{},{name:"path",hash:{},data:g}):f))+'"'},26:function(c,b,d,e,g){return' data-downgrade\x3d"true"'},28:function(c,b,d,e,g){var f,a;return'             \x3ca href\x3d"https://www.youtube.com/embed/'+(null!=(f=(a=null!=(a=d.mediaId||(null!=b?b.mediaId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaId",hash:{},data:g}):a))?f:"")+"?enablejsapi\x3d1"+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.videoParameters:b,{name:"if",hash:{},fn:c.program(11,g,0),inverse:c.noop,data:g}))?f:"")+'"\n               '+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.videoParameters:b,{name:"if",hash:{},fn:c.program(13,g,0),inverse:c.noop,data:g}))?f:"")+' data-media-type\x3d"'+c.escapeExpression((a=null!=(a=d.mediaType||(null!=b?b.mediaType:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaType",hash:{},data:g}):a))+'" data-media-id\x3d"'+c.escapeExpression((a=null!=(a=d.mediaId||(null!=b?b.mediaId:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"mediaId",hash:{},data:g}):a))+'"\n                   class\x3d"video'+c.escapeExpression((a=null!=(a=d.classes||(null!=b?b.classes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"classes",hash:{},data:g}):a))+'"'+(null!=(f=(a=null!=(a=d.dataAttributes||(null!=b?b.dataAttributes:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"dataAttributes",hash:{},data:g}):a))?f:"")+'\x3e\n               \x3cimg src\x3d"'+c.escapeExpression((a=null!=(a=d.thumb||(null!=b?b.thumb:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"thumb",hash:{},data:g}):a))+'" alt\x3d"'+(null!=(f=(a=null!=(a=d.alt||(null!=b?b.alt:b))?a:d.helperMissing,"function"===typeof a?a.call(null!=b?b:{},{name:"alt",hash:{},data:g}):a))?f:"")+'" /\x3e\n               \x3cspan class\x3d"icon icon-play"\x3e\x3c/span\x3e\n             \x3c/a\x3e\n'},usePartial:!0,useData:!0});(e.templates=e.templates||{})["image-gallery-tag.hbs"]=h;return(e.partials=e.partials||{})["image-gallery-tag.hbs"]=h});define("uitk_hb_gallery_image",["uitk_hb_template_utility","uitk_hb_figure"],function(){var e=uitk_hb_utilities,h={TAG_NAME:"uitk_galleryImage",MEDIATYPE_DEFAULT:"image",MEDIATYPE_ENUM:{image:"image",youtube:"youtube"},DOWNGRADE_ENUM:{"true":!0,"false":!1},DOWNGRADE_DEFAULT:"",isItImage:function(c){return"image"===(c?c.toLowerCase():"")?!0:""},getSrcSet:function(c){var b,d,e="";if(c)for(d=c.length,e=c[0].src,b=1;b<d;b++)e+=", "+c[b].src;return e},validateParameters:function(c){var b=this.TAG_NAME,d=c.isImage,h=c.alt,g=c.thumb,f=c.mediaType,a=c.mediaId,k=c.main;c=c.downgrade;e.validateEnum(this.TAG_NAME,"mediaType",this.MEDIATYPE_ENUM,f);e.validateEnum(this.TAG_NAME,"downgrade",this.DOWNGRADE_ENUM,c);h||e.throwMessage("Parameter 'alt' is required value on the '"+b+"' if 'caption' is not set. You have to set at least one of them.","reference");g||e.throwMessage("Parameter 'thumb' is required value on the '"+b+"'.","reference");d&&!k&&e.throwMessage("Parameter 'main' is required value on the '"+b+"' when mediaType is '"+f+"'.","reference");d||a||e.throwMessage("Parameter 'mediaId' is required value on the '"+b+"' when mediaType is '"+f+"'.","reference")},help:function(c,b){var d=b.hash,h=e.parseContent(d.content),g=d.main,f=d.thumb,a=d.mediaType?d.mediaType:this.MEDIATYPE_DEFAULT,k=d.mediaId,p=this.isItImage(a),n=d.path,h=this.getSrcSet(h.jsonContent),d={main:g,thumb:f,mediaType:a,mediaId:k,isImage:p,downgradeIsTrue:"true"===d.downgrade||this.DOWNGRADE_DEFAULT,path:n,srcSet:h,videoParameters:d.videoParameters,alt:d.alt?d.alt:d.caption,caption:d.caption,srcJson:"true",ifHelper:"{{#unless isImage}}",ifHelperElse:"{{else}}",ifHelperIf:"{{/unless}}"};this.validateParameters(d);return JSON.stringify(d).trim()}};"undefined"!==typeof window&&window.uitk&&window.uitk.modelGenerators&&(window.uitk.modelGenerators.uitk_galleryImage=h);registerUitkHelper(h,"uitk_galleryImage",!1);return h});require("uitk_hb_gallery_image",function(){});define("uitk_hb_image_gallery",["uitk_hb_shared_utilities","uitk_hb_template_utility","uitk_hb_loader","image-gallery-tag.hbs"],function(){var e=uitk_hb_utilities,h={TEMPLATE_NAME:"image-gallery-tag",help:function(c,b){var d=b.hash,h=e.parseContent(d.content),g=d.slideId,d={_templateName:"image-gallery-tag",beforeContent:h.preJsonContent,afterContent:h.postJsonContent,images:h.jsonContent,slideId:g,outputTemplate:"true"===d.template||!1,partialData:{objectName:"loaderTag",tagName:"uitk_loader",params:{color:"dark",classes:"loading"}}};g||e.throwMessage("Parameter 'slideId' is required value for the "+this.TEMPLATE_NAME+" tag.","type");return JSON.stringify(d)}};registerUitkHelper(h,"uitk_imageGallery",!0);return h});require("uitk_hb_image_gallery",function(){});define("configurator","jquery underscore marionette templates behaviors uitk uitk_datepicker calendarConfig".split(" "),function(e,h,c,b,d,l,g,f){return{configureMarionette:function(){c.Behaviors.behaviorsLookup=function(){return d};h.each(b,function(a,b){var d=new c.TemplateCache(b);d.compiledTemplate=a;c.TemplateCache.templateCaches[b]=d})},configureAjax:function(){e.ajaxSetup({timeout:1E4});e(document).ajaxError(function(a,b,c,d){require("logger",function(a){a.logError("ajaxError",d,{ajaxUrl:c.url.split("?")[0],ajaxStatus:b.status,ajaxTimeout:c.timeout})})})},configureDatePicker:function(){var a=l.datePickerCalendarObj.config;a.setFormatConfig(f.calendarDateFormat,f.calendarDateSeparator);a.setUnitConfig(f.startDayOfTheWeek,f.calendarMonths,f.daysOfTheWeek);a.setTextConfig(f.closeLink)},configureSandbox:function(){e.ajaxPrefilter(function(a){a.crossDomain&&(a.url=["//",location.hostname,a.url].join(""),a.crossDomain=!1)})},configure:function(a){this.configureMarionette();this.configureAjax();this.configureDatePicker();a&&this.configureSandbox()}}});
define("i18n",["i18nData","underscore","handlebars"],function(e,h,c){var b,d;for(b in e)if("string"!==typeof e[b])for(d in e[b])/{{/.test(e[b][d])&&(e[b][d]=c.compile(e[b][d]));return h.extend({getMessage:function(b,c){var d=e;h.find(b.split("."),function(a){d=d[a];return!d});if(h.isFunction(d))return d(c);if(h.isString(d))return d;throw Error("i18n messageKey not found");}},e)});define("utils",["underscore","uitk"],function(e,h){return{now:function(){return e.now()},setTimeout:function(){return setTimeout.apply(window,arguments)},reload:function(c){window.location.reload(c)},locationReplace:function(c){window.location.replace(c)},setHash:function(c){window.location.hash=c},wrapAll:function(c,b){e.each(b,function(b,h){c.prototype[h]=e.wrap(c.prototype[h],b)});return c.prototype},findKey:function(c,b){return e.find(e.keys(c),b)},findModuleId:function(c){var b=window.modulizr._getDependencyMap();return this.findKey(b,function(d){return b[d].value===c})},calcExpiresLongDate:function(c){var b="";isNaN(c)||(b=h.utils.createLocalizedDate(new Date(c),h.locale).longDate());return b}}});define("handlebarsHelpers","jquery handlebars i18n hotelInfo infositeData uitk experiments modernizr infosite/env".split(" "),function(e,h,c,b,d,l,g,f,a){var k=0;h.registerHelper("uniqueId",function(){return"id"+(k+=1)});h.registerHelper("ifExists",function(a,b){return"undefined"!==typeof a?b.fn(this):b.inverse(this)});h.registerHelper("ifHasContent",function(a,b){if(a&&0<a.length)return b.fn(this);if(b.inverse)return b.inverse(this)});h.registerHelper("ifHasCategoryLabel",function(a,b){var c;if(0<a.length&&a[0].categoryLabel&&0<a[0].categoryLabel.length)return require("reviews",function(b){c=b.urs.localizedCategories[a[0].categoryLabel]}),b.fn({localizedCategory:c||a[0].categoryLabel})});h.registerHelper("formatDate",function(a){if(!a)return"";var b=a.substring(0,19);a=b.split("T")[0].split("-");b=b.split("T")[1].split(":");a=(new Date(Date.UTC(a[0],a[1]-1,a[2],b[0],b[1],b[2],0))).toUTCString().split(", ")[1].split(" ");return a[1]+" "+a[0]+", "+a[2]});h.registerHelper("localizeDate",function(a){return(new Date(a)).toLocaleDateString(d.jsLocale,{year:"numeric",month:"short",day:"numeric"})});h.registerHelper("if_eq",function(a,b){return a==b.hash.compare?b.fn(this):b.inverse(this)});h.registerHelper("closeThisMessage",function(){return new h.SafeString(c.urgency.closeThisMessage)});h.registerHelper("ifString",function(a,b){return"string"===typeof a?b.fn(this):b.inverse(this)});h.registerHelper("currentHotelName",function(){return this.hotelName?new h.SafeString(this.hotelName):new h.SafeString(b.name)});h.registerHelper("getAmenity",function(a){return(a=c.mrpTemplates["amenity"+a])?new h.SafeString("function"===typeof a?a(this):a):""});h.registerHelper("hasAmenity",function(a,b){return""!==h.helpers.getAmenity(a)?b.fn(this):""});h.registerHelper("loc",function(a){return new h.SafeString(c.getMessage(a,this))});h.registerHelper("rfrrBase",function(){return b.rfrrBase});h.registerHelper("inspect",function(){debugger;return""});h.registerHelper("json",function(){return window.JSON.stringify(this)});h.registerHelper("tracking",function(a){return d.rfrrBase+a});h.registerHelper("exp",function(a){var b=Array.prototype.pop.call(arguments,arguments.length-1);if(null!==a&&1<arguments.length)for(var c=1;c<arguments.length;c++)if(0===arguments[c]&&!g[a]||g[a]===arguments[c])return b.fn(this);return b.inverse(this)});h.registerHelper("taapShowCommission",function(a,b,c){var d=0;try{d=parseFloat(a),isNaN(d)&&(d=0)}catch(f){}a='\x3cspan class\x3d"taap-commission-estimate"\x3e'+l.utils.createLocalizedPrice((d*b).toString(),l.locale,c).format()+"*\x3c/span\x3e";return new h.SafeString(a)});h.registerHelper("taapTotalPrice",function(a,c){var d='\x3cspan class\x3d"taap-commission-totalprice"\x3e'+l.utils.createLocalizedPrice(a,b.locale,c).roundHalfUp().format()+"\x3c/span\x3e";return new h.SafeString(d)});h.registerHelper("formatPrice",function(a,c){var d=l.utils.createLocalizedPrice(String(a),b.locale,c.hash.currency?c.hash.currency:b.currencyCode);c.hash.round&&(d="up"===c.hash.round?d.roundHalfUp():d.roundHalfDown());"1"===c.hash.siteId&&(d=d.roundHalfUp());return d.format()});h.registerHelper("roundPrice",function(a,b,c){b&&(c.hash.round="up");return h.helpers.formatPrice(a,c)});h.registerHelper("indexPlusOne",function(a){return"number"===typeof a.data.index?a.data.index+1:""});h.registerHelper("foreach",function(a,b){return b.inverse&&!a.length?b.inverse(this):a.map(function(c,d){c.$index=d;c.$first=0===d;c.$last=d===a.length-1;return b.fn(c)}).join("")});h.registerHelper("removePunctuation",function(a){return a.replace(/[^\w\s]|_/g,"").replace(/\s+/g," ")});e(function(){e(".datepicker-trigger-input[placeholder]").attr("placeholder",b.dateFormat)});h.registerHelper("datepicker_hack",function(a){a=a.fn(this).replace(/labelId/g,"id");!f.touch&&!f.win8touch||/readonly/.test(a)||(a=a.replace(/<input/g,'\x3cinput readonly\x3d"readonly"'));/autocomplete/.test(a)||(a=a.replace(/<input/g,'\x3cinput autocomplete\x3d"off"'));return a.replace(/placeholder="[^"]+"/g,'placeholder\x3d"'+b.dateFormat+'"')});h.registerHelper("environment",function(b,c){if(a[b])return c.fn(this);if(c.inverse)return c.inverse(this)});h.registerHelper("getViewTypeBadge",function(a,b){return new h.SafeString(c.getMessage(a+b,this))});return h.helpers});define("logger",["jquery"],function(e){function h(){return e.map(e.extend.apply({},arguments),function(b,c){return c+"\x3d"+encodeURIComponent(b)})}function c(b){var c=[];require(["serverGroupModel","hotelInfo","experiments"],function(b,e,f){c=h(b,{hotelId:e.id,ajaxRoomsAndRates:f[8100],reviewsCache:f[8886]})});e.isArray(b)?c=c.concat(b):"object"===typeof b&&(c=c.concat(h(b)));return c}return{logError:function(b,d,e){window.console&&window.console.error&&d.stack&&window.console.error(d.stack);require("dctk/clientLogging",function(g){"string"===typeof d&&(d=Error(d),d.stack="");g.logError(b,d,c(e))})},logMessage:function(b,d){require("dctk/clientLogging",function(e){e.logMessage(b,c(d))})},logTrxEvent:function(b,d){require("dctk/clientLogging",function(e){e.logTrxEvent(b,c(d))})},makeParamArray:h,addParams:c}});require("logger",function(e){window.onerror=function(h,c,b,d,l){e.logError("windowOnError",l||h)}});
define("errorView","jquery i18n wizardConfig marionette urlModel offersResponseModel".split(" "),function(e,h,c,b,d,l){var g=d.getSingleton(),f=l.getSingleton(),a={validationViewModels:{noCheckinDate:{id:"availMissingCheckIn",type:"required-error",href:"#availability-check-in",message:h.validationErrors.checkInRequiredError},noCheckoutDate:{id:"availMissingCheckOut",type:"required-error",href:"#availability-check-out",message:h.validationErrors.checkOutRequiredError},missingChildAge:{id:"required-age-error",type:"required-error",message:h.validationErrors.ageRequiredError},invalidCheckinDatePattern:{id:"availDateFormat",type:"pattern-error",message:h.validationErrors.dateFormatError},invalidCheckoutDatePattern:{id:"availDateFormat",type:"pattern-error",message:h.validationErrors.dateFormatError},checkinNotBeforeCheckout:{href:"#availability-check-in",message:h.validationErrors.checkinNotBeforeCheckout}}};return b.ItemView.extend({template:"error-messages",ui:{validationErrors:".error-summary"},events:{"click @ui.validationErrors":"focusOnInput"},model:f.errors,modelEvents:{change:"render"},focusOnInput:function(a){var b=e(a.target).attr("href");e(b).focus();a.preventDefault()},adaptAvailabilityErrors:function(a){var b;a&&(a=e.map(a,function(a){b=h.availabilityErrors[a.messageKey];"function"===typeof b&&(b=b(e.extend(a,c,{checkInDate:g.getCheckIn(),checkOutDate:g.getCheckOut(),numOfNightsRestriction:f.get("numOfNightsRestriction"),extraInfo:a.extraInfo})));return{message:b||h.availabilityErrors.defaultMessage}}));return a},adaptValidationErrors:function(b){var d;b&&(b=e.map(b,function(b){(d=a.validationViewModels[b.messageKey])||(d={id:b.messageKey,message:h.validationErrors[b.messageKey]||h.validationErrors.defaultMessage,href:b.inputId?"#"+b.inputId:""});"function"===typeof d.message&&(d.message=d.message(c));return d}));return b},serializeData:function(){var a=this.adaptValidationErrors(this.model.get("validationErrors")),b=a&&a[0],c=this.adaptAvailabilityErrors(this.model.get("availabilityErrors"));return{formErrorsTitle:h.validationErrors.formErrorsTitle,validationErrors:b?a:void 0,availabilityErrors:c&&c[0]&&!b?c:void 0}},onRender:function(){var a=this.$el.find(".js-error");a.length&&a.eq(0).attr("tabindex","0").focus()}},{errorMessages:a})});define("infositeNotifier","jquery infositeData notifier velocity urgencyConfig urgency i18n experiments dctk urlModel uitk infosite reviewsModel templates".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q,r){var s=k.getSingleton();c.config({insert:function(a){a.insertAfter("#hotel-name")}});var t={getUrgencyMessages:function(){var a=[],b=g.urgency[{1:"recentBookingMS",2:"recentBookingMP",3:"recentBookingHS",4:"recentBookingHP",5:"recentBookingDS",6:"recentBookingDP"}[d.messageType]];b&&a.push(b(d));return a},adaptVelocityModel:function(a){return{isValidViewCount:a.isValidViewCount&&1<a.ViewCount,viewCount:a.ViewCount,isValidBookingCount:a.isValidBookingCount&&1<a.BookingCount,bookingCount:a.BookingCount,bookingDuration:b.bookingDuration}},getVelocityMessages:function(){var a=e.Deferred(),c=[];e.ajax({url:b.ajaxUrl,dataType:"json",success:function(a){var b=g.templates;a=t.adaptVelocityModel(a.HotelProductActivityList[0]);a.isValidViewCount&&c.push(b.velocityMsgOthersViewing(a));a.isValidBookingCount&&3!==f["9083"]&&c.push(b.velocityMsgOthersBooked(a))},timeout:8E3,error:function(){a.reject()},complete:function(){a.resolve(c)}});return a},priceTrendLogAndTrackImpression:function(b,c){a.onReady(function(){a.logExperiment({id:9083,value:f["9083"],pageName:a.omtr?a.omtr.pageName:"page.Hotels.Infosite.Information",tpid:Number(h.tpid),eapid:Number(h.eapid),guid:a.logging.guid,callback:function(d){void 0===d.error&&setTimeout(function(){a.trackImpression(("HIGHEST"===b?"HOT.HIS.PriceTrends.UP.":"HOT.HIS.PriceTrends.DOWN.")+c,{})},3E3)}})})},getPriceTrendMessages:function(){var a=e.Deferred(),b=[],c=g.urgency,d,k,y={clientId:"hotelinfosite",ids:h.hotelId,checkinDate:s.getCheckIn(),checkoutDate:s.getCheckOut()};p.subscribe("hotelPriceTrend:arrive",function(e,g){if(g.status===l.statuscodes.SUCCESS_RESPONSE)switch(d=g.response.hotelTicker[0].datedPriceTrend.days||-1,k=g.response.hotelTicker[0].datedPriceTrend.trend||"",f["9083"]){case 1:case 3:"HIGHEST"===k&&1<d?(b.push({msg:c.pricesRisingDP({trendType:k,trendDays:d}),dir:"up"}),t.priceTrendLogAndTrackImpression(k,d)):"LOWEST"===k&&1<d&&(b.push({msg:c.pricesLowestDP({trendType:k,trendDays:d}),dir:"down"}),t.priceTrendLogAndTrackImpression(k,d));a.resolve(b);break;case 2:"HIGHEST"===k&&1<d?(b.push({msg:c.pricesHighestDP({trendType:k,trendDays:d}),dir:"up"}),t.priceTrendLogAndTrackImpression(k,d)):"LOWEST"===k&&1<d&&(b.push({msg:c.pricesLowestDP({trendType:k,trendDays:d}),dir:"down"}),t.priceTrendLogAndTrackImpression(k,d)),a.resolve(b)}else a.resolve()});l.getHotelPriceTrend(y);return a},getReviewTrendMessages:function(){var a=[],b=g.reviewMessages;a[0]=r["review-trend-message"]({trendingUp:1===q.guestReviewScoreTrend,guestRatingDown:b.guestRatingDown,guestRatingUp:b.guestRatingUp,guestReviewsLinkHb:b.guestReviewsLinkHb({seoReviewCount:Number(h.reviewCount).toLocaleString(h.jsLocale).replace(/(\.|,)00$/,""),brandName:h.brandName})});return a},notify:function(){var b=f["9083"],d=f["9122"],g=f["11380"],k=t.getUrgencyMessages(),h=2<g?t.getReviewTrendMessages():[],l=(new Date).getTime(),p=f["11222"],b=1!==d||1!==b&&2!==b&&3!==b?[t.getVelocityMessages()]:[t.getVelocityMessages(),t.getPriceTrendMessages()];e.when.apply(e,b).then(function(b,d){1===p&&(b&&b.length||d&&d.length||k&&k.length)?n.evaluateExperimentAndLog(11215,function(f){0===f&&(c.notify(d,k,b),a.loggingAdapter.logTrxEvent("UrgencyFlyins_PerfMarker",["clEventName01\x3dUrgencyFlyins_PerfMarker","clEventTime01\x3d"+((new Date).getTime()-l)]))}):c.notify(d,k,b,h)}).fail(function(){c.notify(h)})}};return t});require(["infositeNotifier","offersResponseModel","experiments"],function(e,h,c){if(1===c[8100])h.getSingleton().on("change",e.notify);else e.notify()});
define("reviews","reviewsConfig underscore jquery logger infosite handlebars uitk experiments offersResponseModel infositeData urlModel".split(" "),function(e,h,c,b,d,l,g,f,a,k,p){function n(){c("html, body").stop().animate({scrollTop:c(".tabs").offset().top+5},500,"swing")}var q,r,s=p.getSingleton(),t=a.getSingleton();c.extend(e.ta,{loadRating:function(a,b,d){0<a.length?c.ajax({url:b+"?key\x3d"+d+"\x26lang\x3d"+e.ta.locale+"\x26locationId\x3d"+a,dataType:"jsonp",timeout:8E3,success:function(a){e.ta.hasReviews=0<a.numReviews;e.ta.hasReviews?(e.ta.tripAdvisorData={rating:a.score.toString().replace(/\D/,""),actualRating:a.score.toString(),numReviews:a.numReviews,isSingleReview:1===a.numReviews,isLinkToReviews:e.urs.totalCount<e.urs.perPage,tripAdvisorTrackingImageUrl:e.tripAdvisorTrackingImageUrl},a=l.templates["trip-advisor-rating-template"](e.ta.tripAdvisorData),c(".reviews-summary-box").removeClass("hidden"),c(".hotel-photos").removeClass("hidden"),c("#trip-advisor-summary").removeClass("hidden").html(a),g.publish("infosite.tripAdvisorRendered",e.ta.tripAdvisorData)):0===e.urs.totalCount&&c(".tabs").hide()}}):0===e.urs.totalCount&&c(".tabs").hide()},loadReviews:function(a,b){c.ajax({url:"//api.tripadvisor.com/api/partner/1.0/location/"+a+"/reviews?key\x3d"+e.tripAdvisorKey+"\x26lang\x3d"+e.ta.locale+"\x26jsoncallback\x3dcallbackLoadReviewSummary",dataType:"jsonp",timeout:8E3,jsonp:!1,jsonpCallback:"callbackLoadReviewSummary",success:function(d){d={reviews:d.data.slice(0,Math.min(d.data.length,e.urs.perPage))};d=l.templates["trip-advisor-reviews-template"](d);c("#ta-reviews").removeClass("hidden").html(d);c("#reviews-tab-min-height-provider").hide();e.ta.loadReviewSummary(a,b);e.urs.hideLoader()},error:function(){var a=c(".tabs");a.length&&c("html, body").animate({scrollTop:a.offset().top+5},100,"linear");0===e.urs.totalCount&&a.hide();e.urs.hideLoader()}})},loadReviewSummary:function(a,b){0<a.length&&c.ajax({url:"//api.tripadvisor.com/api/partner/1.0/location/"+a+"?key\x3d"+e.tripAdvisorKey+"\x26lang\x3d"+e.ta.locale+"\x26jsoncallback\x3dcallbackLoadReviewSummary",dataType:"jsonp",timeout:8E3,jsonp:!1,jsonpCallback:"callbackLoadReviewSummary",success:function(a){e.ta.tripAdvisorReviewSummaryData={numReviews:parseInt(a.num_reviews,10),useShortHeader:0!==b,rating:a.rating&&a.rating.toString().replace(/\D/,"").replace(/0/,""),cleanliness:a.subratings&&parseFloat(a.subratings.Cleanliness).toFixed(1),service:a.subratings&&parseFloat(a.subratings.Service).toFixed(1),rooms:a.subratings&&parseFloat(a.subratings.Rooms).toFixed(1),value:a.subratings&&parseFloat(a.subratings.Value).toFixed(1),showCleanliness:a.subratings&&!isNaN(parseFloat(a.subratings.Cleanliness)),showService:a.subratings&&!isNaN(parseFloat(a.subratings.Service)),showRooms:a.subratings&&!isNaN(parseFloat(a.subratings.Rooms)),showValue:a.subratings&&!isNaN(parseFloat(a.subratings.Value)),tripAdvisorUrl:a.web_url,reviewRatingCount:a.reviewRatingCount,percentRecommend:(e.ta.parsePercentage(a.reviewRatingCount[5],a.num_reviews)+e.ta.parsePercentage(a.reviewRatingCount[4],a.num_reviews)).toFixed(0),percentagesAtTiers:[]};e.ta.tripAdvisorReviewSummaryData.reviewRatingCount.length=6;e.ta.tripAdvisorReviewSummaryData.reviewRatingCount=Array.prototype.slice.call(e.ta.tripAdvisorReviewSummaryData.reviewRatingCount).slice(1,6).reverse();for(a=0;a<e.ta.tripAdvisorReviewSummaryData.reviewRatingCount.length;a++)e.ta.tripAdvisorReviewSummaryData.percentagesAtTiers[a]=e.ta.parsePercentage(e.ta.tripAdvisorReviewSummaryData.reviewRatingCount[a],e.ta.tripAdvisorReviewSummaryData.numReviews);0<e.ta.tripAdvisorReviewSummaryData.numReviews&&(a=l.templates["trip-advisor-review-summary-template"](e.ta.tripAdvisorReviewSummaryData),c("#ta-review-summary").html(a));a=l.templates["trip-advisor-reviews-pagination-template"](e.ta.tripAdvisorReviewSummaryData);c(".nav-footer").html(a);c("#reviews-content .nav-footer").show();g.publish("infosite.tripAdvisorReviewDetailsPage")}})},parsePercentage:function(a,b){return 100*parseInt(a,10)/parseInt(b,10)}});c.extend(e.urs,{loadedOnce:!1,isExp10745Logged:!1,isExp10457Logged:!1,setReviewSummaryHtml:function(a){var b=parseFloat(a.recommendedPercent),d=this.locale.replace("_","-"),b={totalReviewCount:a.totalReviewCnt,avgOverallRating:parseFloat(a.avgOverallRating).toFixed(1),formattedAvgOverallRating:Number(parseFloat(a.avgOverallRating).toFixed(1)).toLocaleString(d),avgOverallRatingBarWidth:20*parseFloat(a.avgOverallRating)+"%",showRecommendedPercent:5<=parseInt(a.totalReviewCnt,10)&&0<b,recommendedPercent:Math.round(b)+"%",cleanliness:parseFloat(a.cleanliness).toFixed(1),formattedCleanliness:Number(parseFloat(a.cleanliness).toFixed(1)).toLocaleString(d),serviceAndStaff:parseFloat(a.serviceAndStaff).toFixed(1),formattedServiceAndStaff:Number(parseFloat(a.serviceAndStaff).toFixed(1)).toLocaleString(d),roomComfort:parseFloat(a.roomComfort).toFixed(1),formattedRoomComfort:Number(parseFloat(a.roomComfort).toFixed(1)).toLocaleString(d),hotelCondition:parseFloat(a.hotelCondition).toFixed(1),formattedHotelCondition:Number(parseFloat(a.hotelCondition).toFixed(1)).toLocaleString(d),hotelName:e.hotelName};0!==f[10398]&&(b.selectedRoom="-1"===c("#reviews-room-selector :selected").val()?"":c("#reviews-room-selector :selected").text());b.showCleanliness=0<b.cleanliness;b.showServiceAndStaff=0<b.serviceAndStaff;b.showRoomComfort=0<b.roomComfort;b.showHotelCondition=0<b.hotelCondition;d="";e.exp11124BundleEnabled?(d=function(a){return Number(.5*Math.ceil(2*parseFloat(a).toFixed(1))).toFixed(1)},b.cleanlinessRounded=d(a.cleanliness),b.cleanlinessClass="icon-stars"+String(d(a.cleanliness)).replace(".","-"),b.serviceAndStaffRounded=d(a.serviceAndStaff),b.serviceAndStaffClass="icon-stars"+String(d(a.serviceAndStaff)).replace(".","-"),b.roomComfortRounded=d(a.roomComfort),b.roomComfortClass="icon-stars"+String(d(a.roomComfort)).replace(".","-"),b.hotelConditionRounded=d(a.hotelCondition),b.hotelConditionClass="icon-stars"+String(d(a.hotelCondition)).replace(".","-"),b.avgOverallRatingClass="icon-stars"+String(d(a.avgOverallRating)).replace(".","-"),d=l.templates["review-summary-template-bundle"](b)):d=l.templates["review-summary-template"](b);c("#review-summary").html(d);e.exp11319&&e.urs.displayBrandSpecificReviewSummary(b)},setSortAndFilterControlHtml:function(a){a=e.urs.adaptSortAndFilterControlModel(a);a=l.templates["reviews-sort-and-filter-template"](a);c("#review-sort-and-filter-control").html(a)},adaptSortAndFilterControlModel:function(a){var b={},c=[];c.push({categoryCode:"",count:a.totalReviewCnt,localizedCategory:this.localizedCategories.Everyone});for(var d in a.categoryCounts)if(a.categoryCounts.hasOwnProperty(d)){var e,g;"Everyone"!==d&&(e=a.categoryCounts[d],g=d,c.push({categoryCode:g,count:e,localizedCategory:this.localizedCategories[d]}))}c.sort(function(a,b){return b.count-a.count});for(e=0;e<c.length;e++)if("Other"===c[e].categoryCode){c=c.concat(c.splice(e,1));break}b.categoryCounts=c;c=[];c.push({languageCode:"",count:a.totalReviewCnt,localizedLanguage:this.localizedLanguages.all});for(d in a.languageCounts)this.localizedLanguages.hasOwnProperty(d)&&c.push({languageCode:d,count:a.languageCounts[d],localizedLanguage:this.localizedLanguages[d]});b.languageCounts=c;b.languageFirstSortOption=this.localizedLanguageFirstLabels[this.langCode];if(0!==f[10398]){a=[];if(0<q.length){a.push({roomTypeCode:"-1",roomTypeName:"All Accommodation Types"});for(var k in q)q.hasOwnProperty(k)&&a.push({roomTypeCode:q[k].roomTypeCode,roomTypeName:q[k].roomTypeName})}b.roomDetails=a}return b},adaptReviewDetails:function(a){var b,c,d,k,h,l={};if(0<f[10398])for(b in q)q.hasOwnProperty(b)&&(l[q[b].roomTypeCode]=q[b].roomTypeName);for(b=0;b<a.length;b++){d=a[b];k=d.reviewId;for(c=0;c<d.managementResponses.length;c++)h=d.managementResponses[c],h.reviewId=k;d.ratingOnlyReview=this.isRatingOnlyReview(d);d.isCurrentBrand=d.brandType===e.brandName;"1"===g.readCookie(k)&&(d.thanked=!0);d.recommended="YES"===d.isRecommended;
0<f[10398]&&l[d.roomTypeId]&&(d.roomTypeName=l[d.roomTypeId])}return{reviews:a}},setReviewsHtml:function(a){r=this.adaptReviewDetails(a);a=e.exp11124BundleEnabled?l.templates["reviews-template-bundle"](r):l.templates["reviews-template"](r);c("#review-list").html(a)},isRatingOnlyReview:function(a){return!(a.title||a.positiveRemarks||a.negativeRemarks||a.locationRemarks||a.reviewText||0<a.photos.length||0<a.managementResponses)},initPagination:function(a){var b=this;a=l.templates["reviews-pagination-template"]({numberOfReviews:a,reviewsPerPage:b.reviewsPerPage});c(".nav-footer").first().html(a);c("#reviews-pagination").uitk_pagination();b.paginationToken&&g.unsubscribe("pagination.pageChanged",b.paginationToken);b.paginationToken=g.subscribe("pagination.pageChanged",function(a,d){b.loadReviews(d.pageNumber);c("html, body").animate({scrollTop:c("#review-summary").offset().top+5},50,"linear")})},showLoader:function(){c("#review-summary").css("opacity","0.3");c("#review-sort-and-filter-control").css("opacity","0.3");c("#review-list").css("opacity","0.3");c("#reviews-loader").show()},hideLoader:function(){c("#reviews-loader").hide();c("#review-summary").css("opacity","1");c("#review-sort-and-filter-control").css("opacity","1");c("#review-list").css("opacity","1")},logRequest:function(a,c){c=c.concat(["hotelId\x3d"+k.hotelId,"sortBy\x3d"+this.currentSort,"categoryFilter\x3d"+this.currentCategoryFilter,"languageFilter\x3d"+this.currentLanguageFilter]);"perf"===a?b.logTrxEvent("InteractiveReviews",c):"error"===a&&b.logMessage("InteractiveReviews",c)},loadReviews:function(a){d.evaluateExperimentAndLog(8886);var b=this;b.pageToLoad=a||1;var h=1===b.pageToLoad;b.showLoader();a=b.url.replace("HOTELID",k.hotelId).replace("LOCALE",b.locale).replace("START_INDEX",(b.pageToLoad-1)*b.perPage).replace("PER_PAGE",b.perPage).replace("SORT",b.currentSort).replace("CAT",b.currentCategoryFilter).replace("LNG",b.currentLanguageFilter);0!==f[10398]&&(a=b.url.replace("HOTELID",k.hotelId).replace("LOCALE",b.locale).replace("START_INDEX",(b.pageToLoad-1)*b.perPage).replace("PER_PAGE",b.perPage).replace("SORT",b.currentSort).replace("CAT",b.currentCategoryFilter).replace("LNG",b.currentLanguageFilter).replace("-1",b.roomTypeIdFilter));if(e.exp11319&&s.isDateless()&&"Hotwire"===k.brandName)e.ta.loadReviews(k.hotelId,0);else{var l=(new Date).getTime();c.ajax({url:a,dataType:"jsonp",jsonp:"jsonpCallback",timeout:b.timeout,success:function(a,d,f){try{var p=a.reviewDetails.reviewSummaryCollection.reviewSummary,n=a.reviewDetails.reviewCollection.review,v=!0;e.exp11319&&(e.urs.totalCount=p[0].totalReviewCnt);if(0<p.length&&0<p[0].totalReviewCnt){var q=p[0];q.currentLanguageFilter=b.currentLanguageFilter;b.setReviewSummaryHtml(q);b.loadedOnce||(b.setSortAndFilterControlHtml(q),b.loadedOnce=!0);h&&b.initPagination(q.totalReviewCnt);e.exp11124BundleEnabled&&10>q.totalReviewCnt&&(v=!1);0<n.length&&v&&(b.setReviewsHtml(n),c("#reviews-service-relax-filters-msg").hide(),c("#reviews-tab-min-height-provider").hide(),c("#review-list").show(),c("#reviews-content .nav-footer").show());b.logExp10745();c("#reviews-service-failure-msg").hide();c("#reviews-content").show();b.hideLoader();b.logRequest("perf",["responseTime\x3d"+((new Date).getTime()-l),"page\x3d"+b.pageToLoad,"success\x3dtrue"]);g.publish("infosite.reviewDetailsRendered",a.reviewDetails);e.exp11124BundleEnabled&&e.urs.displaySummaryReview(a.reviewDetails)}else c("#review-list").hide(),c("#reviews-content .nav-footer").hide(),c("#reviews-service-relax-filters-msg").show(),b.hideLoader(),b.logRequest("error",["success\x3dfalse","error\x3dfiltersTooRestrictive"]);e.urs.totalCount<e.urs.perPage&&e.ta.loadReviews(k.hotelId,e.urs.totalCount)}catch(r){this.error(f,d,r.message)}},error:function(){e.urs.showUGCSummary();e.ta.loadReviews(k.hotelId,0)}})}},scrollToReviews:function(a){a.preventDefault();c("#tab-reviews").trigger(g.clickEvent);n()},flagInappropriate:function(){var a=e.urs,b=c(this),d=b.data("review-id");c.ajax({url:a.apiURL+"/hotelreview/flagInappropriate/"+d+"?_type\x3djson",type:"POST",dataType:"json",timeout:8E3,success:function(){b.replaceWith(l.templates["thanks-for-feedback"]())}});require("dctk/dctk",function(a){a.trackAction("HOT.HIS.Reviews.Inappropriate.Review")})},flagManagementResponse:function(){var a=e.urs,b=c(this),d=b.data("review-id");c.ajax({url:a.apiURL+"/hotelreview/flagManagementResponse/"+d+"?_type\x3djson",type:"POST",dataType:"json",timeout:8E3,success:function(){b.replaceWith(l.templates["thanks-for-feedback"]())}});require("dctk/dctk",function(a){a.trackAction("HOT.HIS.Reviews.Inappropriate.ManagementResponse")})},logExp10745:function(){var a=this;(c(".review-assurance-small").is(":visible")||c(".review-assurance").is(":visible"))&&!a.isExp10745Logged&&a.isVerifiedReviews&&d.evaluateExperimentAndLog(10745,function(b){"number"===typeof b&&1===b&&(c("#reviews-disclaimer").removeClass("hidden"),c("#reviews-disclaimer-small").removeClass("hidden"),g.subscribe("tooltip.beforeOpen",function(b,f){if("reviews-disclaimer"===f.attr("id")||"reviews-disclaimer-small"===f.attr("id"))a.isExp10457Logged?f.uitk_tooltip("show"):d.evaluateExperimentAndLog(10457,function(b){"number"===typeof b&&2===b&&(b=f.data("confidencetext"),c("#learn-verified-reviews").find("p").html(b),b=c("#learn-verified-reviews").html(),c("#reviews-disclaimer").uitk_tooltip("updateContent",b),c("#reviews-disclaimer-small").uitk_tooltip("updateContent",b));f.uitk_tooltip("show");a.isExp10457Logged=!0})}),a.isExp10745Logged=!0)})},displaySummaryReview:function(a){if(a&&a.reviewCollection&&a.reviewCollection.review){a=a.reviewCollection.review;var b=c("#review-summary-sample").html(),d=l.compile(b),f=!1;c.each(a,function(a,b){b.isRecommended&&!f&&(c("#review-sample").html(d({reviewText:b.reviewText.substring(0,150),reviewName:b.userDisplayName,reviewLocation:b.userLocation,reviewDate:(new Date(b.reviewSubmissionTime)).toDateString()})),f=!0)})}},showUGCSummary:function(){var a=c(".reviews-summary");a.find(".rating-superlative").show();a.find(".aggregateRating").show()},displayBrandSpecificReviewSummary:function(a){if(a.totalReviewCount){var b={container:c(".reviews-summary"),populateData:function(b){b.find(".rating-number").text(a.formattedAvgOverallRating);b.find(".recommend-percentage").text(a.recommendedPercent);b.find(".link-to-reviews").find("span[itemprop\x3d'reviewCount']").text(a.totalReviewCount)},hideRecommendation:function(a){a.find(".guest-recommendation").hide()}};a.showRecommendedPercent||b.hideRecommendation(b.container);b.populateData(b.container);this.showUGCSummary()}},init:function(){function a(b){b.parent().find("button").attr("disabled","true")}var b=this;0!==f[10398]&&(b.roomTypeIdFilter=-1,t.on("change",function(a){q=[];a=a.get("rooms");for(var b=0;b<a.length;b++){var c=a[b];q.push({roomTypeCode:c.roomTypeCode,roomTypeName:c.name})}}));s.isDateless()?this.loadReviews(1):this.showUGCSummary();c("body").on(g.clickEvent,".link-to-reviews",e.urs.scrollToReviews);if(k.isInformationOnlyEnabled)c("body").on(g.clickEvent,".link-to-ta-reviews",function(){window.open(e.ta.tripAdvisorReviewSummaryData.tripAdvisorUrl,"_blank")});c("body").on(g.clickEvent,".trip-advisor-link",function(a){a.preventDefault();c("#tab-reviews").trigger(g.clickEvent);n()});c("body").on(g.clickEvent,"#tab-reviews",function(a){a.preventDefault();b.loadedOnce||(0!==f[10398]&&(b.roomTypeIdFilter=-1),b.loadReviews());b.logExp10745()});-1<window.location.hash.indexOf("#section-reviews")&&(c("#tab-reviews").trigger(g.clickEvent),n());c("body").on(g.clickEvent,".thank-reviewer-button",function(){var d,f;f=c(this).data("review-id");"1"===g.readCookie(f)?a(c(this)):(document.cookie=f+"\x3d1",d=c(this).data("review-index"),r.reviews[d].totalThanks++,d=l.templates["thank-reviewer-button-copy"](r.reviews[d]),c(this).find(".btn-label").html(d),a(c(this)),c.ajax({url:b.baseURL+"/hotelreview/thank/"+f,type:"POST",dataType:"json",timeout:8E3}))}).on(g.clickEvent,".flag-inappropriate a",
b.flagInappropriate).on(g.clickEvent,".flag-management-response a",b.flagManagementResponse);c("body").on(g.clickEvent,".no-thanks",function(){a(c(this))});c("#try-again").on(g.clickEvent,function(){b.loadReviews(b.pageToLoad)});c(".nav-footer").on(g.clickEvent,".back-to-hotel-details",function(a){a.preventDefault();c("html, body").stop().animate({scrollTop:0},500,"swing");c("#tab-details").trigger(g.clickEvent)});e.alertScreenReader=function(){c("#aria-live-region-infosite").text(c("#review-sort-and-filter-control").data("screen-reader-alert-msg"))};if(0!==f[10398])c("#review-sort-and-filter-control").on("change","#reviews-room-selector",function(){b.roomTypeIdFilter=c("#reviews-room-selector :selected").val();d.track("HOT.HIS.Reviews.AccommodationFilter",this);b.loadReviews();e.alertScreenReader()});c("#review-sort-and-filter-control").on("change","#reviews-category-selector",function(){b.currentCategoryFilter=c("#reviews-category-selector :selected").val();d.track("Reviews.CategoryFilter."+(b.currentCategoryFilter||"All"),this);b.loadReviews();e.alertScreenReader()});c("#review-sort-and-filter-control").on("change","#reviews-language-selector",function(){b.currentLanguageFilter=c("#reviews-language-selector :selected").val();b.currentLanguageFilter&&b.currentLanguageFilter!==b.langCode&&"DATEDESCWITHLANGBUCKETS"===b.currentSort&&(b.currentSort="DATEDESC",c("#reviews-sort-selector").prop("selectedIndex",1));d.track("Reviews.LanguageFilter."+(b.currentLanguageFilter||"All"),this);b.loadReviews();e.alertScreenReader()});c("#review-sort-and-filter-control").on("change","#reviews-sort-selector",function(){b.currentSort=c("#reviews-sort-selector :selected").val();"DATEDESCWITHLANGBUCKETS"===b.currentSort&&b.currentLanguageFilter&&b.currentLanguageFilter!==b.langCode&&(b.currentLanguageFilter="",c("#reviews-language-selector").prop("selectedIndex",0));d.track("Reviews.SortBy."+b.currentSort,this);b.loadReviews();e.alertScreenReader()})}});e.run=function(){e.runExperiments();k.isInformationOnlyEnabled&&e.registerInformationOnly();e.ta.loadRating(k.hotelId,e.tripAdvisorUrl,e.tripAdvisorRatingsKey);e.urs.init()};return e});define("playbackView",["marionette","offersResponseModel","urlModel","hotelInfo"],function(e,h,c,b){var d=c.getSingleton();h=h.getSingleton();return e.ItemView.extend({tagName:"span",className:"search-summary",template:"playback-module-template",model:h,modelEvents:{change:"render"},serializeData:function(){var c=d.get("adults").length;return{checkInDay:this.model.get("formattedFromStayDate"),checkOutDay:this.model.get("formattedToStayDate"),cityName:b.city,numberOfRooms:c,singleRoom:1===c}}})});define("backToSearchView",["jquery","marionette","urlModel","hotelInfo","experiments"],function(e,h,c,b,d){return h.ItemView.extend({ui:{link:"a#back-to-search"},modelEvents:{change:"updateLink"},template:"back-to-search-template",model:c.getSingleton(),updateLink:function(){this.ui.link.attr("href",this.serializeData().backToSearchUrl)},childrenToHsrFormat:function(b){var c=b.get("children")?b.get("children"):[];b=b.get("childAge")?b.get("childAge"):[];var d=[],a,e,h,n=0;for(a=0;a<c.length;a++)for(h=c[a],e=0;e<h;e++)d.push(a+1+"_"+b[n++]);if(d.length)return d.join(",")},serializeData:function(){var c=this.model.getCheckIn(),g=this.model.getCheckOut(),f=this.model.get("adults"),a=b.backToSearchParams;a.adults=f.join(",");a.children=this.childrenToHsrFormat(this.model);c&&g&&(a.startDate=c,a.endDate=g);1===d["11316"]&&(a.selected=b.id);return{backToSearchUrl:"/Hotel-Search#"+e.param(a,!0),isDeeplink:b.isDeeplink}}})});define("leadpriceView","jquery marionette offersResponseModel urlModel hotelInfo infositeData uitk ajaxTaapModel".split(" "),function(e,h,c,b,d,l,g,f){var a=b.getSingleton();c=c.getSingleton();return h.ItemView.extend({tagName:"div",className:"ajax-lead-price",template:"lead-price-template",model:c.leadOffer,modelEvents:{change:"render"},formatPrice:function(a){return g.utils.createLocalizedPrice(String(a),d.locale,d.currencyCode).roundHalfDown().format()},serializeData:function(){var b=this.model.toJSON(),c=a.isDateless();if(b&&!e.isEmptyObject(b)){var b=b.bestOffer,g=b.price;if(g&&!e.isEmptyObject(g)){var h=b.loyaltyBurnedPrice?b.loyaltyBurnedPrice.amount:g.price;return{showSoldOut:!1,isDateless:c,crossOutPrice:g.crossOutPrice?g.crossOutPrice:void 0,loyaltyCrossOutPrice:b.loyaltyCrossOutPrice&&b.loyaltyCrossOutPrice.amount?this.formatPrice(b.loyaltyCrossOutPrice.amount):void 0,minPrice:this.formatPrice(h),available:g.available,resortFee:b.resortFee,leadPriceResortFeeEnabled:d.leadPriceResortFeeEnabled&&b.isResortFeeEnabled,hasLoyaltyBurn:b.loyaltyBurnedPrice?!0:!1,isModHisMeatStickerEnabled:b.modHisMeatStickerEnabled,mandatoryFees:b.mandatoryFees,includedFees:b.includedFees,excludedFees:b.excludedFees,offerIndex:0,optionIndex:0,displayTaapContent:f.displayTaapContent,displayCityTax:l.isCityTaxExclusionEnabled&&null!==b.taxesAndFeesNotIncludedInPrice,numberOfNights:b.numberOfNights,taxesAndFeesNotIncludedInPrice:b.taxesAndFeesNotIncludedInPrice,totalWithCityTax:b.totalWithCityTax}}}return{showSoldOut:!1,isDateless:c}}})});
define("recommendationsCollection",["jquery","recommendationsConfig","backbone","uitk","urlModel"],function(e,h,c,b,d){var l=d.getSingleton();return c.Collection.extend({ensureSponsoredPosition:function(b,c){if(!(2>c.length||1===b)){var a=c[b];c[b]=c[1];c[1]=a}},adaptModel:function(b,c){var a=b.urlToHotelInfosite,d=b.travelAdImpressionTrackingUrl,e;e=/\[position\]/;b.isSponsored&&(a=b.travelAdClickRedirectInfositeUrl,d=d.replace(e,c),a=a.replace(e,c));e=h.showTotalPrice?decodeURIComponent(b.totalPriceNoDecimal):"undefined"!==typeof b.averagePriceNoDecimal?decodeURIComponent(b.averagePriceNoDecimal):decodeURIComponent(b.averagePrice);var l=function(a,b){var c=0;b&&(c=parseInt(b,10),isNaN(c)||0>c)&&(c=0);c=Math.pow(10,c);return Math.round(a*c)/c},a={hotelName:decodeURIComponent(b.hotelName),urlToHotelInfosite:a,starRating:b.starRating.replace(".","-"),hasThumbnail:"undefined"!==typeof b.urlToThumbnail&&0<b.urlToThumbnail.length,urlToThumbnail:b.urlToThumbnail,price:e,sponsored:b.isSponsored,travelAdsExposureUrl:d,crossOutPrice:decodeURIComponent(b.crossOutPrice),showCrossOutPrice:b.crossOutPriceValue>b.averagePriceValue&&!b.isSponsored,reviewRating:l(parseFloat(b.reviewRating),1),reviewRecommendationPercentage:l(parseFloat(b.reviewRecommendationPercentage),0),superlative:b.superlatives&&b.superlatives.reviewRatingCategory?b.superlatives.reviewRatingCategory:""},d=decodeURIComponent(b.localizedHotelName);h.showDualHotelName&&d!==a.hotelName&&(a.localizedHotelName=d);return a},processData:function(b){var c,a,d={hotels:[]};for(c=0;c<b.length;c++)if(b[c].isSponsored){this.ensureSponsoredPosition(c,b);break}for(c=0;c<Math.min(4,b.length);c++)a=this.adaptModel(b[c],c+1),d.hotels.push(a);return d},handleResponse:function(c){var d;0!==c.errorCode?b.publish("infosite.recommendations.recommendationsError"):c&&c.recommendations&&0!==c.recommendations.length?(d=c.recommendations[0].items.hotels,0===c.errorCode&&"undefined"!==typeof d&&0<d.length&&(d=this.processData(d),this.reset(d.hotels))):b.publish("infosite.recommendations.emptyRecommendationsError")},getRecommendations:function(c){return e.ajax({url:c,dataType:"json",success:e.proxy(this.handleResponse,this),error:function(){b.publish("infosite.recommendations.recommendationsError")}})},handleInactiveResponse:function(b){b&&b.hotelModels&&0!==b.hotelModels.length&&(b=b.hotelModels,"undefined"!==typeof b&&0<b.length&&(b=this.processData(b),this.reset(b)))},getInactiveRecommendations:function(){var b=this;e.ajax({url:"Hotel-Recommender-Ajax?scenario\x3dInfosite\x26rule\x3dpersona-region-item-xsell\x26itemType\x3d2\x26maxCount\x3d20\x26reqRetItemType\x3d0\x26itemId\x3d"+h.regionId+"\x26travellersInfo\x3d1\x26startDate\x3d\x26endDate\x3d\x26personaId\x3d0\x26code\x3d1",dataType:"json",success:function(c){b.handleInactiveResponse(c)}})},fetchRecommender:function(){var b=l.toJSON(),c=h.recommendationAjaxUrl;if(b&&b.chkin[0]&&b.chkout[0]){c+="\x26sDate\x3d"+b.chkin[0]+"\x26eDate\x3d"+b.chkout[0];if(b.adults)for(var c=c+"\x26travellersInfo\x3d",a=b.adults,d=0,e=0;e<a.length;e++)if(0<e&&(c+=","),c+=a[e]+";",b.children&&b.childAge){var n=b.childAge,q=b.children.map(Number)[e];if(0<q){for(var r=d;r<q+d;r++)c+=n[r],r<q+d-1&&(c+=":");d+=q}}return this.getRecommendations(c)}}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("recommendationsView","marionette recommendationsCollection uitk recommendationsConfig offersResponseModel infositeData experiments underscore".split(" "),function(e,h,c,b,d,l,g,f){var a=e.ItemView.extend({template:"recommendations-template-ajaxrr",tagName:"article",className:"col tile tile-no-header tile-no-footer"}),k=h.getSingleton(),p=d.getSingleton(),n=!1;return e.CompositeView.extend({initialize:function(){b.autoFetchCollection&&(k.fetchRecommender(),k.listenTo(p,"change",k.fetchRecommender))},collection:k,template:"recommendations",templateHelpers:function(){0<g[11357]&&this.checkIsTrivago()&&(n=!0);return{isMutedHotel:l.isMutedHotel,collectionLength:this.collection.length,isTrivago:n}},collectionEvents:{reset:"render"},childView:a,childViewContainer:".recommendations-grid.tile-grid",onRenderCollection:function(){c.publish("infosite.ajaxRecommendation.renderCollection",{collection:this.collection,el:this.el})},onDomRefresh:function(){c.publish("infosite.ajaxRecommendation.domRefresh",{collection:this.collection,el:this.el})},checkIsTrivago:function(){var a=this.getParams();return void 0!==a.mdpcid&&0<=a.mdpcid.indexOf("TRIVAGO")},getParams:function(){var a=location.search.split("?")[1];return f.isUndefined(a)?{}:f.chain(a.split("\x26")).map(function(a){if(a)return a.split("\x3d")}).compact().object().value()}})});define("behaviors",["behaviors/twoWayBindData","behaviors/modal","behaviors/countdown"],function(e,h,c){return{TwoWayBindData:e,Modal:h,Countdown:c}});define("behaviors/twoWayBindData",["underscore","jquery","marionette"],function(e,h,c){return c.Behavior.extend({defaults:[],initialize:function(){var b=this.options.attributes,c,h;this.events={};this.modelEvents={};for(h=0;h<b.length;h++)c=b[h],this.modelEvents["change:"+c]=e.partial(this.updateUI,e,e,c),this.events["change @ui."+c]=e.partial(this.updateModel,e,c)},updateUI:function(b,c,e){this.view.ui[e].val(c)},updateModel:function(b,c){this.view.model.set(c,h(b.target).val())}})});define("behaviors/modal",["underscore","marionette","uitk"],function(e,h,c){var b={template:!1,open:function(){this.isRendered?this.modal.open():this.render()},close:function(){this.modal.close()}};return h.Behavior.extend({defaults:{},initialize:function(){var d=this.view,h=e.extend({manual:"open",content:this.renderTemplate()},this.options);this.modal=d.modal=c.modal.create(h);this.token=c.subscribe("modal.close",d,d.destroy);e.extend(d,b,{el:this.modal.modalBodyHtml})},onRender:function(){this.modal.open()},onDestroy:function(){c.unsubscribe("modal.close",this.token)},renderTemplate:function(){var b=this.view,c=b.mixinTemplateHelpers(b.serializeData());return h.Renderer.render(b.template,c,b)}})});define("behaviors/countdown",["underscore","marionette"],function(e,h){return h.Behavior.extend({defaults:{},ui:{days:".days-section",hours:".hours-section",minutes:".mins-section",seconds:".secs-section"},onRender:function(){e.each(this.ui,this.bindEl2Update,this)},bindEl2Update:function(c,b){c[0]&&this.listenTo(this.view.model,"change:"+b,e.partial(this.update,e,e,c))},update:function(c,b,d,e){"days"===e?this.view.render():d.html(b)}})});
define("wizardView","handlebars jquery underscore marionette i18n wizardConfig uitk dctk/dctk offersResponseModel hotelInfo infositeData errorView validation swpToggleView urlModel dateRangeModel roomCollection".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q,r,s,t,v){function m(a){return d.getMessage(1===a?"availabilitywizard.oneRoom":"availabilitywizard.moreThanOneRoom",{roomCount:a})}var w=s.getSingleton(),u=a.getSingleton();a=t.getSingleton();v=v.getSingleton();var z=b.CompositeView.extend({template:"traveler-options",childViewContainer:".room-occupants",serializeData:function(){var a=this.collection.length;return{roomOptions:c(l.maxRooms).times(function(b){b+=1;return{roomNumber:b,isSelected:b===a}}),roomLabel:m(a)}},childView:b.ItemView.extend({template:"room",ui:{adultCount:".adult-selector",childCount:".children-selector"},behaviors:{TwoWayBindData:{attributes:["adultCount","childCount"]}},serializeData:function(){var a;try{a=parseInt(this.model.get("adultCount"),10)||2}catch(b){a=2}var d=this.model.toJSON();return{roomIndex:d.roomIndex,roomNumber:d.roomIndex+1,adults:c(l.maxAdults).times(function(b){var c=String(b+1);return{text:c,value:c,isSelected:b===a-1}}),children:c(l.maxChildren+1).times(function(a){return{text:a,value:a,isSelected:d.childCount===String(a)}})}}})});s=b.ItemView.extend({tagName:"label",className:"select icon icon-toggle180",template:"child-age-options",ui:{age:".child-age-selector"},behaviors:{TwoWayBindData:{attributes:["age"]}},serializeData:function(){for(var a=this.model.get("roomIndex")+1,b=this.model.get("age"),c=[{text:"--",value:""}],d=0;d<=l.maxChildAge;){var f=String(d);c.push({text:d?f:"0 - 1",value:f,isSelected:f===String(b)});d++}return{childAges:c,ageIndex:this.getOption("childIndex"),roomNumber:a}}});var y=b.CollectionView.extend({childViewOptions:function(a,b){return{roomIndex:b,collection:a.childAgeCollection}},childView:b.CompositeView.extend({tagName:"fieldset",className:"room-traveler-child-ages",template:"room-traveler-child-ages",modelEvents:{"change:childCount":"toggleChildAges"},toggleChildAges:function(){var a=this.model.get("childCount")||0;0!==parseInt(a,10)?this.$el.show():this.$el.hide()},serializeData:function(){var a=this.getOption("roomIndex");return{roomIndex:a,roomNumber:a+1}},childViewOptions:function(a,b){return{roomIndex:b,childIndex:a.get("childIndex")}},childViewContainer:".child-age-option-collection",onRender:function(){this.toggleChildAges()},childView:s})});return b.LayoutView.extend({initialize:function(){this.listenTo(u.errors,"change",this.respondToErrors);this.toggleHasMultipleRooms()},model:a,collection:v,behaviors:{TwoWayBindData:{attributes:["checkIn","checkOut"]}},template:"availability-wizard",ui:{form:"form",checkIn:"#availability-check-in",checkOut:"#availability-check-out",rooms:".rooms-selector",update:"#update-availability-button",errors:"#allAvailabilityErrors",roomOccupants:".traveler-options",roomChildAges:".room-child-ages",childAges:"#traveler-ages",wizard:"#availability-wizard",playback:"#availability-playback",changeDates:"#show-availability-wizard",cancel:"#hide-availability-wizard",swpToggle:"#swp-toggle",swpToggleTrigger:"#apply-points-checkbox"},regions:{errors:"@ui.errors",roomOccupants:"@ui.roomOccupants",roomChildAges:"@ui.roomChildAges",swpToggle:"@ui.swpToggle"},events:{"change @ui.rooms":"updateRooms","click  @ui.update":"submit","focus @ui.form":"enableUpdateButton","click @ui.changeDates":"expandWizard","click @ui.cancel":"collapseWizard"},collectionEvents:{"change:childCount":"toggleChildAges",add:"toggleHasMultipleRooms",remove:"toggleHasMultipleRooms"},toggleChildAges:function(){this.collection.getTotalChildCount()?this.ui.childAges.show():this.ui.childAges.hide()},toggleHasMultipleRooms:function(){this.$el.toggleClass("has-multiple-rooms",1<this.collection.length)},isCollapseAndExpand:!p.isPackageInfosite&&p.isMobilePhone,collapseWizard:function(){this.isCollapseAndExpand&&(this.ui.playback.html(e.templates["availability-playback"](this.serializeData())),this.ui.wizard.addClass("collapsed-wizard"),h("body").addClass("mobileCollapseWizard"),g.utils.focusElement(this.ui.changeDates))},expandWizard:function(){this.ui.wizard.removeClass("collapsed-wizard")},enableUpdateButton:function(){this.ui.update.removeProp("disabled")},updateRooms:function(a){this.collection.setLength(a.target.selectedIndex+1)},onRender:function(){var a={collection:this.collection};g.prepFields();this.getRegion("errors").show(new n);this.getRegion("roomOccupants").show(new z(a));this.getRegion("roomChildAges").show(new y(a));this.getRegion("swpToggle").show(new r({wizardView:this}))},respondToErrors:function(){var a=u.errors,b=a.hasAvailabilityErrors(),a=a.hasValidationErrors();(b||a)&&this.enableUpdateButton()},writeToUrl:function(){var a=[],b=[],c=[];this.collection.each(function(d){a.push(d.get("adultCount"));b.push(d.get("childCount"));d.childAgeCollection.each(function(a){c.push(a.get("age"))})});w.save({chkin:[this.ui.checkIn.val()],chkout:[this.ui.checkOut.val()],adults:a,children:b,childAge:c,swpToggleOn:this.isSwpToggledOn()})},isSwpToggledOn:function(){var a=this.$el.find("#apply-points-checkbox");if(a.length)return a.is(":checked")},submit:function(a){a&&a.preventDefault&&a.preventDefault();f.trackAction("HOT.HIS.AvailWizard.UpdateShowRates");this.model.set({checkIn:this.ui.checkIn.val(),checkOut:this.ui.checkOut.val()});a=[];this.$el.find("label.invalid").removeClass("invalid");q.validate(this.ui.form,a)?(this.ui.update.prop("disabled","true"),this.writeToUrl(),this.collapseWizard()):u.errors.set({validationErrors:a})},serializeData:function(){var a=this.model,b=a.get("checkIn"),c=g.utils.createLocalizedDate(b,p.locale),a=a.get("checkOut"),f=g.utils.createLocalizedDate(a,p.locale),e=!!this.collection.getTotalChildCount(),h=this.collection.length,l=this.collection.getTotalChildCount(),y=this.collection.getTotalAdultCount(),n=this.isCollapseAndExpand,v=u.errors.hasAvailabilityErrors()||u.errors.hasValidationErrors(),q=c.mediumDate(),c=c.longDate(),r=f.mediumDate(),f=f.longDate(),s=k.maxDate,t=m(h),w=k.dateFormat;var z=1===h?"availabilitywizard.oneRoom":"availabilitywizard.rooms",h=1===h?d.getMessage(z):h+" "+d.getMessage(z),y=y+" "+d.getMessage("availabilitywizard.adults");0<l?(l=l+" "+d.getMessage("availabilitywizard.children"),l=h+", "+y+", "+l):l=h+", "+y;return{isCollapseAndExpand:n,hasErrors:v,isDated:!(!b||!a),checkIn:b,checkInMedium:q,checkInLong:c,checkOut:a,checkOutMedium:r,checkOutLong:f,maxDate:s,hasChildren:e,roomLabel:t,dateFormat:w,showRoomOptionsLinkLabel:l}}},{ChildAgeView:s,RoomChildAgesView:y,RoomOccupantsView:z})});
define("urlModel","jquery backbone uitk utils infositeData experiments underscore uitk_localized_dateApi".split(" "),function(e,h,c,b,d,l,g){var f=1===l[8100];return h.Model.extend({initialize:function(){var a=this;a.reload=!1;a.lastReload=b.now();a.update();e(window).on("hashchange",function(){a.reload?b.reload():(a.update(),a.trigger("sync",a))})},sync:function(){var a=6E4*d.pageTimeoutInMinutes;this.reload=b.now()-this.lastReload>=a;b.setHash(this.serializeToQuery())},update:function(){var a={},b,c,d,f,e,g;b=this.getQueryFromUrl().split("\x26");d=0;for(f=b.length;d<f;d++)try{c=b[d].split("\x3d"),e=decodeURIComponent(c[0]),g=decodeURIComponent(c[1]),a[e]?a[e].push(g):a[e]=[g]}catch(h){}a.rm1&&(a=this.convertOldFormat(a));this.set({chkin:a.chkin||[],chkout:a.chkout||[],adults:a.adults||["2"],children:a.children||["0"],childAge:a.childAge||[],swpToggleOn:a.swpToggleOn&&a.swpToggleOn[0]?"true"===a.swpToggleOn[0]:void 0,ts:a.ts})},serializeToQuery:function(){var a=this.toJSON();a.ts=b.now();return e.param(g.omit(a,function(a){return void 0===a}),!0)},getQueryFromUrl:function(){var a=f?location.hash.substring(1):"";a&&-1!==a.indexOf("\x26")||(a=location.search.substring(1));return a},convertOldFormat:function(a){var b,c,d,f={chkin:a.chkin,chkout:a.chkout,adults:[],children:[],childAge:[],ts:a.ts};for(b=1;8>=b;b++)if((c=a["rm"+b])&&c[0]){d=c[0].split(":");f.adults.push(d[0].substring(1));for(c=1;c<d.length;c++)d[c]&&f.childAge.push(d[c].substring(1));f.children.push(String(d.length-1))}return f},dateToISOString:function(a){var b=a.getUTCFullYear(),c=a.getUTCMonth()+1,c=10>c?"0"+c:c;a=a.getUTCDate();return[b,c,10>a?"0"+a:a].join("-")},getCheckIn:function(){return this.get("chkin")&&this.get("chkin")[0]},getISOCheckIn:function(){return this.dateToISOString(this.getDateFromString(this.getCheckIn()))},getCheckOut:function(){return this.get("chkout")&&this.get("chkout")[0]},getISOCheckOut:function(){return this.dateToISOString(this.getDateFromString(this.getCheckOut()))},isDateless:function(){return!(this.getCheckIn()&&this.getCheckOut())},getDateFromString:function(a){return c.datePickerCalendarObj.getDateFromString(a)},isValidDateRange:function(){try{if(!this.isDateless()){var a=this.getDateFromString(this.getCheckIn()),c=this.getDateFromString(this.getCheckOut()),d=new Date(b.now());d.setHours(0,0,0,0);if(a<c&&a>=d)return!0}}catch(f){}return!1},getChildAgesForRoom:function(a){var b,c=this.attributes,d=0;for(b=0;b<a;b++)d+=parseInt(c.children[b],10);a=parseInt(c.children[a],10);return c.childAge.slice(d,d+a)},getTotalAdults:function(){return g.reduce(this.get("adults"),function(a,b){return a+Number(b)},0)},getTotalChildren:function(){return g.reduce(this.get("children"),function(a,b){return a+Number(b)},0)}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("dateRangeModel",["backbone","urlModel"],function(e,h){return e.Model.extend({initialize:function(){this.urlModel=h.getSingleton();this.listenTo(this.urlModel,"change",this.updateFromUrlModel);this.updateFromUrlModel()},updateFromUrlModel:function(){this.set({checkIn:this.urlModel.get("chkin")[0],checkOut:this.urlModel.get("chkout")[0]})}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("roomCollection",["underscore","backbone","urlModel"],function(e,h,c){function b(){var a=l.attributes;return e.times(a.adults.length,function(b){return{roomIndex:b,adultCount:a.adults[b],childCount:a.children[b],childAges:d(b)}})}function d(a,b){var c=l.getChildAgesForRoom(a);"number"!==typeof b&&(b=c.length);return e.times(b,function(b){return{roomIndexChildIndex:[a,b].toString(),roomIndex:a,childIndex:b,age:c[b]}})}var l=c.getSingleton();c=h.Model.extend({idAttribute:"roomIndex",defaults:{roomIndex:void 0,adultCount:2,childCount:0},initialize:function(a,b){var c=new f(this.get("childAges"),b);c.roomIndex=this.get("roomIndex");this.childAgeCollection=c;this.on("change:childCount",function(a){c.setLength(parseInt(a.get("childCount"),10))})}});var g=h.Model.extend({idAttribute:"roomIndexChildIndex",defaults:{roomIndex:void 0,childIndex:void 0,age:void 0}}),f=h.Collection.extend({model:g,comparator:"childIndex",setLength:function(a){var b=this.length;if(b!==a)if(b<a)this.set(d(this.roomIndex,a));else for(a=b-a;a--;)this.pop()}});return h.Collection.extend({initialize:function(){this.updateRoomsFromUrlModel();this.listenTo(l,"change",this.updateRoomsFromUrlModel)},model:c,comparator:"roomIndex",setLength:function(a){var b;b=this.length;if(b!==a)if(b<a)for(;b<a;b++){var c=this.model;this.add({roomIndex:b,adultCount:c.adultCount,childCount:c.childCount})}else for(a=b-a;a--;)this.pop()},updateRoomsFromUrlModel:function(){this.set(b())},getTotalChildCount:function(){return this.reduce(function(a,b){return a+parseInt(b.get("childCount"),10)},0)},getTotalAdultCount:function(){return this.reduce(function(a,b){return a+parseInt(b.get("adultCount"),10)},0)}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("roomTypeCollection",["backbone"],function(e){return e.Collection.extend({})});define("mrp","marionette backbone uitk jquery underscore allOffersData hotelInfo i18n dctk/dctk infosite offersResponseModel".split(" "),function(e,h,c,b,d,l,g,f,a,k,p){function n(a){var b;l.length?b=l[a]:d.each(p.getSingleton().get("rooms"),function(c){return d.each(c.offers,function(c){c.offerIndex===a&&(b=c)})});return b}var q=e.ItemView.extend({template:"mrp-modal-template",serializeData:function(){var a=this.model.toJSON();return{segment1:a.offerSegments[0],segment2:a.offerSegments[1],showPolicySpace:(a.offerSegments[0].isNonRefundableInsideWindow||a.offerSegments[0].isFreeCancellable)!==(a.offerSegments[1].isNonRefundableInsideWindow||a.offerSegments[1].isFreeCancellable)?!0:!1,piid:a.piid,hotelID:g.id,roomTypeCode:a.roomTypeCode,offerType:a.offerType,payLater:a.payLater,paymentChoiceAvailable:a.paymentChoiceAvailable,airAttach:a.airAttach,roomOccupants:a.roomOccupants,activityID:a.activityID,isHasValueAdd:a.isHasValueAdd,valueAdd:a.valueAdd,offerIndex:a.offerIndex,isLoyaltyEarnings:a.isLoyaltyEarnings}}}),r=e.ItemView.extend({template:"mrp-tooltip-template",serializeData:function(){var a=this.model.toJSON();return{segment1:a.offerSegments[0],segment2:a.offerSegments[1],isLoyaltyEarnings:a.isLoyaltyEarnings}}});return{run:function(){var d=b("#rooms-and-rates");d.on(c.clickEvent,".mrp-book-button",function(){var d=b(this),e=parseInt(d.data("offer-index"),10),e=n(e),e={content:(new q({model:new h.Model(e)})).render().$el,modalId:"mrp-modal",dismiss:!1,title:f.roomtemplates.mrpModalTitle};c.modal.create(e).open();var e=d.data("mrp-savings-amount"),d=d.data("mrp-savings-percent"),g;g=0===e?"MRP|NoCompRate|NoCompRate**":"MRP|\x3c"+e+"\x3e|\x3c"+d+"\x3e";a.onReady(function(){a.trackEvent("o","",{prop55:g})})});d.on(c.clickEvent,".mrp-details-tooltip-link",function(){var a=b(this),d=parseInt(a.closest(".rate-plan").find(".mrp-book-button").data("offer-index"),10),d=n(d),d=(new r({model:new h.Model(d)})).render().$el;a.uitk_tooltip({pos:"tl",width:570},"updateContent",d);c.utils.focusElement(a)});b("body").on(c.clickEvent,"#mrp-checkout-button-step1",function(){var c=b(this).data("inventorytype"),d=g.id;a.onReady(function(){a.trackEvent("o","description",{products:"Hotel:"+c+"Hotel:"+d+";;;;eVar51\x3dMRP.Hotel.Rate1"},"event107")})});b("body").on(c.clickEvent,"#mrp-checkout-button-step2",function(){var c=b(this).data("inventorytype"),d=g.id;a.onReady(function(){a.trackEvent("o","description",{products:"Hotel:"+c+"Hotel:"+d+";;;;eVar51\x3dMRP.Hotel.Rate2"},"event107")})});c.subscribe("modal.close",function(a,c){if("mrp-modal"===c.options.modalId){var d=b("#"+c.options.modalId),f=d.find(".book-button").data("offer-index");k.track("HOT.HIS.RoomsAndRates.BookNow"+f+"|MixRate.close",d.get(0))}})}}});
define("baseLayout",["marionette","logger"],function(e,h){return e.LayoutView.extend({constructor:function(){e.LayoutView.apply(this,arguments)},el:"body",template:!1,ui:{experiments:"#experiments",banners:"#banner-container",top:"#sold-out-recommendation-container",backToSearch:".back-to-search-wrapper",playback:".playback-wrapper",leadprice:"#lead-price-container",pricechange:"#price-change-container",rewardsPriming:"#rewards-priming-container",main:"#rooms-and-rates",noAvailabilityFootnote:"#hotel-level-no-availability-error-footnote",soldOutFootnote:"#room-level-sold-out-footnote",lxRecommendations:"#recommendation-lx",bottom:"#recommendation",alternateRecommendations:".exp10184-placeholder-underrooms"},regions:{banners:"@ui.banners",top:"@ui.top",backToSearch:"@ui.backToSearch",playback:"@ui.playback",leadprice:"@ui.leadprice",pricechange:"@ui.pricechange",rewardsPriming:"@ui.rewardsPriming",main:"@ui.main",lxRecommendations:"@ui.lxRecommendations",bottom:"@ui.bottom",alternateRecommendations:"@ui.alternateRecommendations"},remove:function(){!1!==this.template&&this.$el.remove();this.stopListening();return this},safeShow:function(c,b,d){var e=this.getRegion(c);try{if(e.$el[0])e.show(new b);else if(!d)throw Error("region not found ["+c+"]");}catch(g){h.logError("view initialization",g,{regionName:c,viewName:b.constructorName})}}})});define("standardLayout","jquery marionette offersResponseModel baseLayout recommendationsLxView recommendationsView playbackView leadpriceView backToSearchView pricechangeView rewardsPrimingView wizardRoomsAndRatesView airAttachBannerView uitk".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q,r){return b.extend({initialize:function(){this.listenTo(c.getSingleton(),"change",this.toggleFootnotes)},onRender:function(){this.safeShow("leadprice",f);this.safeShow("pricechange",k);this.safeShow("rewardsPriming",p,!0);this.safeShow("lxRecommendations",d);this.safeShow("bottom",l);this.main.show(new n);this.playback.show(new g);this.backToSearch.show(new a);this.banners.show(new q);r.publish("standardLayout.render",this)},toggleFootnotes:function(){var a=c.getSingleton();this.ui.noAvailabilityFootnote.toggleClass("hidden",a.get("isThereABookableOffer"));this.ui.soldOutFootnote.toggleClass("hidden",!a.get("isAnyOfferSoldOut"))}},{layoutName:"standardLayout"})});define("soldOutLayout","marionette baseLayout wizardView recommendationsView infositeData i18n roomsAndRatesData".split(" "),function(e,h,c,b,d,l,g){var f=e.LayoutView.extend({template:"recommendations-ajaxrr-soldout",ui:{wizard:"#availability-well-box",recommendations:".recommendations-grid"},regions:{wizard:"@ui.wizard",recommendations:"@ui.recommendations"},templateHelpers:function(){return{onHoldTitle:(0,l.soldOut[1===g.errorMessagingType?"soldOutOnOurSite":"onHoldHotelName"])({soldOutHotelName:d.soldOutHotelName}),showSoldOutFootnote:2===g.errorMessagingType}},onBeforeShow:function(){this.wizard.show(new c);this.recommendations.show(new b)}});return h.extend({onRender:function(){this.top.show(new f);this.ui.noAvailabilityFootnote.addClass("hidden");this.ui.soldOutFootnote.addClass("hidden")}},{layoutName:"soldOutLayout",WizardAndRecommendationsView:f})});define("coupon",["jquery"],function(e){return{run:function(){e(document).on("click","#generated-coupon-details",function(e){window.open("//www.expedia.com/p/info-terms/terms?pageid\x3d16721","","width\x3d600,height\x3d400");e.preventDefault()})}}});define("loyalty",["jquery","dctk/dctk","experiments"],function(e,h,c){return{run:function(){c[8843]&&e("#vipAccessHeaderLogo").click(function(){h&&h.enabled&&h.trackEvent({rfrr:"HOT.HIS.Rewards.VIPLogo"})})}}});define("validation",["jquery","uitk","experiments","wizardConfig"],function(e,h,c,b){function d(b,a){var c=e(this);if(a&&!a.valid){var d=c.closest(".search-form"),g=c.closest(".toggle-pane");0<g.length&&!g.is(".open")&&d.find('a[href\x3d"#'+g.attr("id")+'"]').uitk_toggle("open");c.parent("label").addClass("invalid");var d=e("#"+d.data("errors-container")),h;a.valueMissing?h=d.find("#"+c.data("required-error")):a.patternMismatch&&(h=d.find("#"+c.data("pattern-error")));h&&(h.removeClass("hidden"),h.find("a").attr("href")||h.find("a").attr("href","#"+c.attr("id")))}}var l={},g={availMissingCheckIn:"checkInRequiredError",availMissingCheckOut:"checkOutRequiredError","required-age-error":"ageRequiredError"};e(".search-wizard").on("change",":input[required]",function(){""!==e(this).val()&&e(this).parent("label").removeClass("invalid")});h.subscribe("calendar.selectDate",function(b,a){""!==e(a.element).val()&&e(a.element).parent("label").removeClass("invalid")});l.validate=function(f,a){var k=!0,h={};a=a||[];1===c[8100]?require("offersResponseModel",function(a){a.getSingleton().errors.unset("vaildationErrors")}):e(".error-summary").find(".validation-msg").addClass("hidden");f.find(":input[required], :input[pattern]").bind("invalid",d);f.find(":input").each(function(){var a=e(this),c;c=a.attr("name");var d=a.val(),f="undefined"!==typeof a.attr("required");c="undefined"!==typeof a.attr("pattern");var l=b.dateValidationRegularExpression,m=a.attr("placeholder");d===a.attr("placeholder")&&(d="");f=f&&(0===d.length||!window.Modernizr.input.placeholder&&d===m);d=c&&0<d.length&&!d.match(l);f&&(c=g[a.data("required-error")]||a.data("required-error"),h[c]||(h[c]=a));d&&(c=a.attr("name"),c="chkin"===c||"chkout"===c?"dateFormatError":a.data("pattern-error"),h[g[c]||c]=a);if(f||d)a.trigger("invalid",{valueMissing:f,patternMismatch:d,valid:!f&&!d}),k=!1});for(var l in h)a.push({messageKey:l,inputId:h[l].attr("id")});k&&e("#orgLocation")&&e("#orgLocation").val()!==e("#destination").val()&&(e("#regionId").val(""),e("#inpRegionType").val(""),e("#orgLocation").val(""));return k};return l});
define("search",["searchData","jquery","infosite"],function(e,h,c){function b(){var b=0;h.each(l.data.rooms,function(c,a){b+=a.adultCount()});return b}function d(){var b=0;h.each(l.data.rooms,function(c,a){b+=a.childCount()});return b}var l=new c.DeprecatedModule;l.isValidHash=function(b){for(var c=!1,a=!1,d=!1,e=0;e<b.length;e++)-1<b[e].indexOf("chkin")?c=!0:-1<b[e].indexOf("chkout")?a=!0:-1<b[e].indexOf("rm")&&(d=!0);return c&&a&&d};l.data={minAdults:1,minChildren:0,rooms:[],roomOptions:[],adultCount:b,childCount:d,hasMultipleRooms:function(){return 1<l.data.rooms.length},hasMaxRooms:function(){return l.data.rooms.length===l.data.maxRooms},hasMultipleAdults:function(){return 1<b()},hasChildren:function(){return 0<d()},hasMultipleChildren:function(){return 1<d()}};l.createRoom=function(b,c,a){for(var d={roomNumber:b,adults:[],children:[],adultCount:function(){for(var a=0;a<this.adults.length;a++)if(this.adults[a].isSelected)return a+1;return 0},childCount:function(){for(var a=0;a<this.children.length;a++)if(this.children[a].isSelected)return a;return 0},hasChildren:function(){return 0<this.childCount()}},e=l.data.minAdults;e<=l.data.maxAdults;e++)d.adults.push({text:e,isSelected:e===c});for(c=l.data.minChildren;c<=l.data.maxChildren;c++){for(var e={childNumber:c+1,isSelected:c===a.length,isVisible:c<a.length,roomNumber:b,ageOptions:[{text:"--",value:"",isSelected:0===a.length}],getAge:function(){for(var a=0;a<this.ageOptions.length;a++)if(this.ageOptions[a].isSelected)return a-1;return 0}},h=0;h<=l.data.maxChildAge;h++){var q=l.createChildAge(h,c,b,a);e.ageOptions.push(q)}d.children.push(e)}return d};l.createChildAge=function(b,c,a,d){return{text:0===b?"0 - 1":b,value:a+"_"+b,isSelected:c<d.length&&parseInt(d[c],10)===b}};l.updateAdults=function(b,c){for(var a=l.data.rooms[b],d=0;d<a.adults.length;d++)a.adults[d].isSelected=!1;a.adults[c-1].isSelected=!0};l.updateChildAge=function(b,c,a){b=l.data.rooms[b].children[c];for(c=0;c<b.ageOptions.length;c++)b.ageOptions[c].isSelected=!1;b.ageOptions[a].isSelected=!0};l.updateChildren=function(b,c){for(var a=l.data.rooms[b],d=0;d<a.children.length;d++)a.children[d].isVisible=d<c,a.children[d].isSelected=!1;a.children[c].isSelected=!0};l.changeNumberOfRooms=function(b){for(var c=l.data.roomOptions,a=l.data.rooms,d=0;d<c.length;d++)c[d].isSelected=!1;c[b].isSelected=!0;if(b<a.length-1)l.data.rooms=a.slice(0,b+1);else if(b>=a.length)for(d=a.length;d<b+1;d++)c=l.createRoom(d+1,2,[]),l.data.rooms.push(c)};l.run=function(){l.runExperiments();l.data.checkIn=e.checkIn;l.data.checkOut=e.checkOut;l.data.maxRooms=e.maxRooms;l.data.maxAdults=e.maxAdults;l.data.maxChildren=e.maxChildren;l.data.maxChildAge=e.maxChildAge;for(var b=[],c=0;c<e.selRoomIndex;c++){var a=c+1,d=parseInt(e.rooms[c].adults,10),a=l.createRoom(a,d,e.rooms[c].childAges);b.push(a)}l.data.rooms=b;b=[];for(c=0;c<e.maxRooms;c++)b.push({roomNumber:c+1,isSelected:c===e.selRoomIndex-1});l.data.roomOptions=b};return l});define("leadprice",["jquery"],function(e){return{run:function(){var h=e(".hpg-join-now").attr("href");"/"!==window.location.pathname&&(h+="\x26uurl\x3d"+encodeURIComponent("e3id\x3dredr\x26rurl\x3d"+window.location.pathname+window.location.search+window.location.hash),e(".hpg-join-now").attr("href",h))}}});define("availability","search jquery uitk handlebars validation infosite dctk/dctk".split(" "),function(e,h,c,b,d,l,g){function f(){var a=b.templates["availability-room-child-ages-template"](e.data);h("#traveler-ages").html(a);a=b.templates["availability-room-occupants-template"](e.data);h("#availability-wizard").find(".traveler-options").html(a);c.publish("infosite.availability.travelerOptions")}function a(a){var d=b.templates["child-count-template"](e.data.rooms[a]);h("#availability-wizard").find(".room-traveler-ages").eq(a).find(".children-selector").html(d);c.publish("infosite.availability.renderChildren",a)}function k(){h("#availability-wizard").addClass("collapsed-wizard");c.utils.focusElement(h("#show-availability-wizard"))}function p(){h("#availability-wizard").removeClass("collapsed-wizard");c.utils.focusElement(h("#availability-form"))}return{run:function(){f();h(".search-wizard").on("change",".adult-selector",function(){var a=parseInt(h(this).closest(".room-traveler-ages").data("room-index"),10),d=parseInt(h(this).val(),10);e.updateAdults(a,d);d=b.templates["adult-count-template"](e.data.rooms[a]);h("#availability-wizard").find(".room-traveler-ages").eq(a).find(".adult-selector").html(d);c.publish("infosite.availability.renderAdults",a);l.track("AvailWizard.Adult",this)});h(".search-wizard").on("change",".children-selector",function(){var b=parseInt(h(this).closest(".room-traveler-ages").data("room-index"),10),c=parseInt(h(this).val(),10);e.updateChildren(b,c);a(b);f();l.track("AvailWizard.Child",this);h("#availability-wizard").find(".room-traveler-ages").eq(b).find(".children-selector").focus()});h(".search-wizard").on("change",".child-age-selector",function(){var b=parseInt(h(this).data("room-number"),10)-1,c=parseInt(h(this).data("child-index"),10),d=parseInt(h(this).children("option:selected").data("age"),10);e.updateChildAge(b,c,d);a(b);f();l.track("AvailWizard.Child",this);h("#availability-wizard").find('.room-traveler-child-ages[data-room-index\x3d"'+b+'"]').find(".child-age-selector").eq(c).focus()});h("#availability-wizard").on("change",".rooms-selector",function(){e.changeNumberOfRooms(this.selectedIndex);f();h("#availability-wizard .rooms-selector").focus()});h("#availability-wizard").on(c.clickEvent,"#show-availability-wizard",p);h("#availability-wizard").on(c.clickEvent,"#hide-availability-wizard",k);h("#update-availability-button").bind(c.clickEvent,function(a){var b=h("#availability-form"),b=d.validate(b);h("#apply-points-checkbox").prop("checked")&&(h("#apply-points-checkbox").prop("checked")?(h("#swp").val("ON"),g.trackEvent({rfrr:"HOT.HIS.RoomsAndRates.PointsAppliedToggleOn"})):(h("#swp").val("OFF"),g.trackEvent({rfrr:"HOT.HIS.RoomsAndRates.PointsAppliedToggleOff"})));b?g.trackNextPage("HOT.HIS.AvailWizard.UpdateShowRates",this):(h("#availabilityValidationErrors").removeClass("hidden"),h("#allAvailabilityErrors").get(0).scrollIntoView(),a.preventDefault(),c.utils.focusElement(h("#availabilityValidationErrors")))});var n=h("#update-availability-button");h("#availability-wizard").on("focus click","a, select, input",function(){n.removeProp("disabled")});h(".validation-alert a").on(c.clickEvent,function(a){var b=h(this).attr("href");a.preventDefault();c.utils.focusElement(h(b))})}}});define("navigation",["infosite","jquery","uitk"],function(e,h,c){var b;b=function(b){var e=h("#availability-header").offset().top-parseInt(h("#availability-header").css("margin-top"),10);h("html, body").stop().animate({scrollTop:e},800,"swing",function(){c.utils.focusElement(h("#availability-header"))});b.preventDefault()};return{run:function(){h(".lead-price").on(c.clickEvent,".link-to-rooms",b)}}});
define("eds","jquery uitk edsModel validation infosite modernizr urlModel experiments infositeData wizardConfig".split(" "),function(e,h,c,b,d,l,g,f,a,k){function p(){var a=e("#inp-start-date-eds"),c=e("#inp-end-date-eds");e("#eds-error-msg").find(".validation-msg").addClass("hidden");e("#eds-fields label").removeClass("invalid");a.val()===a.attr("placeholder")&&a.val("");c.val()===c.attr("placeholder")&&c.val("");e(".uitk-tooltip").hide();b.validate(e(".eds-form"))?(1!==f[8100]?(e("#availability-check-in").val(e("#inp-start-date-eds").val()),e("#availability-check-out").val(e("#inp-end-date-eds").val()),e("#availability-form").submit()):n.save({chkin:[e("#inp-start-date-eds").val()],chkout:[e("#inp-end-date-eds").val()]}),q&&(q.close(),document.getElementById("rooms-and-rates").scrollIntoView(!0))):(e("#eds-error-msg").removeClass("hidden"),h.utils.focusElement(e("#eds-error-msg")))}var n=g.getSingleton(),q,r,s=e.extend({},c);if(a.isPackageInfosite)return s.run=e.noop,s;s.showEdsModal=function(){var b,c;if(!k.shouldShowEDS)return!1;if(q){q.open();b=e("#inp-start-date-eds");c=e("#inp-end-date-eds");if(l.touch||l.win8touch)b.prop("readonly",!0),c.prop("readonly",!0);e("#eds-error-msg").find(".validation-msg").addClass("hidden");e("#eds-fields label").removeClass("invalid");l.placeholder?(b.val(""),c.val("")):(b.val(b.attr("placeholder")),c.val(c.attr("placeholder")),h.updatePlaceholderClass(b),h.updatePlaceholderClass(c))}else a.isInformationOnlyEnabled||(q=h.modal.create({content:"eds-modal-display",modalId:"eds-modal",background:!0,dismiss:!0,focusOpen:"eds-heading"}),e("#eds-modal-display").remove());h.publish("infosite.edsModal")};s.showEdsOnPageLoad=function(){n.on("change",function(){n.isValidDateRange()||s.showEdsModal()});k.shouldShowEDS&&0===f[11218]&&!n.isValidDateRange()&&s.showEdsModal()};s.run=function(){s.showEdsOnPageLoad();e("body").on(h.clickEvent,"#eds-submit-action",function(){p()}).on("keypress","input",function(a){var b=0;window.event?b=window.event.keyCode:a&&(b=a.which);13===b&&p()});r=e(".eds-form");r.find("input").each(function(){var a=e(this);a.focus(function(){var a=e(this);a.val()===a.attr("placeholder")&&a.val("")});a.blur(function(){var a=e(this);""===a.val()&&h.updatePlaceholderValue(a)});""===a.val()&&h.updatePlaceholderValue(a)});e("#choose-dates-button").bind(h.clickEvent,function(a){s.showEdsModal();d.track("BookNowModule.EnterDates",this);a.preventDefault()})};return s});define("photos","jquery hammer infosite uitk handlebars dctk/dctk".split(" "),function(e,h,c,b,d,l){function g(a,b,c){a=d.templates["hero-photo-caption"]({photoNumber:a+1,totalNumber:p.length,photoCaption:b,bookThisRoom:c});e(".jumbo-wrapper .image-caption").html(a)}function f(a){e(".image-caption").on(b.clickEvent,".link-to-rooms",function(c){var d=e(".book-now-form input[value\x3d'"+a+"']");if(d.length){var f=d.closest("tbody"),d=f.offset().top;e("html, body").stop().animate({scrollTop:d},800,"swing",function(){b.utils.focusElement(e(f))})}c.preventDefault()})}var a={},k=null,p=e("#hotel-thumbnails").find(".hotel-thumbnail"),n,q;a.loadPreviousImage=function(){var a=e(".jumbo-hero").find(".selected"),c=0===a.prev(".hero").length?e(".jumbo-hero .hero").last():a.prev(".hero"),d=e("#hotel-thumbnails").find(".hotel-thumbnail"),f=d.eq(c.index());c.attr("src",c.data("src"));a.removeClass("selected").attr("aria-hidden","true");c.addClass("selected").attr("aria-hidden","false");g(c.index(),c.attr("alt"),c.attr("id"));d.removeClass("selected");f.is(".hidden")&&(f.removeClass("hidden"),c.index()===d.last().index()?(d.addClass("hidden"),d.slice(-10).removeClass("hidden")):d.not(".hidden").last().addClass("hidden"),b.publish("debounced.scroll"));n||(l.onReady(function(){l.trackEvent({rfrr:"HOT.HIS.Photo.Jumbo.FlipLeft"})}),n=!0);f.addClass("selected")};a.loadNextImage=function(){var a=e(".jumbo-hero").find(".selected"),c=0===a.next(".hero").length?e(".jumbo-hero .hero").first():a.next(".hero"),d=e("#hotel-thumbnails").find(".hotel-thumbnail"),f=d.eq(c.index());c.attr("src",c.data("src"));a.removeClass("selected").attr("aria-hidden","true");c.addClass("selected").attr("aria-hidden","false");g(c.index(),c.attr("alt"),c.attr("id"));d.removeClass("selected");f.is(".hidden")&&(f.removeClass("hidden"),0===c.index()?(d.slice(0,10).removeClass("hidden"),d.slice(10).addClass("hidden")):d.not(".hidden").first().addClass("hidden"),b.publish("debounced.scroll"));q||(l.onReady(function(){l.trackEvent({rfrr:"HOT.HIS.Photo.Jumbo.FlipRight"})}),q=!0);f.addClass("selected")};a.endDebounce=function(){clearTimeout(k)};a.debouncedLoad=function(a,b){return function(){var c=this,d=arguments;k=setTimeout(function(){a.apply(c,d)},b)}}(function(){var a=e(".jumbo-hero").find("img"),b=e(this),c=a.eq(b.index());p.removeClass("selected");b.addClass("selected");"undefined"===typeof c.attr("src")&&c.attr("src",c.data("src"));g(b.index(),c.attr("alt"),c.attr("id"));a.removeClass("selected").attr("aria-hidden","true");c.addClass("selected").attr("aria-hidden","false");f(c.attr("id"))},250);a.bindEvents=function(){e(document).keydown(function(b){e(b.target).is(":input")||(37===b.which?a.loadPreviousImage():39===b.which&&a.loadNextImage())});e(".jumbo-image-prev").bind(b.clickEvent,a.loadPreviousImage);e(".jumbo-image-next").bind(b.clickEvent,a.loadNextImage);e("#hotel-thumbnails").on("mouseenter",".hotel-thumbnail",a.debouncedLoad).on(b.clickEvent,".hotel-thumbnail",a.debouncedLoad).on("mouseleave",".hotel-thumbnail",a.endDebounce)};a.bindHammerEvents=function(){var b=e("#toggle-banner").get(0);"undefined"!==typeof b&&(b=new h(b),"function"===typeof b.on&&(b.on("swipeleft",function(){a.loadNextImage();c.track("Photo.SwipeLeft",this.context)}),b.on("swiperight",function(){a.loadPreviousImage();c.track("Photo.SwipeRight",this.context)})))};a.run=function(){a.bindEvents();a.bindHammerEvents()};return a});
define("roomsAndRates","roomsAndRatesData jquery handlebars infosite uitk i18n infositeData".split(" "),function(e,h,c,b,d,l,g){function f(a,b,c,d,e){if(0>a)b.remove(),c.removeClass("hidden");else{var g=0,k=0,h=0,h=a,g=Math.floor(h/3600),h=h%3600,k=Math.floor(h/60),h=h%60;d.html(" "+g+":"+((10>k?"0":"")+k)+":"+((10>h?"0":"")+h));e.data("hours",g);e.data("minutes",k);e.data("seconds",a);setTimeout(function(){f(a-1,b,c,d,e)},1E3)}}function a(){"undefined"!==typeof s&&s.close()}function k(a,b){function c(){var a=h("#rooms-and-rates"),b=a.children(".bookable"),d=a.children(".room:not(.bookable)"),f=a.children("footer");e=!e;a.append(b.get().sort(g));d&&a.append(d.get().sort(g));f&&a.append(f)}var f=h(a),e=!1,g=function(a,c){return r.sortComparison(parseInt(h(a).data(b),10),parseInt(h(c).data(b),10),e)};f.bind(d.clickEvent,function(){h("#show-more-rooms").hasClass("open")?c():(r.toggleShowMore(),c(),r.toggleShowMore());!1===e?h("#aria-live-region-infosite").text(f.data("accesibility-text-descending")):h("#aria-live-region-infosite").text(f.data("accesibility-text-ascending"));h(".sort-element").children("button:not("+a+")").removeClass("btn-sub-action");h(".sort-element").children("button:not("+a+")").addClass("btn-utility");h(a).addClass("btn-sub-action");h(a).removeClass("btn-utility")})}function p(a){if(a){var b=h(a);b&&b[0]&&(r.tabTable[a]=b[0].tabIndex,b[0].tabIndex=-1,b.addClass("disabled"))}}function n(a){if(a){var b=h(a);b&&b[0]&&(b[0].tabIndex=r.tabTable[a],b.removeClass("disabled"))}}function q(a,b){var c=e.galleryImageUrls[b][a].displayText,f=e.galleryImageUrls[b].length.toString();d.utils.liveAnnounce(l.roomthumbnails.imageNumberAndDescription.replace("{0}",(a+1).toString()).replace("{1}",f).replace("{2}",c),"assertive")}var r=new b.DeprecatedModule;r.queryString=e.queryString;var s,t;r.tabTable={};r.renderPaymentChoiceModal=function(a){a.preventDefault();a=h(this);var f=a.data("form-index"),f={isDisplayAvgPrice:a.data("is-display-avg-price"),formIndex:f,payNowRfrr:a.data("pay-now-rfrr"),payLaterRfrr:a.data("pay-later-rfrr"),piid:a.data("piid"),choicePiid:a.data("choice-piid"),price:a.data("price"),"choice-price":a.data("choice-price"),currencyPosa:a.data("currency-posa"),currencyPosu:a.data("currency-posu"),areCurrenciesDifferent:a.data("currency-posa")!==a.data("currency-posu"),taxesFeesMsg:a.data("taxes-fees-msg"),oldPrice:a.data("old-price"),choiceOldPrice:a.data("choice-old-price"),displayTaapInfo:a.data("display-taap-info"),isESR:a.data("is-esr"),isEEM:a.data("is-eem"),isCurrencySame:a.data("is-currency-same"),isFreeCancellation:a.data("is-free-cancellation"),isInstallmentFeatureEnabled:a.data("is-installment-feature-enabled"),roomOccupants:a.data("room-occupants"),inventoryType:a.data("inventorytype"),choiceInventoryType:a.data("choice-inventorytype"),hasLoyaltyBurn:a.data("has-loyalty-burn"),loyaltyBurnedPrice:a.data("loyalty-burned-price"),crossOutPrice:a.data("cross-out-price"),loyaltyEarnPoints:a.data("loyalty-earn-points"),loyaltyEarnPrice:a.data("loyalty-earn-price"),payLaterLoyaltyEarnPoints:a.data("pay-later-loyalty-earn-points"),payLaterLoyaltyEarnPrice:a.data("pay-later-loyalty-earn-price")},f=c.templates["payment-choice-template"](f);h("#payment-choice-modal-content").data("close-rfrr",a.data("close-rfrr"));d.modal.create({modalId:"payment-choice-modal",dismiss:!1}).updateContent(f,a.data("title"));b.track("BookButton.LaunchETP",a)};r.handleMrpSelection=function(){var a=h(this);_gaq.push(["_trackEvent","Booking","Infosite","Hotels",,!0]);var b=h(".book-now-form");b.eq(a.data("form-index")).find("input[name\x3dpiid]").val(a.data("piid"));b.eq(a.data("form-index")).find("input[name\x3dprices]").val("curc\x3d"+a.data("currency")+"\x26pqar\x3d"+a.data("price"));b.eq(a.data("form-index")).find("input[name\x3dmrp]").val(a.data("step"));b.eq(a.data("form-index")).find("input[name\x3dmrpguid]").val(a.data("activityid"));b.eq(a.data("form-index")).find("input[name\x3dratePlanCode]").val(a.data("rateplancode"));b.eq(a.data("form-index")).find("input[name\x3dcheckInDate]").val(a.data("checkindate"));b.eq(a.data("form-index")).find("input[name\x3dcheckOutDate]").val(a.data("checkoutdate"));b.eq(a.data("form-index")).submit()};r.handleChoiceSelection=function(){var a=h(this);r.showBookInterstitial();_gaq.push(["_trackEvent","Booking","Infosite","Hotels",,!0]);var b=h(".book-now-form"),c=a.data("piid");c&&b.eq(a.data("form-index")).find("input[name\x3dpiid]").val(c);b.eq(a.data("form-index")).find("input[name\x3disPayLater]").val(a.data("paylater"));b.eq(a.data("form-index")).find("input[name\x3dinventoryType]").val(a.data("inventorytype"));(c=a.data("oldprice"))&&b.eq(a.data("form-index")).find("input[name\x3dprices]").val(c);(c=a.data("price"))&&b.eq(a.data("form-index")).find("input[name\x3dprices]").val("curc\x3d"+a.data("currency")+"\x26pqar\x3d"+c);b.eq(a.data("form-index")).submit()};r.renderPaymentChoiceTooltip=function(){var a=h(this),b={currencyPosa:a.data("currency-posa"),currencyPosu:a.data("currency-posu"),areCurrenciesDifferent:a.data("currency-posa")!==a.data("currency-posu"),displayTaapInfo:a.data("display-taap-info"),isESR:a.data("is-esr"),isEEM:a.data("is-eem"),isInstallmentFeatureEnabled:a.data("is-installment-feature-enabled")},b=c.templates["payment-choice-tooltip-template"](b);a.uitk_tooltip({pos:"tl",width:570},"updateContent",b)};r.renderDrrCountDownTooltip=function(){var a=h(this),b={hours:a.data("hours"),minutes:a.data("minutes"),expirationDate:a.data("expiration-date"),title:a.data("title"),lessThanAMinute:"60">a.data("seconds"),type1:a.data("type1"),type2:a.data("type2"),type3:a.data("type3")},b=c.templates["drr-countdown-tooltip-template"](b);a.uitk_tooltip({pos:"br",width:350},"updateContent",b)};r.showDrrCountdown=function(){h(".show-drr-countdown").each(function(){var a=h(this),b=parseInt(a.data("expiration").toString().replace(/\,/g,""),10),c=a.find(".drr-countdown-tooltip-link"),d=a.find(".drr-countdown-timer"),a=a.find(".drr-expired-tooltip-wrapper");f(b,c,a,d,c)})};r.showBookInterstitial=function(){var b=(new Date).getTime();t=setInterval(function(){15E3<(new Date).getTime()-b&&(a(),clearInterval(t))},1E3);s=d.modal.create({content:"book-interstitial",modalId:"book-interstitial-modal",title:e.interstitialTitle,background:!1,dismiss:!1});d.utils.liveAnnounce(e.interstitialTitle)};r.numAboveFold=h(".room-above-fold").length;r.toggleShowMore=function(){h("#rooms-and-rates").find(".room").slice(r.numAboveFold).toggleClass("hidden")};h(window).bind("pageshow",function(b){b.originalEvent.persisted&&a()});r.sortComparison=function(a,b,c){return 0===b&&0===a?0:0===b?-1:0===a?1:c?a-b:b-a};k("#room-size-sort-selector","areaSort");k("#occupancy-sort-selector","occupancySort");r.showPricesButtonHandler=function(a){h("#availability-check-in-label").get(0).scrollIntoView();!g.isPackageInfosite&&g.isMobilePhone?(h("#availability-wizard").hasClass("collapsed-wizard")&&h("#availability-wizard").removeClass("collapsed-wizard"),d.utils.focusElement(h("#availability-check-in"))):h("#availability-check-in").focus();a.stopPropagation();b.track("RoomsAndRates.ShowPrices",this)};r.run=function(){r.runExperiments();var a=h("#rooms-and-rates"),f=h("body");a.on(d.clickEvent,".see-choice",r.renderPaymentChoiceModal);a.on(d.clickEvent,".payment-choice-tooltip-link",r.renderPaymentChoiceTooltip);f.on(d.clickEvent,".choice-book-button",r.handleChoiceSelection);f.on(d.clickEvent,".mrp-checkout-button",r.handleMrpSelection);f.on(d.clickEvent,".deposit-choice-book-button",r.handleChoiceSelection);h(".show-prices-button").bind(d.clickEvent,r.showPricesButtonHandler);h("#show-more-rooms").bind(d.clickEvent,function(a){var b=h(this);r.toggleShowMore();b.hasClass("open")?(b.removeClass("open"),b.html(b.data("expand-text")),b.attr("aria-expanded","false"),b.focus()):(b.addClass("open"),b.html(b.data("collapse-text")),b.attr("aria-expanded","true"),h(h(".room")[r.numAboveFold]).attr("tabIndex",-1).focus());a.preventDefault()});a.on(d.clickEvent,
".drr-countdown-tooltip-link",r.renderDrrCountDownTooltip);r.showDrrCountdown();a.on(d.clickEvent,".book-button",function(){h(this).hasClass("see-choice")||h(this).hasClass("see-deposit-choice")||h(this).hasClass("etp-book-button")||h(this).hasClass("mrp-book-button")||(r.showBookInterstitial(),_gaq.push(["_trackEvent","Booking","Infosite","Hotels",,!0]))});a.on(d.clickEvent,".clickable-thumbnail",function(a){for(var b=h(this).closest(".room").data("room-code"),f=e.rooms,g=0;g<f.length&&parseInt(f[g].roomTypeCode,10)!==b;g++);b=c.templates["room-gallery"](f[g].photos);d.subscribe("modal.appended",function(){var a=h("#room-gallery-modal");a.find("section[data-control\x3dmedia-viewer]").uitk_mediaViewer();a.find("section[data-control\x3dimage-slider]").uitk_mediaSlider()});d.modal.create({content:b,modalId:"room-gallery-modal",background:!0,dismiss:!0,title:f[g].name},h(this));a.preventDefault();r.thumbnailFireControl=this});a.on(d.clickEvent,".large-thumbnail-wrapper",function(a){var b=h(this).closest(".room").data("room-index"),f=h(this).find(".large-thumbnail").data("photo-index"),g=c.templates["room-image-gallery-template"](e.galleryImageUrls[b][f]);d.modal.create({content:g,modalId:"room-gallery-modal",background:!0,dismiss:!0},h(this));a.preventDefault();a=h("#room-gallery-modal");a.data("room-index",b);a.data("photo-index",f);0===f&&p(".room-image-prev");f===e.galleryImageUrls[b].length-1&&p(".room-image-next");r.thumbnailFireControl=this});d.subscribe("modal.close",function(a,c){c&&c.modalHtml&&c.modalHtml[0]&&"room-gallery-modal"===c.modalHtml[0].id&&b.track("RoomsAndRates.CloseRoomImageGallery",c.modalHtml[0]);r.thumbnailFireControl&&r.thumbnailFireControl.focus()});f.on(d.clickEvent,".room-image-prev",function(){var a=h("#room-gallery-modal"),b=h("#room-gallery-image"),c=a.data("room-index"),d=a.data("photo-index");h(".room-image-prev").hasClass("disabled")||(d--,0===d&&p(".room-image-prev"),n(".room-image-next"),q(d,c),b.find("img").attr("src",g.mediaRootUrl+e.galleryImageUrls[c][d].imageUrl),a.data("photo-index",d))});f.on(d.clickEvent,".room-image-next",function(){var a=h("#room-gallery-modal"),b=h("#room-gallery-image"),c=a.data("room-index"),d=a.data("photo-index");h(".room-image-next").hasClass("disabled")||(d++,d>=e.galleryImageUrls[c].length-1&&p(".room-image-next"),n(".room-image-prev"),q(d,c),b.find("img").attr("src",g.mediaRootUrl+e.galleryImageUrls[c][d].imageUrl),a.data("photo-index",d))});h(".room .description-trigger").bind(d.clickEvent,function(){h(this).hasClass("open")?h(this).parents("tbody").find(".room-information-container").addClass("hidden"):h(this).parents("tbody").find(".room-information-container").removeClass("hidden")});f.on(d.clickEvent,".etp-modal-trigger",function(a){var b=h(this).closest(".payment-choice-details-wrapper"),c=b.find(".etp-modal-trigger"),f=b.find(".payment-choice-details"),e=b.hasClass("collapsed");b.toggleClass("collapsed");c.toggleClass("hidden");f.attr("aria-hidden",e?!1:!0);d.utils.focusElement(h(this).siblings(".etp-modal-trigger"));a.preventDefault()})};return r});
define("offersResponseModel","roomsAndRatesData jquery backbone infositeData ajaxTaapModel underscore experiments errorModel countdownModel hotelInfo i18n urlModel logger dctk afrData".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q,r,s){var t=n.getSingleton();return c.Model.extend({initialize:function(b,d){this.airAttach=new a;this.loyaltyData=new c.Model;this.leadOffer=new c.Model;this.errors=new f;this.initBedding();this.listenTo(t,"sync",l.partial(this.fetch,d));this.on("error",this.setDefaultErrorMessage);this.hasSentMCTC=!1},initBedding:function(){var a=this;h.each(e.rooms,function(b,c){try{var d=p.getMessage("roomtemplates.bedTypesSeparator");c.bedNames&&(c.bedNames=c.bedNames.join(" "+d+" "));c.beddingOptions&&(c.beddingOptions=c.beddingOptions.join(" "+d+" "));c.amenities&&(c.extraBeddingOptions=c.amenities["4307"]||c.amenities["4949"]||c.amenities["4948"]||c.amenities["4950"]||c.amenities["4951"]||c.amenities["2044"]||c.amenities["2045"],c.cribBedding=c.amenities["4949"]||c.amenities["4948"]||c.amenities["4950"]||c.amenities["4951"]||c.amenities["2045"],c.rollawayBedding=c.amenities["2044"]||c.amenities["4307"],c.cribBeddingAndRollawayBedding=c.cribBedding&&c.rollawayBedding)}catch(f){a.setDefaultErrorMessage(),require("logger",function(a){a.logError("ajaxRoomsAndRates",f)})}})},setDefaultErrorMessage:function(){this.errors.set({availabilityErrors:[{messageKey:"defaultMessage"}]})},url:function(){var a=l.omit({token:b.token,brandId:b.hotelBrandId,isVip:b.isVIPHotel,chid:b.cacheID,mctc:this.generateMCTCParam()},function(a){return void 0===a});return"/api/infosite/"+b.hotelId+"/getOffers?"+h.param(a,!0)+"\x26"+t.serializeToQuery()},generateMCTCParam:function(){if(!this.hasSentMCTC)return this.hasSentMCTC=!0,-1===b.marketChannel?void 0:b.marketChannel},adaptEtp:function(a,b){var c=a.rooms;a.hasDeposit=!1;for(var d=0;d<c.length;d++)for(var f=c[d].offers,e=0;e<f.length;e++)if(f[e].paymentChoiceAvailable)for(var g=0;g<f.length;g++)e!==g&&f[e]&&f[e].ratePlanCode===f[g].ratePlanCode&&(!f[g].payLater&&f[e].payLater||f[g].payLater===f[e].payLater&&"MERCHANT"===f[g].offerType)&&(!0!==b&&(f[e].price&&f[e].price.displayDepositAmount&&!f[e].showETPDepositChoice?(f[g]=f[e],a.hasDeposit=!0):f[e].price&&f[e].price.displayDepositAmount?(f[g].depositOffer=f[e],f[e].areCurrenciesDifferent=f[e].currencyPosa!==f[e].currencyPosu,a.hasDeposit=!0,null===f[g].depositOffer.currencyPosu&&(f[g].depositOffer.currencyPosu=f[g].depositOffer.currencyPosa)):(f[g].payLaterOffer=f[e],null===f[g].payLaterOffer.currencyPosu&&(f[g].payLaterOffer.currencyPosu=f[g].payLaterOffer.currencyPosa))),b||f[g].loyaltyBurnedPrice||(f[g].bestOffer=this.getBestOffer(f[g],f[e])),f[g].roomIndex=d,f[e].isFeaturedOffer&&(f[g].isFeaturedOffer=!0),f.splice(e,1),c[d].offerCount-=1)},getBestOffer:function(a,b){var c=this.compareOffers(a,b);return 1!==c&&0>=c?a:b},compareOffers:function(a,b){var c=function(a){return!(a&&a.price&&a.price.price)||a.exceedsMaxGuests||a.exceedsMaxAdults};return c(a)&&c(b)?0:c(a)?1:c(b)?-1:a.price.price-b.price.price},isAmenitiesExist:function(a,b){if(a&&b)for(var c=0;c<b.length;c++)if(a.amenities[b[c].toString()])return!0;return!1},isAmenitiesExistEx:function(a,b,c,d){return this.isAmenitiesExist(a,c)||this.isAmenitiesExist(b,d)},fixPrices:function(a){if(a){var b=parseFloat(a.unformattedTotalPrice);a.totalPrice=l.isNumber(b)&&!isNaN(b)?b:void 0}},adaptRoomThumbnails:function(a){if(a)for(var b=0;b<a.length;b++)a[b].thumbnailUrl&&(a[b].thumbnailUrl=a[b].thumbnailUrl.replace("_t","_n"));return a},adaptOffers:function(a,c){var f=this,l={ts:c,isThereABookableOffer:!1,isHotelSoldOut:!!a.hotelSoldOut,fromStayDate:a.fromStayDate,toStayDate:a.toStayDate,formattedFromStayDate:a.formattedFromStayDate,formattedToStayDate:a.formattedToStayDate,numOfNightsRestriction:a.numOfNightsRestriction,showExcludeTaxMessage:a.showExcludeTaxMessage,showNoRefundIcon:a.showNoRefundIcon,rooms:[],displayExpediaRewardsColumn:a.loyaltyData&&a.loyaltyData.hasLoyaltyEarnings,descripColspan:a.loyaltyData&&a.loyaltyData.hasLoyaltyEarnings?5:4,loyaltyTier:a.loyaltyData&&a.loyaltyData.tier,displayQualifyingNights:a.displayQualifyingNights,isVipAccess:e.isVipAccess,displayTaapContent:d.displayTaapContent,taapCommission:{esr:d.taapCommissions.ESR,eem:d.taapCommissions.EEM,gds:d.taapCommissions.GDS},hasRoomPhotos:!1,showTaapDynamicCommissions:1===g[10883]};h.each(a.offers||[],function(c,d){f.fixPrices(d.price);var k=h.grep(l.rooms,function(a){return a.roomTypeCode===d.roomTypeCode});0===k.length?(k=h.grep(e.rooms,function(a){return a.roomTypeCode===d.roomTypeCode}),0<k.length?(l.rooms.push(k[0]),k=l.rooms[l.rooms.length-1]):(k={name:d.roomName},l.rooms.push(k)),k.offers=[]):k=k[0];d.checkInDate=a.travelerData.chkin;d.checkOutDate=a.travelerData.chkout;d.maxChildren=k.maxChildren=k.maxChildren||d.maxChildren;d.maxGuests=k.maxGuests=k.maxGuests||d.maxGuests;k.maxOccupancyValid=0<d.maxGuests&&0<d.maxAdults;k.isMaxGuestsSingular=1===d.maxGuests;k.isMaxChildrenSingular=1===d.maxChildren;d.showNoRefundIcon=l.showNoRefundIcon;d.showExcludeTaxMessage=l.showExcludeTaxMessage;d.isGDS="PEGASUS"===d.offerType||"WORLDSPAN"===d.offerType;d.cancellationMsg_1=d.outsideWindowPrice&&d.nonRefundableInsideWindow&&d.isGDS;d.cancellationMsg_1_v2=d.outsideWindowPrice&&d.nonRefundableInsideWindow&&!d.isGDS;d.cancellationMsg_2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2<d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_2_v2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2<d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_3=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2===d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_3_v2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2===d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_4=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&0<d.insideWindowPenaltyNightCount&&2>d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_4_v2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&0<d.insideWindowPenaltyNightCount&&2>d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_5=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&0<d.insideWindowPenaltyPercentage&&d.isGDS;d.cancellationMsg_5_v2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&0<d.insideWindowPenaltyPercentage&&d.isGDS;d.cancellationMsg_6=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&(0>d.insideWindowPenaltyPercentage||0===d.insideWindowPenaltyPercentage)&&d.isGDS;d.cancellationMsg_6_v2=d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&(0>d.insideWindowPenaltyPercentage||0===d.insideWindowPenaltyPercentage)&&!d.isGDS;d.cancellationMsg_7=!d.outsideWindowPrice&&d.nonRefundableInsideWindow&&d.isGDS;d.cancellationMsg_7_v2=!d.outsideWindowPrice&&d.nonRefundableInsideWindow&&!d.isGDS;d.cancellationMsg_8=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2<d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_8_v2=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2<d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_9=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2===d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_9_v2=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&2===d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_10=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&0<d.insideWindowPenaltyNightCount&&2>d.insideWindowPenaltyNightCount&&d.isGDS;d.cancellationMsg_10_v2=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&0<d.insideWindowPenaltyNightCount&&2>d.insideWindowPenaltyNightCount&&!d.isGDS;d.cancellationMsg_11=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&
0<d.insideWindowPenaltyPercentage&&d.isGDS;d.cancellationMsg_11_v2=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&0<d.insideWindowPenaltyPercentage&&d.isGDS;d.cancellationMsg_12=!d.outsideWindowPrice&&!d.nonRefundableInsideWindow&&(0>d.insideWindowPenaltyNightCount||0===d.insideWindowPenaltyNightCount)&&(0>d.insideWindowPenaltyPercentage||0===d.insideWindowPenaltyPercentage);d.cancellationMsg_13=d.refundable&&d.nonRefundableInsideWindow&&d.isGDS;"undefined"!==typeof d.amenities&&"undefined"!==typeof k.amenities&&(d.breakfastType_1=f.isAmenitiesExistEx(k,d,[2111,2085,4363,2102],[512,2111,2085,4363,1,2102]),d.breakfastType_2=!d.breakfastType_1&&f.isAmenitiesExistEx(k,d,[2207],[2207,67108864]),d.breakfastType_3=!d.breakfastType_1&&!d.breakfastType_2&&f.isAmenitiesExistEx(k,d,[2206],[33554432,2206]),d.breakfastType_4=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&f.isAmenitiesExistEx(k,d,[2194,2193],[8192,2194,4096,2193]),d.breakfastType_5=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&!d.breakfastType_4&&f.isAmenitiesExistEx(k,d,[2205,2103,2105,2104,2001],[1073742786,16777216,2205,2,2103,8,2105,4,2104,2001]),d.breakfastType_6=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&!d.breakfastType_4&&!d.breakfastType_5&&f.isAmenitiesExist(k,[3969,4647,4651]),d.breakfastType_7=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&!d.breakfastType_4&&!d.breakfastType_5&&!d.breakfastType_6&&f.isAmenitiesExist(k,[4646]),d.breakfastType_8=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&!d.breakfastType_4&&!d.breakfastType_5&&!d.breakfastType_6&&!d.breakfastType_7&&f.isAmenitiesExist(k,[4648,4649,4650]),d.breakfastType_9=!d.breakfastType_1&&!d.breakfastType_2&&!d.breakfastType_3&&!d.breakfastType_4&&!d.breakfastType_5&&!d.breakfastType_6&&!d.breakfastType_7&&!d.breakfastType_8&&f.isAmenitiesExistEx(k,d,[1073742857],[1073742857]),d.freeBreakfast=d.breakfastType_1||d.breakfastType_2||d.breakfastType_3||d.breakfastType_4||d.breakfastType_5||d.breakfastType_6||d.breakfastType_7||d.breakfastType_8||d.breakfastType_9,d.freeParking=f.isAmenitiesExistEx(k,d,[2109,2011,3861,4449,4447,4445,4443,2195,3863],[128,2109,2011,3861,4449,4447,4445,4443,2195,3863,16384]),d.freeInternet=f.isAmenitiesExistEx(k,d,[2192,4347,2403,2191,4345,2405,2407,4154],[2192,2048,4347,2403,1024,1073742787,2191,4345,2405,2407,4154]),d.foodBeverageCredit=f.isAmenitiesExist(d,[64,2108]),d.freeAirportParking=f.isAmenitiesExist(d,[256,2110]),d.freeAirportShuttle=f.isAmenitiesExist(d,[32768,2196]),d.freeRoomUpgrade=f.isAmenitiesExist(d,[65536,2197]),d.resortCreditIncluded=f.isAmenitiesExist(d,[131072,2198]),d.welcomeGiftUponArrival=f.isAmenitiesExist(d,[262144,2199]),d.spaCredit=f.isAmenitiesExist(d,[524288,2200]),d.golfCredit=f.isAmenitiesExist(d,[1048576,2201]),d.VIPLineAccessToNightclub=f.isAmenitiesExist(d,[2097152,2202]),d.freeSkiLiftTicketAndRental=f.isAmenitiesExist(d,[8388608,2204]),d.slotPlay=f.isAmenitiesExist(d,[268435456,2234]),d.casinoCredit=f.isAmenitiesExist(d,[536870912,2235]),d.matchPlay=f.isAmenitiesExist(d,[1073741824,2236]),d.DisneyTickets=f.isAmenitiesExist(d,[1073742617]),d.spaAccess=f.isAmenitiesExist(d,[1073742618]),d.availableAmenities={},d.availableAmenities.buffet2for1=f.isAmenitiesExist(d,[2203]),d.availableAmenities.drinksHorsDoeuvres=f.isAmenitiesExist(d,[1073742552]),d.availableAmenities.freeDinner=f.isAmenitiesExist(d,[2107]),d.availableAmenities.freeLunch=f.isAmenitiesExist(d,[2106]),d.availableAmenities.freeWelcomeDrink=f.isAmenitiesExist(d,[1073742551]),d.availableAmenities.fullKitchen=f.isAmenitiesExist(d,[2208]),d.availableAmenities.freeOneWayAirportTransfer=f.isAmenitiesExist(d,[1073742859]),d.availableAmenities.freeReturnAirportTransfer=f.isAmenitiesExist(d,[1073742860]),d.availableAmenities.gameDrivePerNight1=f.isAmenitiesExist(d,[1073742863]),d.availableAmenities.gameDrivePerNight2=f.isAmenitiesExist(d,[1073742862]),d.availableAmenities.complimentaryGreenFees=f.isAmenitiesExist(d,[1073742858]),d.availableAmenities.freeWaterParkPasses=f.isAmenitiesExist(d,[1073742861]),d.availableAmenities.earlyCheckIn=f.isAmenitiesExist(d,[1073743274]),d.availableAmenities.lateCheckOut=f.isAmenitiesExist(d,[1073743275]),d.availableAmenities.freeMassageIncluded=f.isAmenitiesExist(d,[1073743286]),d.availableAmenities.freeMinibar=f.isAmenitiesExist(d,[1073743287]),d.availableAmenities.skiPassIncluded=f.isAmenitiesExist(d,[1073743288]),d.displayNewAmenities=b.isFrenchPOSa||1===g[10532],d.noBreakfastInfo=!1,d.breakfastIncluded=!1,d.breakfastSurcharge=!1,d.noInternetInfo=!1,d.newFreeInternet=!1,d.InternetSurcharge=!1,d.displayNewAmenities&&(d.freeBreakfast||(d.breakfastIncluded=e.isBreakfastIncludedAtProperty,d.breakfastSurcharge=e.isBreakfastSurchargeAtProperty,d.breakfastIncluded||d.breakfastSurcharge||(d.noBreakfastInfo=!0)),d.freeInternet||(d.newFreeInternet=e.isNewFreeInternetAtProperty,d.InternetSurcharge=f.isAmenitiesExistEx(k,d,[4155,4346,4348],[2404,2406,2408,1073742908])||e.isInternetSurchargeAtProperty,d.newFreeInternet||d.InternetSurcharge||(d.noInternetInfo=!0))));if("undefined"!==typeof e.ratePlans)for(var p=0;p<e.ratePlans.length;p++)e.ratePlans[p].ratePlanCode===d.ratePlanCode&&(d.hasRatePlanDescription=!0,d.ratePlanDescription=e.ratePlans[p].ratePlanDescription);d.brandName=f.brandName;d.displayQualifyingNights=l.loyaltyTier&&l.displayQualifyingNights;d.displayQualifyingNights&&(d.isRewardsGoldTierUser=-1!==l.loyaltyTier.indexOf("gold",l.loyaltyTier.length-4),d.multipleNights=1<d.numberOfNights,-1!==l.loyaltyTier.indexOf("blue",l.loyaltyTier.length-4)?(d.totalNightsForTierUpgrade=7,d.nextTier=b.silverBranded):(d.totalNightsForTierUpgrade=15,d.nextTier=b.goldBranded));k.photos=f.adaptRoomThumbnails(k.photos);!1===l.hasRoomPhotos&&k.photos&&0<k.photos.length&&k.photos[0].thumbnailUrl&&(l.hasRoomPhotos=!0);k.offers.push(d);k.offerCount=k.offers.length;d.displayExpediaRewards=d.bookable&&l.displayExpediaRewardsColumn;d.displayHPG=1===b.siteId;d.isIdentifiedUser=b.isIdentifedUser;d.displayTaapContent=d.bookable&&l.displayTaapContent;d.showTaapDynamicCommission=l.showTaapDynamicCommissions;d.isTaap={ESR:"MERCHANT"===d.offerType,EEM:"VENERE"===d.offerType||"DIRECT_AGENCY"===d.offerType||"JUMBOTOURS"===d.offerType,GDS:"PEGASUS"===d.offerType||"WORLDSPAN"===d.offerType};d.commission={ESR:l.taapCommission.esr,EEM:l.taapCommission.eem,GDS:l.taapCommission.gds};d.isVipAccess=l.isVipAccess;d.showRoomsLeftMessage&&(d.isNumberOfRoomsLeftSingular=1===d.numberOfRoomsLeft);d.nightlyRates&&(d.showNightlyRates=0<d.nightlyRates.length);"undefined"!==typeof d.drrExpirationSecs&&(d.hasDrrExpiration=600<d.drrExpirationSecs||600===d.drrExpirationSecs,d.drrExpirationSecsText=d.drrExpirationSecs.toString());d.drrExpiration_1=(600<d.drrExpirationSecs||600===d.drrExpirationSecs)&&7200>d.drrExpirationSecs;d.drrExpiration_2=(7200<d.drrExpirationSecs||7200===d.drrExpirationSecs)&&172800>d.drrExpirationSecs;d.drrExpiration_3=(172800<d.drrExpirationSecs||172800===d.drrExpirationSecs)&&345600>d.drrExpirationSecs;d.drrExpiration_4=345600<d.drrExpirationSecs||345600===d.drrExpirationSecs;d.showTonightOnlyBadge=d.tonightOnlyDRRPresent&&1===g[9366];d.showTaapAirAttach=d.bookable&&a.airAttach&&a.taapPackageRateEnabled&&l.showTaapAirAttach;d.mandatoryFees={isIncluded:0<d.includedFees.totalAmount,isExcluded:0<d.excludedFees.totalAmount,isFullBundle:0<d.includedFees.totalAmount&&0===d.excludedFees.totalAmount,isUsePOSuCurrency:d.includedFees.usePOSuCurrency};d.mandatoryFees.isUnbundlePOS=!d.mandatoryFees.isFullBundle&&d.mandatoryFees.isUsePOSuCurrency;d.mandatoryFees.isUnbundle=!(d.mandatoryFees.isFullBundle||d.mandatoryFees.isUnbundlePOS);d.mandatoryFees.isShowMandatoryFee=d.includedFees.showMandatoryFee&&(d.mandatoryFees.isIncluded||d.mandatoryFees.isExcluded);d.isResortFeeEnabled=b.isResortFeeEnabled&&!d.mandatoryFees.isShowMandatoryFee;d.displayCityTax=b.isCityTaxExclusionEnabled&&
null!==d.taxesAndFeesNotIncludedInPrice;d.bestOffer=d;d.valueAdd&&d.valueAdd.categoryId&&(d.valueAdd.showAfrToolTip=s.isAFRCategory(d.valueAdd.categoryId))});f.adaptEtp(l,k.suppressETP);f.sortAndIndex(l);return l},getLeadOffer:function(a){try{var b=a.rooms[0].offers[0];if(!b.exceedsMaxChildren&&!b.exceedsMaxGuests&&b.nightlyRates)return b}catch(c){}},parse:function(a){try{var b=(new Date).getTime();a.omnitureData&&r.initOmniture({omnitureProperties:a.omnitureData});var c=this.adaptOffers(a,b);this.loyaltyData.set(a.loyaltyData);this.errors.set({availabilityErrors:a.availabilityErrors,validationErrors:a.validationErrors,ts:b});a.airAttach?this.airAttach.set(a.airAttach):this.airAttach.clear();var d=this.getLeadOffer(c);d?this.leadOffer.set(d):this.leadOffer.clear();return c}catch(f){this.trigger("error"),q.logError("offerResponseModel:parse",f)}},sortAndIndex:function(a){var b=a.rooms,c=1,d=0,f=this.compareOffers;0<b.length&&(l.each(b,function(a){a.offers&&a.offers.length&&(a.offers.sort(f),a.minPrice=!a.offers[0].price||a.offers[0].exceedsMaxGuests||a.offers[0].exceedsMaxAdults?void 0:a.offers[0].price.price);a.showBestValue=!1;a.isSingleOfferRoom=!1}),b=b.sort(function(a,b){if(a.minPrice||b.minPrice){if(!a.minPrice)return 1;if(!b.minPrice)return-1}else return 0;return a.minPrice-b.minPrice}),a.isAnyOfferSoldOut=!1,a.isThereABookableOffer=!1,l.each(b,function(b){l.each(b.offers,function(b,f){b.optionIndex=f+1;b.bookButtonIndex=c++;b.offerIndex=d++;b.soldOut&&(a.isAnyOfferSoldOut=!0);b.bookable&&(a.isThereABookableOffer=!0)})}),b[0].offers[0].isFeaturedOffer=!0,b[0].showBestValue=!0,b[0].isSingleOfferRoom=1===b[0].offerCount)}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("afrData",function(){var e=[36,44];return{isAFRCategory:function(h){return-1<e.indexOf(h)?!0:!1}}});define("meta",["jquery","metaData","uitk"],function(e,h,c){return{run:function(){if(("5"===h.metaChannel||"15005"===h.metaChannel)&&h.isTrivagoExpend||"9"===h.metaChannel)e("body").one(c.clickEvent,function(){window.moveTo(1,1);window.resizeTo(screen.width-20,screen.height-20)})}}});define("competitors","competitorsData jquery uitk infosite infoSitePpaModel offersResponseModel experiments infositeData urlModel".split(" "),function(e,h,c,b,d,l,g,f,a){var k=a.getSingleton(),p=l.getSingleton(),n=h.extend(new b.DeprecatedModule,e);n.makeInfositeApiServiceCall=!1;n.makeIntentmediaServiceCall=!1;n.loadCompetitors=function(){if(1===g[8100])try{n.expediaPrice=parseInt(p.leadOffer.get("price").price,10)}catch(a){}else n.expediaPrice=parseInt(h(".lead-price .price").text().slice(1).replace(",",""),10);if(k&&!k.isDateless()&&!isNaN(n.expediaPrice)){var b=f.hotelId,d=k.getCheckIn(),e=k.getCheckOut(),l=k.getTotalChildren(),m=k.getTotalAdults();h.ajax({url:"/api/infosite/getCompetitors?hotelId\x3d"+b+"\x26chkIn\x3d"+d+"\x26chkOut\x3d"+e+"\x26numAdults\x3d"+m+"\x26numChildren\x3d"+l+"\x26ep\x3d"+n.expediaPrice+"\x26token\x3d"+f.token,dataType:"json",async:!0,success:function(a){if(a&&a.success&&a.competitorList&&0<a.competitorList.length){n.data=a.competitorList;for(a=0;a<n.data.length;a++)n.data[a].trackingCompetitorName=n.data[a].competitorName.replace(" ","");c.publish("competitor.success")}else c.publish("competitor.failure")},error:function(){c.publish("competitor.failure")}})}};n.loadCompetitorsFromIntentmedia=function(){if(0!==g[10842]){if(1===g[8100])try{n.expediaPrice=parseInt(p.leadOffer.get("price").price,10)}catch(a){require("logger",function(b){b.logMessage("leadOffer price is null:",a.message)})}else n.expediaPrice=d.minPrice?d.minPrice:null;if(!isNaN(n.expediaPrice)){var b=f.hotelId,e;d.infoSitePpaModelParam&&(e=d.infoSitePpaModelParam);var k=(new Date).getTime();h.ajax({url:"https://m.intentmedia.net/api/meta/hotels/v2/ad_call"+e,dataType:"jsonp",type:"GET",timeout:3500,async:!0,jsonpCallback:"ppaDataCallback",success:function(a){a&&((a=f.intentmediaGuid=a.guid)&&"string"===typeof a?(k=(new Date).getTime(),h.ajax({url:"https://m.intentmedia.net/api/meta/hotels/v2/impressions?uuid\x3d"+a+"\x26rendered\x3dtrue\x26synchronous\x3dtrue",dataType:"html",timeout:3500,success:function(a){try{var d=window.JSON.parse(a);(f.intentmediaImpressions=d)&&d.impressions&&d.impressions.hasOwnProperty(b)?(n.html=d.impressions[b].html.replace("{PUBLISHER_PRICE}",n.expediaPrice.toString()),c.publish("intentmedia.impression.success"),require("dctk/clientLogging",function(a){a.logTrxEvent("intentMediaImpressionCall",["impressionFilledRatePercentage\x3d100","timeElapsed\x3d"+((new Date).getTime()-k)])})):(c.publish("intentmedia.impression.failure"),require("dctk/clientLogging",function(a){a.logTrxEvent("intentMediaImpressionCall",["impressionFilledRatePercentage\x3d0","timeElapsed\x3d"+((new Date).getTime()-k)])}))}catch(e){c.publish("intentmedia.impression.failure"),require("dctk/clientLogging",function(a){a.logTrxEvent("intentMediaImpressionCall",["timeElapsed\x3d"+((new Date).getTime()-k)])})}},error:function(){c.publish("intentmedia.impression.failure");require("dctk/clientLogging",function(a){a.logTrxEvent("intentMediaImpressionCall",["timeElapsed\x3d"+((new Date).getTime()-k)])})}}),k=(new Date).getTime(),h.ajax({url:"https://m.intentmedia.net/api/meta/hotels/v2/reference_prices?uuid\x3d"+a+"\x26hotel\x3d"+b+","+n.expediaPrice,async:!0,error:function(){require("dctk/clientLogging",function(a){a.logTrxEvent("intentMediaReferencePriceCall",["timeElapsed\x3d"+((new Date).getTime()-k)])})}})):require("logger",function(a){a.logMessage("intentmedia report price call:","intentmedia guid unavailable")}))},error:function(){require("dctk/clientLogging",function(a){a.logTrxEvent("intentmedia.ad_call",["timeElapsed\x3d"+((new Date).getTime()-k)])})}})}}};n.run=function(){n.runExperiments();if(n.makeInfositeApiServiceCall)if(1===g[8100])p.on("sync",n.loadCompetitors);else n.loadCompetitors();else if(n.makeIntentmediaServiceCall)if(1===g[8100])p.on("sync",n.loadCompetitorsFromIntentmedia);else n.loadCompetitorsFromIntentmedia()};return n});
define("googleTranslateSingle",["jquery","logger","dctk/dctk","infositeData"],function(e,h,c,b){var d={},l=function(f,l){var n=f.data("review-id"),q=f.find("h3").html(),r=f.find(".translate-text").html(),s=f.find(".translate-pros").html(),t=f.find(".translate-cons").html(),v=f.find(".translate-loc").html(),m=g(n);e.isEmptyObject(m)?(c.trackEvent("o","Google Translate Reviews",{prop16:"HOT.HIS.SINGLE.REV.TRA",eVar28:"HOT.HIS.SINGLE.REV.TRA"},"event102\x3d"+((q||"").length+(r||"").length+(s||"").length+(t||"").length+(v||"").length)),e.ajax({url:"/ugc/urs/api/hotelreview/translate/"+n+"/"+b.locale.substring(0,2),method:"GET",dataType:"json"}).done(function(b){e.isEmptyObject(b)||b.hasOwnProperty("exception")?(a(!0,f),h.logMessage("ReviewTranslationStatusError",b)):(b={originalTitle:q,originalText:r,originalPositiveRemarks:s,originalNegativeRemarks:t,originalLocationRemarks:v,translatedTitle:b.Review.title,translatedText:b.Review.reviewText,translatedPositiveRemarks:b.Review.positiveRemarks,translatedNegativeRemarks:b.Review.negativeRemarks,translatedLocationRemarks:b.Review.locationRemarks,originalButtonClicked:!1},d.hasOwnProperty(n)||(d[n]=b),l(b,f))}).fail(function(b,c){a(!0,f);h.logMessage("ReviewTranslationQueryError",c)}).always(function(){f.find(".translate-btn").prop("disabled",!1)})):l(m,f)},g=function(a){return d.hasOwnProperty(a)?d[a]:{}},f=function(a,b){b.hasClass("translate-original")&&(b.find("h3").html(a.translatedTitle),b.find(".translate-text").html(a.translatedText).focus(),b.find(".translate-loc").html(" "+a.translatedLocationRemarks).parent().focus(),b.find(".translate-cons").html(" "+a.translatedNegativeRemarks).parent().focus(),b.find(".translate-pros").html(" "+a.translatedPositiveRemarks).parent().focus(),b.addClass("translate-foreign").removeClass("translate-original"),b.find(".translate-btn").prop("disabled",!1))},a=function(a,b){a&&0===b.find(".translate-error").length?require("handlebars",function(a){b.find(".translate-btn").after(a.templates["review-translate-error-template"]);b.find(".alert-message").focus()}):a||b.find(".translate-error").remove()};return{onTranslateButtonClick:function(b){b=e(b.target).closest("article");b.find(".translate-btn").prop("disabled",!0);a(!1,b);l(b,f)},onOriginalButtonClick:function(a){a=e(a.target).closest("article");var b=g(a.data("review-id"));e.isEmptyObject(b)||(b.originalButtonClicked||(c.trackEvent("o","Google Translate Reviews",{prop16:"HOT.HIS.SINGLE.REV.ORG.SEND",eVar28:"HOT.HIS.SINGLE.REV.ORG.SEND"}),b.originalButtonClicked=!0),a.find("h3").html(b.originalTitle),a.find(".translate-text").html(b.originalText).focus(),a.find(".translate-loc").html(b.originalLocationRemarks).parent().focus(),a.find(".translate-cons").html(b.originalNegativeRemarks).parent().focus(),a.find(".translate-pros").html(b.originalPositiveRemarks).parent().focus(),a.addClass("translate-original").removeClass("translate-foreign"))}}});define("maps",["jquery","uitk","infosite","mapConfig","infositeData"],function(e,h,c,b,d){function l(){k.close();e("button.link-to-rooms").click()}var g={},f=!1,a=e(".static-map"),k,p;a.parent().css("background-image","url("+a.attr("src")+")");g.renderMap=function(){k=h.map.create({configId:"hotel-map"},p);e("#map-overlay-background").addClass("modal-background modal-dismiss active map-close");k.mapHtml.find(".legend").attr("tabindex",0);h.utils.focusElement(k.mapHtml.find("#hotel-map-title"));var a,c;b.config.mockReserveButtonEnabled&&e("button.link-to-rooms").length&&(a=e(b.preGeneratedElements.reserveButtonBelowMap),c=e(b.preGeneratedElements.reserveButtonBelowLegend),k.mapHtml.append(a),k.mapHtml.find(".map-document").find("#legend").prepend(c),e(".map-canvas").addClass("with-reserve-button"),a.click(l),c.click(l))};g.loadAndRenderMap=function(){p=e(this);f?g.renderMap():h.map.loadApi()};g.close=function(a,b){e("#map-overlay-background").removeClass("modal-background modal-dismiss active map-close");c.track("Map.CloseMap",b.mapHtml[0]);setTimeout(function(){p&&p[0]&&p[0].focus()},100)};g.run=function(){h.map.config=b.config;h.map.data=b.data;e("body").on(h.clickEvent,".map-link",g.loadAndRenderMap);e(".show-map-poi").on(h.clickEvent,".poi-map-link",g.loadAndRenderMap).show();h.subscribe("mapLoaded",function(){f=!0;g.renderMap()});"v-map"!==d.hashTag&&"#map"!==window.location.hash||g.loadAndRenderMap();h.subscribe("map.close",g.close);e(".hotel-overview").on(h.clickEvent,".toggle-trigger",function(){c.track("Overview.Toggle",this)});e(".map-link, .static-map-link, .poi-map-link").on("click",function(a){a.preventDefault()})};return g});
define("recommendations","recommendationsConfig jquery handlebars infosite infositeData logger uitk experiments".split(" "),function(e,h,c,b,d,l,g,f){function a(a){var b,c,d={hotels:[]};for(b=0;b<a.length;b++)if(a[b].isSponsored){c=a;if(!(2>c.length||1===b)){var f=c[b];c[b]=c[1];c[1]=f}break}for(b=0;b<Math.min(4,a.length);b++)c=n.adaptModel(a[b]),d.hotels.push(c);return d}var k=d.isSoldOut,p=d.isMutedHotel,n={},q=f[10531];n.recomendUrl=e.ajaxURL;n.adaptModel=function(a){var b=a.urlToHotelInfosite,c=a.travelAdImpressionTrackingUrl;a.isSponsored&&(b=a.travelAdClickRedirectInfositeUrl);var d;d="undefined"!==typeof a.averagePriceNoDecimal?e.showTotalPrice?decodeURIComponent(a.totalPriceNoDecimal):decodeURIComponent(a.averagePriceNoDecimal):e.showTotalPrice?decodeURIComponent(a.totalPriceNoDecimal):decodeURIComponent(a.averagePrice);b={hotelName:decodeURIComponent(a.hotelName),urlToHotelInfosite:b,starRating:a.starRating.replace(".","-"),hasThumbnail:"undefined"!==typeof a.urlToThumbnail&&0<a.urlToThumbnail.length,urlToThumbnail:a.urlToThumbnail,price:d,sponsored:a.isSponsored,travelAdsExposureUrl:c,crossOutPrice:decodeURIComponent(a.crossOutPrice),showCrossOutPrice:a.crossOutPriceValue>a.averagePriceValue&&!a.isSponsored};a=decodeURIComponent(a.localizedHotelName);e.showDualHotelName&&a!==b.hotelName&&(b.localizedHotelName=a);return b};n.render=function(a){var b=c.templates["recommendations-template"](a);h(".recommendations-title").removeClass("hidden");h(".recommendations-grid").removeClass("hidden").html(b);g.publish("infosite.recommendationsRendered",a)};n.handleResponse=function(b){var c;0!==b.errorCode?"undefined"!==typeof n.trackRecommendationsError&&n.trackRecommendationsError():b&&b.recommendations&&0!==b.recommendations.length?(c=b.recommendations[0].items.hotels,0===b.errorCode&&"undefined"!==typeof c&&0<c.length&&("undefined"!==typeof n.preProcessData&&(c=n.preProcessData(c)),c=a(c),"undefined"!==typeof n.postProcessData&&(c=n.postProcessData(c,b)),"undefined"!==typeof n.preRender&&n.preRender(c),n.render(c),"undefined"!==typeof n.postRender&&n.postRender(c))):"undefined"!==typeof n.trackEmptyRecommendationsError&&n.trackEmptyRecommendationsError()};n.handleAWSResponse=function(a){if(!a)return{};(a=a.response)&&0<a.length&&(a=n.processAWSData(a));n.render(a)};n.processAWSData=function(a){var b,c,d={hotels:[]};for(b=0;b<Math.min(4,a.length);b++)c=n.adaptAWSModel(a[b]),d.hotels.push(c);return d};n.adaptAWSModel=function(a){var b="/h"+a.hotelId+".Hotel-Information?chkin\x3d"+e.startDateFormatted+"\x26chkout\x3d"+e.endDateFormatted+"\x26rm1\x3da2#rooms-and-rates",c=a.starRating.toString();1===c.length&&(c+=".0");return{hotelName:decodeURIComponent(a.name),urlToHotelInfosite:b,starRating:c.replace(".","-"),hasThumbnail:"undefined"!==typeof a.imageUrl&&0<a.imageUrl.length,urlToThumbnail:"https://media.expedia.com"+a.imageUrl,price:decodeURIComponent(a.price),crossOutPrice:decodeURIComponent(a.crossOutPrice),showCrossOutPrice:a.crossOutPrice>a.price}};n.getRecommendations=function(){var a=(new Date).getTime();1===q?h.ajax({type:"GET",url:e.awsAjaxURL,jsonp:"callback",dataType:"jsonp",success:function(b){n.handleAWSResponse(b);1===d.siteId&&n.log(["recResponseTime\x3d"+((new Date).getTime()-a),"awsEndpoint\x3d"+q])}}):h.ajax({url:n.recomendUrl,dataType:"json",success:function(b){n.handleResponse(b);n.log(["recResponseTime\x3d"+((new Date).getTime()-a),"awsEndpoint\x3d"+q])},error:function(){"undefined"!==typeof n.trackRecommendationsError&&n.trackRecommendationsError()}})};n.log=function(a){l.logTrxEvent("InfositeRecommender",a)};n.handleInactiveResponse=function(b){b&&b.hotelModels&&0!==b.hotelModels.length&&(b=b.hotelModels,"undefined"!==typeof b&&0<b.length&&("undefined"!==typeof n.preProcessData&&(b=n.preProcessData(b)),b=a(b),"undefined"!==typeof n.postProcessData&&(b=n.postProcessData(b)),"undefined"!==typeof n.preRender&&n.preRender(b),n.render(b),"undefined"!==typeof n.postRender&&n.postRender(b)))};n.getInactiveRecommendations=function(){h.ajax({url:"Hotel-Recommender-Ajax?scenario\x3dInfosite\x26rule\x3dpersona-region-item-xsell\x26itemType\x3d2\x26maxCount\x3d20\x26reqRetItemType\x3d0\x26itemId\x3d"+e.regionId+"\x26travellersInfo\x3d1\x26startDate\x3d\x26endDate\x3d\x26personaId\x3d0\x26code\x3d1",dataType:"json",success:n.handleInactiveResponse})};n.showRecommendations=function(){if(k||p)n.getRecommendations();else if(d.isInformationOnlyEnabled)n.getInactiveRecommendations();else h(window).one("scroll",n.getRecommendations)};n.run=function(){d.isPackageInfosite||e.ajaxURL&&n.showRecommendations()};return n});define("airAttach",["airAttachModel","infosite","jquery","handlebars","uitk"],function(e,h,c,b,d){function l(a){return(10>a?"0":"")+a}function g(a,b,c){var d=1E3*c;a=Math.floor(a);a-=1;0>a||(b.call(void 0,a),setTimeout(function(){g(a,b,c)},d))}function f(a,d,f){c(".air-attachment-days").addClass("hidden");c(".air-attachment-timer").addClass("hidden");c(".air-attachment-expires").removeClass("hidden");c(".air-attachment-expires-long-date").html(a).removeClass("hidden");a={expiresLongDate:a,showDays:f,totalDays:d};c("#air-attachment-inner .air-attachment-banner-long-date").html(b.templates["air-attachment-banner-long-date"](a));c("#air-attachment-inner .air-attachment-banner-long-date").removeClass("hidden")}var a={renderTimer:function(a,d,f,e){var g={totalDays:a,hours:l(d),minutes:l(f),seconds:l(e)};c("#air-attachment-timer-placeholder").html(d+":"+l(f)+":"+l(e));c("#air-attachment-inner .air-attachment-days").hide();c("#air-attachment-inner .air-attachment-timer").show();c("#air-attachment-inner .air-attach-days").hide();c("#air-attachment-inner .air-attach-timer").show();c(".air-attachment-timer-banner-placeholder").html(b.templates["air-attachment-banner-timer"](g));c(".air-attachment-timer-placeholder").each(function(a,d){c(d).html(b.templates["air-attachment-flat-timer"](g))});c(".air-attachment-days").each(function(a,b){c(b).hide()});c(".air-attachment-timer").each(function(a,b){c(b).show()});c(".air-attachment-timer").removeClass("hidden")},run:function(){if(e.isEnabled)if(e.enableOfferWindowTillTravel){var b=new Date(e.expiresDateWithMilliseconds),c=Math.ceil(e.remainingTime/86400),b=d.utils.createLocalizedDate(b,d.locale);f(b.longDate(),c,e.enableShowHotmipWindowDays)}else g(e.remainingTime,function(b){var c=Math.floor(b/86400),d=Math.floor(b/3600)%24;b%=3600;a.renderTimer(c,d,Math.floor(b/60),Math.floor(b%60))},1)}};return a});define("errorModel",["backbone"],function(e){return e.Model.extend({hasAvailabilityErrors:function(){var e=this.get("availabilityErrors");return e&&e.length?!0:!1},hasValidationErrors:function(){var e=this.get("vaildationErrors");return e&&e.length?!0:!1}})});define("feedback",["feedbackData","infosite","jquery"],function(e,h,c){function b(b){require("logger",function(c){c.logError("feedback",b)})}return c.extend({},{run:function(){c(document).on("click",".feedback-link",function(c){var h="width\x3d634,height\x3d295,screenX\x3d"+(screen.width-634)/2+",screenY\x3d"+(screen.height-295)/2+",resizable\x3dyes,copyhistory\x3dyes,scrollbars\x3dyes",g;try{g=e().url}catch(f){b(f)}if(g&&-1===g.indexOf("secure.opinionlab.com"))window.open(g,"",h);else try{window.OpinionLab_FB.O_LC()}catch(a){b(a)}c.preventDefault()})}})});
define("googleAnalytics",["infosite","hotelInfo","searchData","googleAnalyticsData"],function(e,h,c,b){e={};var d=window._gaq=window._gaq||[];e.run=function(){if("undefined"!==typeof b.account){d.push(["_setAccount",b.account]);d.push(["_setDomainName",b.domainName]);d.push(["_addIgnoredRef",b.ignoredRef]);d.push(["_setCustomVar",1,"Hotel ID",h.id,3]);d.push(["_setCustomVar",4,"LOB","Hotels",2]);b.isAnonymize&&d.push(["_gat._anonymizeIp"]);d.push(["_set","title",b.analyticsLogger]);!c.isDatelessSearch&&c.isLastSearchDateless&&d.push(["_trackEvent","Visitor Status","Dated","Infosite Page",void 0,!0]);d.push(["_trackPageview"]);var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}};return e});
define("urgency",["jquery","uitk","dctk"],function(e,h,c){function b(b,a){return"undefined"===typeof b||"undefined"===typeof b.responseStatusCode||0!==b.responseStatusCode?!1:"function"===typeof a?a(b):!0}function d(b,a,c,d){var e;a=a.split(",");for(var l=0;l<a.length;l++)e=a[l],b.hasOwnProperty(e)&&b[e]&&(e=b[e],"function"===typeof e.responseValidator&&e.topic&&(e.responseValidator(c)?h.publish(e.topic,{status:g.statuscodes.SUCCESS_RESPONSE,response:"function"===typeof e.responseExtractor?e.responseExtractor(c):c,src:d}):h.publish(e.topic,{status:g.statuscodes.ERROR_RESPONSE,response:c,src:d})))}function l(b,a,c,d){var e,g;for(e in b)b.hasOwnProperty(e)&&b[e]&&(g=b[e],g.topic&&h.publish(g.topic,{status:d,response:a,src:c}))}var g={statuscodes:{AJAX_FAIL:"URGENCY_AJAX_FAIL",RESPONSE_PARSE_ERROR:"URGENCY_AJAX_RESPONSE_PARSE_ERROR",ERROR_RESPONSE:"ERROR",SUCCESS_RESPONSE:"SUCCESS",INVALID_INPUT:"INVALID_INPUT"},api:{flight:"FlightConsolidatedApi",flightEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/flight",flightTimeout:3E3,region:"RegionTickerApi",regionEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/region",regionTimeout:3E3,hotel:"HotelTickerApi",hotelEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/hotel",hotelTimeout:3E3,lastBooking:"LastBookingService Domain",lastBookingEndpoint:"/LastBooking/elapsedTime",hotelTestEndpoint:"//10.0.17.193:8080/urgencyservice/v1/ticker/hotel",lastBookingTimeout:3E3},utils:{objToStringArray:function(b,a,c){var d=[],e,g;if("object"===typeof b){a="string"===typeof a?a:"";c="number"===typeof c?c:50;for(e in b)b.hasOwnProperty(e)&&(g=b[e],"string"===typeof g||"number"===typeof g||"boolean"===typeof g?d.push((a+e+"\x3d"+g.toString().substring(0,c)).replace(/\.| /g,"")):null!==g&&"object"===typeof g&&(d=d.concat(this.objToStringArray(g,e+"-"))));return d}},ajaxRequest:function(b,a){var d=["api\x3d"+a],h=this;b=e.extend(!0,{dataType:"json",data:{},timeout:3E3,type:"GET"},b);d=d.concat(this.objToStringArray(b,"options-"));return e.ajax({cache:!1,data:b.data,dataType:b.dataType,type:b.type,url:b.url,timeout:b.timeout}).done(function(a,l,r){var s;d=d.concat(h.objToStringArray(r,"xhr-"));if("function"===typeof b.success){try{s="string"===typeof a?e.parseJSON(a):a}catch(t){c.loggingAdapter.logError(g.statuscodes.RESPONSE_PARSE_ERROR,t,d),"function"===typeof b.fail&&b.fail()}b.success(s)}}).fail(function(a,e,l){d.push("callback\x3dfail");d=d.concat(h.objToStringArray(a,"xhr-"));d.push("statusParameter\x3d"+e);d=d.concat(h.objToStringArray(l,"error-"));c.loggingAdapter.logMessage(g.statuscodes.AJAX_FAIL,d);"function"===typeof b.fail&&b.fail()})},getUTCDate:function(b){var a=new Date;b=new Date(b);return"function"!==typeof b.getMonth||isNaN(b.getMonth())?null:0<a.getTimezoneOffset()?(b.setHours(a.getHours()),b.setMinutes(a.getMinutes()),b.setSeconds(a.getSeconds()),a=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds()),a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()):b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear()}},getFlightUrgency:function(d,a){var e=this,g=["api\x3dFlightUrgency"],l,q=function(a){return a&&a.flightTicker&&0!==a.flightTicker.length&&"0"!==a.flightTicker[0].bookingCount?!0:!1},g=g.concat(e.utils.objToStringArray(d,"request-"));if("undefined"!==typeof d.startDate){l=e.utils.getUTCDate(d.startDate);if(null===l){h.publish("flightUrgency:arrive",{status:e.statuscodes.INVALID_INPUT+"Invalid StartDate",response:null,src:a});c.loggingAdapter.logMessage(e.api.flight+": "+e.statuscodes.INVALID_INPUT,g);return}d.startDate=l}if("undefined"!==typeof d.endDate){l=e.utils.getUTCDate(d.endDate);if(null===l){h.publish("flightUrgency:arrive",{status:e.statuscodes.INVALID_INPUT+"Invalid EndDate",response:null,src:a});c.loggingAdapter.logMessage(e.api.flight+": "+e.statuscodes.INVALID_INPUT,g);return}d.endDate=l}e.utils.ajaxRequest({url:e.api.flightEndpoint,timeout:e.api.flightTimeout,dataType:"jsonp",data:d,success:function(d){var f="";b(d,q)?f=e.statuscodes.SUCCESS_RESPONSE:(f=e.statuscodes.ERROR_RESPONSE,g=g.concat(e.utils.objToStringArray(d,"response-")),c.loggingAdapter.logMessage(e.api.flight+": "+e.statuscodes.ERROR_RESPONSE,g));h.publish("flightUrgency:arrive",{status:f,response:d,src:a})},fail:function(b){h.publish("flightUrgency:arrive",{status:e.statuscodes.AJAX_FAIL,response:null,src:a})}},e.api.flight)},getRegionCompression:function(d,a){var e=this,g=["api\x3dRegionCompression"],l=function(a){return a&&a.regionTicker&&0!==a.regionTicker.length&&a.regionTicker[0].regionLevelData?!0:!1},g=g.concat(e.utils.objToStringArray(d,"request-"));e.utils.ajaxRequest({url:e.api.regionEndpoint,timeout:e.api.regionTimeout,dataType:"jsonp",data:d,success:function(d){var f="";b(d,l)?f=e.statuscodes.SUCCESS_RESPONSE:(f=e.statuscodes.ERROR_RESPONSE,g=g.concat(e.utils.objToStringArray(d,"response-")),c.loggingAdapter.logMessage(e.api.region+": "+e.statuscodes.ERROR_RESPONSE,g));h.publish("regionCompression:arrive",{status:f,response:d,src:a})},fail:function(b){h.publish("regionCompression:arrive",{status:e.statuscodes.AJAX_FAIL,response:null,src:a})}},e.api.region)},getHotelPriceTrend:function(d,a){var g=this,l=["api\x3dHotelPriceTrend"],n,q=function(a){return a&&a.hotelTicker&&0!==a.hotelTicker.length&&a.hotelTicker[0].datedPriceTrend?!0:!1};d=e.extend(!0,{type:"datedhotelpricetrends"},d);l=l.concat(g.utils.objToStringArray(d,"request-"));if("undefined"!==typeof d.checkinDate){n=g.utils.getUTCDate(d.checkinDate);if(null===n){h.publish("hotelPriceTrend:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:a});c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,l);return}d.checkinDate=n}if("undefined"!==typeof d.checkoutDate){n=g.utils.getUTCDate(d.checkoutDate);if(null===n){h.publish("hotelPriceTrend:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:a});c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,l);return}d.checkoutDate=n}g.utils.ajaxRequest({url:g.api.hotelEndpoint,timeout:g.api.hotelTimeout,dataType:"jsonp",data:d,success:function(d){var f="";b(d,q)?f=g.statuscodes.SUCCESS_RESPONSE:(f=g.statuscodes.ERROR_RESPONSE,l=l.concat(g.utils.objToStringArray(d,"response-")),c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.ERROR_RESPONSE,l));h.publish("hotelPriceTrend:arrive",{status:f,response:d,src:a})},fail:function(b){h.publish("hotelPriceTrend:arrive",{status:g.statuscodes.AJAX_FAIL,response:null,src:a})}},g.api.hotel)},getBulkLastBookedTime:function(d){var a=this,g=["api\x3dHotelLastBookedTime"],l=function(a){return"undefined"===typeof a||"undefined"===typeof a.hotelTicker||0===a.hotelTicker.length||"undefined"===typeof a.hotelTicker[0].lastBookedTime?!1:!0};d=e.extend(!0,{type:"lastbooked"},d);g=g.concat(a.utils.objToStringArray(d,"request-"));a.utils.ajaxRequest({url:a.api.hotelEndpoint,timeout:a.api.hotelTimeout,dataType:"jsonp",data:d,success:function(d){var f="",e,s=[],t=[];if(b(d,l)){f=a.statuscodes.SUCCESS_RESPONSE;e=(new Date).getTime();t=d.hotelTicker;for(d=0;d<t.length;d++)s.push({hotelId:t[d].id,elapsedTimeMillisec:e-t[d].lastBookedTime});d=s}else f=a.statuscodes.ERROR_RESPONSE,g=g.concat(a.utils.objToStringArray(d,"response-")),c.loggingAdapter.logMessage(a.api.hotel+": "+a.statuscodes.ERROR_RESPONSE,g);h.publish("lastBookedTime:arrive",{status:f,response:d})},fail:function(){h.publish("lastBookedTime:arrive",{status:a.statuscodes.AJAX_FAIL,response:null})}},a.api.hotel)},getRegionUrgency:function(f,a,e){var g=this,n=["api\x3dRegionUrgency"],q,r,s={compression:{topic:"regionCompression:arrive",responseValidator:function(a){return a.regionTicker[0].regionLevelData.compressionSummary&&void 0!==a.regionTicker[0].regionLevelData.compressionSummary.score?!0:!1},responseExtractor:function(a){return{regionLevelData:a.regionTicker[0].regionLevelData,regionId:a.regionTicker[0].id}}},datedregionpricetrends:{topic:"regionPriceTrend:arrive",
responseValidator:function(a){return a.regionTicker[0].datedPriceTrend.trend?!0:!1},responseExtractor:function(a){return{datedPriceTrend:a.regionTicker[0].datedPriceTrend,regionId:a.regionTicker[0].id}}},"default":{topic:"regionUrgency:arrive",responseValidator:function(a){return a&&a.regionTicker&&a.regionTicker.length},responseExtractor:function(a){return a.regionTicker}},regionview:{topic:"regionView:arrive",responseValidator:function(a){return void 0!==a.regionTicker[0].viewsCount?!0:!1},responseExtractor:function(a){return a.regionTicker[0].viewsCount}}},t=function(a){return a&&a.regionTicker&&a.regionTicker.length},n=n.concat(g.utils.objToStringArray(f,"request-"));if("undefined"!==typeof f.checkinDate){q=g.utils.getUTCDate(f.checkinDate);if(null===q){h.publish("hotelPriceTrend:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:a});c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,n);return}f.checkinDate=q}if("undefined"!==typeof f.checkoutDate){q=g.utils.getUTCDate(f.checkoutDate);if(null===q){h.publish("hotelPriceTrend:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:a});c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,n);return}f.checkoutDate=q}r=f.type?f.type:"default";g.utils.ajaxRequest({url:g.api.regionEndpoint,timeout:g.api.regionTimeout,dataType:"jsonp",data:f,success:function(f){b(f,t)?!0===e?h.publish("consolidatedRegionUrgency:arrive",{status:g.statuscodes.SUCCESS_RESPONSE,response:f,src:a}):d(s,r,f,a):(n=n.concat(g.utils.objToStringArray(f,"response-")),c.loggingAdapter.logMessage(g.api.region+": "+g.statuscodes.ERROR_RESPONSE,n),!0===e?h.publish("consolidatedRegionUrgency:arrive",{status:g.statuscodes.ERROR_RESPONSE,response:f,src:a}):l(r,f,a,g.statuscodes.ERROR_RESPONSE))},fail:function(){!0===e?h.publish("consolidatedRegionUrgency:arrive",{status:g.statuscodes.AJAX_FAIL,response:response,src:a}):l(r,null,a,g.statuscodes.AJAX_FAIL)}},g.api.region)},getHotelUrgency:function(f,a,e){var g=this,n=["api\x3dHotelUrgency"],q,r,s={"default":{topic:"hotelUrgency:arrive",responseValidator:function(a){return a&&a.hotelTicker&&a.hotelTicker.length},responseExtractor:function(a){return a.hotelTicker}},view:{topic:"hotelView:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].viewsCount?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].viewsCount}},booking:{topic:"hotelBooking:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].bookingsCount?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].bookingsCount}},lastbooked:{topic:"hotelLastBooked:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].lastBookedTime?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].lastBookedTime}}},t=function(a){return a&&a.hotelTicker&&a.hotelTicker.length},n=n.concat(g.utils.objToStringArray(f,"request-"));r=f.type?f.type:"default";if("undefined"!==typeof f.checkinDate){q=g.utils.getUTCDate(f.checkinDate);if(null===q){c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,n);!0===e?h.publish("consolidatedHotelUrgency:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:a}):l(r,null,a,g.statuscodes.INVALID_INPUT+"Invalid checkInDate");return}f.checkinDate=q}if("undefined"!==typeof f.checkoutDate){q=g.utils.getUTCDate(f.checkoutDate);if(null===q){c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.INVALID_INPUT,n);!0===e?h.publish("consolidatedHotelUrgency:arrive",{status:g.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:a}):l(r,null,a,g.statuscodes.INVALID_INPUT+"Invalid checkOutDate");return}f.checkoutDate=q}g.utils.ajaxRequest({url:g.api.hotelEndpoint,timeout:g.api.hotelTimeout,dataType:"jsonp",data:f,success:function(f){b(f,t)?!0===e?h.publish("consolidatedHotelUrgency:arrive",{status:g.statuscodes.SUCCESS_RESPONSE,response:f,src:a}):d(s,r,f,a):(n=n.concat(g.utils.objToStringArray(f,"response-")),c.loggingAdapter.logMessage(g.api.hotel+": "+g.statuscodes.ERROR_RESPONSE,n),!0===e?h.publish("consolidatedHotelUrgency:arrive",{status:g.statuscodes.ERROR_RESPONSE,response:f,src:a}):l(r,f,a,g.statuscodes.ERROR_RESPONSE))},fail:function(){!0===e?h.publish("consolidatedHotelUrgency:arrive",{status:g.statuscodes.AJAX_FAIL,response:response,src:a}):l(r,null,a,g.statuscodes.AJAX_FAIL)}},g.api.hotel)}};return g});define("packageRoomsAndRates",["jquery","uitk","infosite"],function(e,h,c){return e.extend(new c.DeprecatedModule,{run:function(){e("body").on(h.clickEvent,".refresh-link",function(){c.track("Refresh",this);location.reload()})}})});define("packageSession",["jquery","uitk","dctk/dctk"],function(e,h,c){var b=function(b,h){if(h&&h.options&&"sessionRefreshModalContentId"===h.options.modalId){var g=window.location.href.replace(/(c=)[^\&]+/,"$1"+e("#continuationSessionId").val());c&&c.trackAction("Pkg.Infosite.SessionTimeout.Refresh",e("#sessionTimeoutInMinutes"));window.location.replace(g)}};return{run:function(){var d=parseInt(e("#sessionTimeoutInMinutes").val(),10);isNaN(d)||1!==e("#continuationSessionId").length||setTimeout(function(){var d={content:"sessionRefreshModalContent",modalId:"sessionRefreshModalContentId",title:window.refreshModalTitle,dismiss:!1,closeBtn:!0,closeText:window.refreshYourSearchBtnText,footer:"true"};c&&c.trackAction("Pkg.Infosite.SessionTimeout",e("#sessionRefreshModalContent"));h.modal.create(d);h.subscribe("modal.close",b)},6E4*d)}}});define("infosite",["jquery","infositeData","experiments","dctk/dctk"],function(e,h,c,b){var d={handleException:function(b){require("logger",function(c){c.logError("handleException",b)})},getVariant:function(b,c){d.evaluateExperimentAndLog(b,c)},evaluateExperimentAndLog:function(d,g){b.evaluateExperimentAndLog({guid:h.guid,tpid:h.tpid,eapid:h.eapid,id:d,callback:function(b){b=b.value;e("body").addClass("exp"+d+"-"+b);c[d]=parseInt(b,10);g&&g(b)}})},DeprecatedModule:function(){this.experiments={}}};d.DeprecatedModule.prototype.registerExperiment=function(b,c,d){"object"!==typeof c&&(c=[c]);for(var a=0;a<c.length;a++){var e="exp"+b+"-"+c[a];this.experiments[e]?this.experiments[e].push(d):this.experiments[e]=[d]}};d.DeprecatedModule.prototype.runExperiments=function(){for(var b in c)if(c.hasOwnProperty(b)){var d=c["exp"+b+"-"+c[b]];if(d)for(var f=0;f<d.length;f++)d[f]()}};d.track=function(c,d,f,a){var e=h.rfrrBase;c="undefined"!==typeof c&&-1<c.indexOf(e)?c:e+c;try{b.trackAction(c,d,f,a)}catch(p){window.console.log("tracking error")}};return d});define("wizardRoomsAndRatesView","jquery marionette uitk offersResponseModel i18n utils wizardView roomsAndRatesView".split(" "),function(e,h,c,b,d,l,g,f){var a,k=b.getSingleton();return h.LayoutView.extend({initialize:function(){this.listenTo(k,"request",this.showInterstitial);this.listenTo(k,"sync error",this.hideInterstitial);this.listenTo(k.errors,"change",this.hideInterstitial)},template:"wizard-rooms-and-rates",ui:{wizard:"#availability-wizard-container",roomsAndRates:".rooms-and-rates-segment"},regions:{wizard:"@ui.wizard",roomsAndRates:"@ui.roomsAndRates"},onBeforeShow:function(){this.wizard.show(new g);this.roomsAndRates.show(new f)},showInterstitial:function(){this.startTime=l.now();c.publish("results.changed",{contentId:"#rooms-and-rates",disable:!0,scrollToTop:!1,showLoader:!0,message:d.availabilitywizard.updating});var a=e("#onpage-interstitial-modal");c.utils.liveAnnounce(a.find(".modal-inner p"),"polite")},hideInterstitial:function(){a=750-(l.now()-this.startTime);setTimeout(function(){c.publish("results.complete",{contentId:"#rooms-and-rates",disable:!0,focusElement:"#"})},0<a?a:0)}})});
define("subscribeView",["marionette","uitk"],function(e,h){return e.ItemView.extend({template:!1,ui:{subscribeButton:"#subscribe-button",postStateMessage:".post-state-msg"},events:{"click @ui.subscribeButton":"subscribe"},subscribe:function(){require("scratchpad",function(c){c.enrollInNudge()});this.ui.subscribeButton.addClass("hidden");h.utils.focusElement(this.ui.postStateMessage.removeClass("hidden"));h.utils.liveAnnounce(this.ui.postStateMessage)}},{run:function(){return(new this({el:"#subscribe-box"})).render()}})});define("depositPolicyModel",["jquery","backbone","hotelInfo","offersResponseModel"],function(e,h,c,b){return h.Model.extend({initialize:function(){this.offersResponse=b.getSingleton();this.listenTo(this.offersResponse,"change:hasDeposit",this.getDepositPolicy)},getDepositPolicy:function(){var b=this;this.offersResponse.get("hasDeposit")?this.fetch().fail(function(){b.clear()}):this.clear()},parse:function(b){try{var c=b.depositPolicies[0].paragraphPerLang[0].paragraphs;return{depositPolicy:c[0],schedule:c.slice(1)}}catch(e){return{}}},url:function(){return"/api/hoteldeposit/policies/property/"+c.id+"?"+e.param({fromStayDate:this.offersResponse.get("fromStayDate"),toStayDate:this.offersResponse.get("toStayDate"),langIds:c.langId,clientId:"Infosite"},!0)}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("roomsAndRatesView","underscore jquery backbone marionette depositPolicyModel offersResponseModel uitk roomsAndRates i18n roomTypeView offerView hotelInfo infosite experiments dctk".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q,r,s){var t=b.ItemView.extend({initialize:function(){this.listenTo(this.depositPolicyModel,"change",this.render)},depositPolicyModel:d.getSingleton(),template:"deposit-choice-template",serializeData:function(){var a=this.options.model.toJSON(),b=this.depositPolicyModel.toJSON(),c="HOT.HIS.RoomsAndRates.BookButton"+a.bookButtonIndex+"|";a.payNowRfrr=c+"DepositChoicePayNow";a.depositOffer.payLaterRfrr=c+"DepositChoicePayDeposit";h.extend(a.depositOffer,b);return a},behaviors:{Modal:{modalId:"payment-choice-modal",dismiss:!1,title:a.bookbutton.paymentChoiceModalTitleShort}}});g.subscribe("modal.close",function(a,b){var c;if("payment-choice-modal"===b.options.modalId||"deposit-choice-modal"===b.options.modalId)c=h("#"+b.options.modalId),q.track("HOT.HIS.RoomsAndRates.ETPCloseModal",c.get(0))});var v=b.ItemView.extend({template:"payment-choice-template",serializeData:function(){var a=this.options.model.toJSON(),b="HOT.HIS.RoomsAndRates.BookButton"+a.bookButtonIndex+"|";a.payNowRfrr=b+"ChoicePayNow";a.payLaterOffer.payLaterRfrr=b+"ChoicePayLater";return a},behaviors:{Modal:{modalId:"payment-choice-modal",dismiss:!1,title:a.bookbutton.paymentChoiceModalTitleShort}}}),m=b.ItemView.extend({template:"mrp-modal-template",behaviors:{Modal:{modalId:"mrp-modal",dismiss:!1,title:a.roomtemplates.mrpModalTitle}}});return b.ItemView.extend({tagName:"table",template:"hierarchical-room-template",model:l.getSingleton(),modelEvents:{change:"render",triggerViewRender:"render"},templateHelpers:function(){var a=this.model.get("rooms");return{hasOffers:!(!a||!a.length)}},serializeData:function(){var a=this,b=this.model.toJSON();e.each(b.rooms,function(b){e.extend(b,(new k({model:new c.Model(b),parentView:a})).templateHelpers());e.each(b.offers,function(b){e.extend(b,(new p({model:new c.Model(b),parentView:a})).templateHelpers());b.roundCurrency=n.roundCurrency})});return b},onRender:function(){g.publish("debounced.scroll");g.publish("ajaxroomsandratesrendered",this)},onAttach:function(){g.publish("ajaxroomsandrates.attach",this);f.showDrrCountdown()},onDomRefresh:function(){g.publish("ajaxroomsandrates.domrefresh",this);f.showDrrCountdown()},events:{"click .etp-book-button":"clickEtpBookButton","click .mrp-book-button":"clickMrpBookButton"},clickEtpBookButton:function(a){var b=h(a.target),d;a=b.attr("data-roomtypecode");for(var b=b.attr("data-rateplancode"),f=this.model.get("rooms"),e=0;e<f.length;e++)if(a===f[e].roomTypeCode)for(var g=f[e].offers,k=0;k<g.length;k++)b===g[k].ratePlanCode&&(d=new c.Model(g[k]));d.get("depositOffer")?(new t({model:d})).render():((new v({model:d})).render(),"undefined"!==typeof r["11584"]&&s.logExperiment({id:11584}))},clickMrpBookButton:function(a){a=h(a.target);var b=a.attr("data-roomTypeCode"),d,f=this.model.get("rooms"),e=0;a:for(;e<f.length;e++){var g=f[e].offers;if(g)for(var k=0;k<g.length;k++)if(g[k].mrp&&b===g[k].roomTypeCode){d=g[k];break a}}d&&d.offerSegments&&2===d.offerSegments.length&&((d.offerSegments[0].nonRefundableInsideWindow||d.offerSegments[0].freeCancellable)!==(d.offerSegments[1].nonRefundableInsideWindow||d.offerSegments[1].freeCancellable)&&(d.showPolicySpace=!0),d.formIndex=a.context.getAttribute("data-bookButtonIndex")-1);(new m({model:new c.Model(d)})).render()}},{DepositModalView:t,PayLaterModalView:v,MRPModalView:m})});define("airAttachBannerView",["marionette","offersResponseModel","utils"],function(e,h,c){function b(){return""}h=h.getSingleton().airAttach;return e.ItemView.extend({constructorName:"AirAttachBannerView",model:h,modelEvents:{"change:startTime":"render"},behaviors:{Countdown:{}},tagName:"div",className:"cols-row extended-cols-row",getTemplate:function(){return this.model.get("bookedLob")?this.model.get("taapPackageRates")?"taap-air-attach-banner":"air-attachment-banner":b},templateHelpers:function(){var b=this.model,e="airattachment.airAttachmentQualificationBannerMessage",e=this.model.get("enableNewSavingMessage"),g=this.model.get("enableOfferWindowTillTravel"),e=b.get("taapPackageRates")?"airattachment.airAttachmentQualificationBannerMessage":b.get("percentageSavings")?e?"airattachment.limitedTimePercentOffBannerMessage":"airattachment.percentOffBannerMessage":e?"airattachment.limitedTimeNoPercentBannerMessage":"airattachment.noPercentBannerMessage",f=b.get("expiration"),a=b.get("days"),h="";g&&(h=c.calcExpiresLongDate(f));b.get("showDays")&&(f-=c.now(),a=Math.ceil(f/864E5));return{bookedLobKey:"airattachment."+b.get("bookedLob")+"Lob",messageKey:e,expiresLongDate:h,showDays:b.get("showDays"),totalDays:a,enableOfferWindowTillTravel:g}}})});define("countdownModel",["underscore","backbone","utils"],function(e,h,c){function b(b){return 10>b?"0"+b:String(b)}return h.Model.extend({initialize:function(){this.on("change:expiration",this.start);this.on("destroy",this.stop);this.start()},defaults:function(){return{startTime:c.now(),expiration:0}},calcRemainingTime:function(){return this.get("expiration")-c.now()},resetTimer:function(){this.stop();var b=this.get("startTime")-c.now();this.set({expiration:this.get("expiration")-b},{silent:!0})},stop:function(){clearTimeout(this.timeoutId)},scheduleNextTick:function(){this.timeoutId=c.setTimeout(e.bind(this.tick,this),1E3)},parse:function(c){return{days:String(Math.floor(c/864E5)),hours:b(Math.floor(c/36E5%24)),minutes:b(Math.floor(c/6E4%60)),seconds:b(Math.floor(c/1E3%60)),remainingTime:c}},start:function(){this.resetTimer();this.tick()},tick:function(){var b=this.calcRemainingTime();0<=b&&(this.set(this.parse(b)),this.scheduleNextTick())}})});define("roomTypeView",["marionette"],function(e){return e.ItemView.extend({templateHelpers:function(){return{}}})});
define("offerView","jquery marionette templates underscore uitk experiments airAttachView".split(" "),function(e,h,c,b,d,l,g){var f={template:"room-amenity",classes:"value-add",icon:"success"};return h.LayoutView.extend({initialize:function(a){var b=this,c=a.parentView;this.listenTo(a.parentView,"render",function(){b.$el=c.$el.find('[data-offer-index\x3d"'+b.model.get("offerIndex")+'"]');b.el=b.$el[0];b.isRendered=!0;b.bindUIElements();b.triggerMethod("render",b)})},ui:{airAttach:".air-attach-container"},regions:{airAttach:"@ui.airAttach"},templateHelpers:function(){var a={},c=this,d=this.model.get("availableAmenities");b.each(d,function(b,d){b&&(f.messageKey="roomtemplates.amenities."+d,a[d]=c.offerAmenity(f))},c);this.model.get("bookable")&&(this.model.get("depositOffer")?a.reserveWithDeposit=this.offerAmenity({classes:"payment-choice-tooltip-link",automationId:"book-now-rate-plan-id",messageKey:"roomtemplates.reserveWithDeposit"}):this.model.get("showETPTooltip")&&(a.bookNowPayLater=1===l[9904]?this.offerAmenity({classes:"payment-choice-tooltip-link",automationId:"deposit-rate-plan-id",messageKey:"roomtemplates.reserveNowPayLater"}):this.offerAmenity({classes:"payment-choice-tooltip-link",automationId:"book-now-rate-plan-id",messageKey:"roomtemplates.bookNowPayLater"})));return a},offerAmenity:function(a){a=b.extend({},f,a);return c[a.template](a)},onRender:function(){this.model.get("airAttach")&&this.model.get("bookable")&&this.airAttach.show(new g)}})});define("ads",["jquery","uitk"],function(e,h){var c={resize:function(){window.expads&&window.expads.utils&&"function"===typeof window.expads.utils.resize&&(window.expads.utils.resize("LARGEFOOTERGOOGLE"),window.expads.utils.resize("SMALLFOOTERGOOGLE"))},run:function(){h.mediaquery.register("only screen and (min-width: 20em) and (max-width: 30.6875em)","ads_hotel_rweb_mobile");h.mediaquery.register("only screen and (min-width: 32.25em) and (max-width: 49.25em)","ads_hotel_desktop_small");h.mediaquery.register("only screen and (min-width: 49.25em) and (max-width: 64em)","ads_hotel_desktop_medium");h.mediaquery.register("only screen and (min-width: 64em) and (max-width: 78.75em)","ads_hotel_desktop_large");h.mediaquery.register("only screen and (min-width: 78.75em)","ads_hotel_desktop_full");h.subscribe("debounced.resize",c.resize);h.subscribe("infosite.recommendationsRendered",function(){var b=e(".recommendations-grid");"undefined"!==typeof window.HookLogicBeaconPixel&&"function"===typeof window.HookLogicBeaconPixel.fireBeaconPixel&&0<b.length&&window.HookLogicBeaconPixel.fireBeaconPixel()})}};return c});define("membership",["jquery","backbone","userInfo","infosite/env"],function(e,h,c,b){function d(){e("#bpg-menu").removeClass("hidden");e("#non-reward-user").removeClass("hidden")}var l=h.Model.extend({url:"/api/infosite/"+c.userTuid+"/"+c.siteId+"/"+c.locale+"/getMembershipInfo"});return{run:function(){if(b.isCloud)if(b.isOrbitz||b.isCheapTickets)e("#zeta-bpg").removeClass("hidden"),e("#zeta-acquisition").removeClass("hidden");else if("0"!==c.userTuid&&"-1"!==c.userTuid){var g=new l;g.fetch().done(function(){g.get("hasErrors")?d():(e("#hpg-menu").removeClass("hidden"),e("#reward-user").removeClass("hidden"))}).fail(function(){d()})}else d()}}});define("pricechangeView","jquery marionette offersResponseModel hotelInfo uitk underscore".split(" "),function(e,h,c,b,d,l){var g=0,f=!1,a=0;return h.ItemView.extend({tagName:"div",className:"price-change",template:"price-change-template",model:c.getSingleton().leadOffer,modelEvents:{change:"renderOnce"},formatPrice:function(a){return d.utils.createLocalizedPrice(String(a),b.locale,b.currencyCode).roundHalfDown().format()},renderOnce:function(){l.once(function(){this.render()});this.destroy()},getParameterByName:function(a,b){"undefined"!==typeof b&&(b=window.location.href);a=a.replace(/[\[\]]/g,"\\$\x26");var c=(new RegExp("[?\x26]"+a+"(\x3d([^\x26#]*)|\x26|#|$)")).exec(b);return"undefined"!==typeof c||"undefined"!==typeof c[2]?null:decodeURIComponent(c[2].replace(/\+/g," "))},paramsExist:function(){var a=this.getParameterByName("rateplanid"),c=this.getParameterByName("trv_dp"),d=this.getParameterByName("mctc"),f=this.getParameterByName("trv_curr");return a&&d&&c&&f&&f.toUpperCase()===b.currencyCode.toUpperCase()?!0:!1},priceChanged:function(b){if(this.paramsExist()){var c=Number(this.getParameterByName("trv_dp"));if("undefined"!==typeof b&&0!==b&&!isNaN(b)&&!isNaN(c)&&0!==c&&"undefined"!==typeof c&&b>c&&2.1<b-c)return f=!0,a=c,!0}return f=!1},serializeData:function(){var b=this.model.toJSON();f=this.paramsExist();g=0;if(b&&!e.isEmptyObject(b)){var c=b.price;if(c&&!e.isEmptyObject(c)&&(b=b.loyaltyBurnedPrice?b.loyaltyBurnedPrice.amount:c.price,this.priceChanged(b)))return{minPrice:this.formatPrice(b),priceChangedTo:this.formatPrice(a),hasPriceDifference:f}}return{minPrice:g,priceChangedTo:a,hasPriceDifference:f}}})});define("priceChangeLogger","logger infositeData priceChangeConfig offersResponseModel experiments jquery".split(" "),function(e,h,c,b,d,l){function g(a){a=(new RegExp("[?\x26]"+a+"\x3d([^\x26#]*)")).exec(window.location.href);return null===a?null:a[1]||0}function f(){p.ratePlan=g("rateplanid");p.partnerPrice=g("trv_dp");p.partnerCurrency=g("trv_curr");p.partner="Trivago";if(!p.partnerPrice){var b=g("exp_ts");b&&144E5>(new Date).getTime()-parseInt(b,10)&&(p.partnerPrice=g("exp_dp"),b=g("exp_pg"),null===b&&(b=g("exp_partner")),p.partner=b,p.partnerCurrency=g("exp_curr"),p.ratePlan="")}1===d[8100]&&a&&!l.isEmptyObject(a)?(b=a.toJSON())&&!l.isEmptyObject(b)&&b.bestOffer&&b.bestOffer.price&&(p.landingPrice=b.bestOffer.price.price,p.landingCurrency=h.currencyCode,p.numberOfNights=b.bestOffer.numberOfNights):(p.landingPrice=c.landingPrice,p.landingCurrency=c.landingCurrency,p.numberOfNights=c.numberOfNights);var f;a:{if(p.partnerPrice&&p.partnerCurrency&&p.landingPrice&&p.landingCurrency&&p.numberOfNights&&0<p.numberOfNights&&p.landingCurrency.toUpperCase()===p.partnerCurrency.toUpperCase())try{var k="Trivago"!==p.partner,s=c.isTotal&&!k?parseFloat(p.landingPrice)/p.numberOfNights:parseFloat(p.landingPrice),t=parseFloat(p.partnerPrice);p.priceDifference=s-t;if(1<Math.abs(p.priceDifference)){f=!0;break a}}catch(v){}f=!1}f&&e.logMessage("price-change",p)}var a=b.getSingleton().leadOffer,k=!0,p={guid:h.guid,landingPrice:c.landingPrice,landingCurrency:c.landingPrice};return{run:function(){if(0===d[8100])f();else a.on("change",function(){k&&(f(),k=!1)})}}});define("swpToggleView",["marionette","offersResponseModel","i18n","experiments"],function(e,h,c,b){h=h.getSingleton();return e.ItemView.extend({template:"swp-toggle",model:h.loyaltyData,modelEvents:{change:"render"},events:{"change #apply-points-checkbox":"submitWizard"},submitWizard:function(){this.options.wizardView.submit()},templateHelpers:function(){var d=this.model.get("swpToggleSessionStateIsOn"),e=this.model.get("awardType"),g={loyaltybrandName:this.model.get("expediaPlusBranded"),loyaltybrandAwardCurrency:this.model.get("expediaPointsBranded")},f=d?c.getMessage("availabilitytemplates.rewardsPointsApplied",g):c.getMessage("availabilitytemplates.applyPoints",g),g=d?c.getMessage("availabilitytemplates.rewardsApplied",g):c.getMessage("availabilitytemplates.applyRewards",g);return{displaySwpToggle:1===b["9928"]&&this.model.get("displaySwpToggle"),swpToggleLabel:f,swpCurrencyLabel:g,checked:d,isAwardTypePoints:"points"===e}}})});define("airAttachView",["marionette","offersResponseModel","utils"],function(e,h,c){h=h.getSingleton().airAttach;return e.ItemView.extend({constructorName:"AirAttachView",behaviors:{Countdown:{}},getTemplate:function(){return this.model.get("taapPackageRates")?"taap-air-attach":"air-attach"},model:h,templateHelpers:function(){return{price:{percentageDiscount:this.model.get("percentageSavings")},bookedLobKey:"airattachment."+this.model.get("bookedLob")+"LOB",totalDays:this.model.get("days"),expiresLongDate:c.calcExpiresLongDate(this.model.get("expiration")),enableOfferWindowTillTravel:this.model.get("enableOfferWindowTillTravel")}}})});
require(["handlebars"],function(e){var h=e.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,b,d,e,g){var f;return"\x3cdiv\x3e\n"+(null!=(f=(d.uitk_imageGallery||b&&b.uitk_imageGallery||d.helperMissing).call(null!=b?b:{},{name:"uitk_imageGallery",hash:{id:"media-ours-test",slideId:"templateMediaGallery"},fn:c.program(1,g,0),inverse:c.noop,data:g}))?f:"")+"\x3c/div\x3e"},1:function(c,b,d,e,g){var f;return"\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002"+(null!=(f=d.each.call(null!=b?b:{},b,{name:"each",hash:{},fn:c.program(2,g,0),inverse:c.noop,data:g}))?f:"")+"\u2002\u2002\u2002\u2002"},2:function(c,b,d,e,g){var f;return null!=(f=d["if"].call(null!=b?b:{},null!=b?b.thumbnailUrl:b,{name:"if",hash:{},fn:c.program(3,g,0),inverse:c.noop,data:g}))?f:""},3:function(c,b,d,e,g){var f;return null!=(f=(d.uitk_galleryImage||b&&b.uitk_galleryImage||d.helperMissing).call(null!=b?b:{},{name:"uitk_galleryImage",hash:{caption:null!=b?b.displayText:b,alt:"room image",downgrade:"true",main:null!=b?b.thumbnailUrl:b,thumb:null!=b?b.thumbnailUrl:b},fn:c.program(4,g,0),inverse:c.noop,data:g}))?f:""},4:function(c,b,d,e,g){var f;return(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.large1000Url:b,{name:"if",hash:{},fn:c.program(5,g,0),inverse:c.noop,data:g}))?f:"")+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.large500Url:b,{name:"if",hash:{},fn:c.program(7,g,0),inverse:c.noop,data:g}))?f:"")+(null!=(f=d["if"].call(null!=b?b:{},null!=b?b.bigUrl:b,{name:"if",hash:{},fn:c.program(9,g,0),inverse:c.noop,data:g}))?f:"")},5:function(c,b,d,e,g){return"                        "+c.escapeExpression((d.uitk_src||b&&b.uitk_src||d.helperMissing).call(null!=b?b:{},{name:"uitk_src",hash:{src:null!=b?b.large1000Url:b},data:g}))+"\n"},7:function(c,b,d,e,g){return"                        "+c.escapeExpression((d.uitk_src||b&&b.uitk_src||d.helperMissing).call(null!=b?b:{},{name:"uitk_src",hash:{width:"500",src:null!=b?b.large500Url:b},data:g}))+"\n"},9:function(c,b,d,e,g){return"                        "+c.escapeExpression((d.uitk_src||b&&b.uitk_src||d.helperMissing).call(null!=b?b:{},{name:"uitk_src",hash:{width:"350",src:null!=b?b.bigUrl:b},data:g}))+"\n"},useData:!0});e.templates=e.templates||{};e.templates["room-gallery"]=h;e.partials=e.partials||{};e.partials["room-gallery"]=h});define("urgencyApplication","jquery infositeData urlModel offersResponseModel experiments almostsoldouthotel logger hotelNotifier justBookedHotel uitk".split(" "),function(e,h,c,b,d,l,g,f,a,k){function p(a){var b;a&&k.locale&&k.utils&&(b=k.utils.createLocalizedDate(a,k.locale));return b.shortDate()}var n={model:{},started:!1},q=c.getSingleton(),r=b.getSingleton();n.init=function(){n.model={clientId:"hotelinfosite",ids:h.hotelId,checkinDate:p(q.getCheckIn()),checkoutDate:p(q.getCheckOut()),clientcontainer:e("#compressionContainer")}};n.runModules=function(){1===d["10349"]&&(0===d[8100]?a.showAlert({clientId:"hotelinfosite",ids:h.hotelId}):1===d[8100]&&k.subscribe("ajaxroomsandratesrendered",function(){r.get("isThereABookableOffer")&&a.showAlert({clientId:"hotelinfosite",ids:h.hotelId})}));if(!h.isPackageInfosite&&!h.isDateless&&!h.isSoldOut){var b=e("#compressionContainer");if(1===d["8100"])r.on("change",function(){r.get("isThereABookableOffer")&&b.length&&(b.empty(),l.showAlert(n.model))});else l.showAlert(n.model);var c,g;k.subscribe("mediaquery.matched",function(a,d){c=491<d.screenWidth;g!==c&&((g=c)?b.show():b.hide())});k.mediaquery.publishAgain()}if(1===d["11222"])if(1===d["8100"])r.on("change",function(){r.get("isThereABookableOffer")&&f.notify(n.model)});else f.notify(n.model)};n.start=function(){try{n.init(),n.runModules(),n.started=!0}catch(a){g.logError("Error starting urgencyApplication",a)}};return n});
define("legacyExperiments","infosite roomsAndRates reviews competitors eds jquery handlebars uitk logger search infositeData".split(" "),function(e,h,c,b,d,l,g,f,a,k,p){function n(){c.normalizedReviewScore=function(a){return 4.6<a?4:4.5<=a?3:4.3<=a?2:4<=a?1:3.5<=a?0:-1};c.getSuperlative=function(a){if(a)return c.superlatives[c.normalizedReviewScore(a)]};c.ta.loadRating=function(){l.ajax({url:"//api.tripadvisor.com/api/partner/1.0/location/"+p.hotelId+"?key\x3d"+c.tripAdvisorKey+"\x26lang\x3d"+c.ta.locale+"\x26jsoncallback\x3ddata",dataType:"jsonp",timeout:8E3,jsonp:!1,jsonpCallback:"data",success:function(a){null==a.reviewRatingCount&&(a.reviewRatingCount=0);c.ta.tripAdvisorReviewSummaryData={numReviews:parseInt(a.num_reviews,10),isSingleReview:1===a.numReviews,useShortHeader:0!==c.urs.totalCount,rating:a.rating&&a.rating.toString().replace(/\D/,"").replace(/0/,""),ratingWithDecimal:a.rating,cleanliness:a.subratings&&parseFloat(a.subratings.Cleanliness).toFixed(1),service:a.subratings&&parseFloat(a.subratings.Service).toFixed(1),rooms:a.subratings&&parseFloat(a.subratings.Rooms).toFixed(1),value:a.subratings&&parseFloat(a.subratings.Value).toFixed(1),showCleanliness:a.subratings&&!isNaN(parseFloat(a.subratings.Cleanliness)),showService:a.subratings&&!isNaN(parseFloat(a.subratings.Service)),showRooms:a.subratings&&!isNaN(parseFloat(a.subratings.Rooms)),showValue:a.subratings&&!isNaN(parseFloat(a.subratings.Value)),tripAdvisorUrl:a.web_url,reviewRatingCount:a.reviewRatingCount,percentRecommend:(c.ta.parsePercentage(a.reviewRatingCount[5],a.num_reviews)+c.ta.parsePercentage(a.reviewRatingCount[4],a.num_reviews)).toFixed(0),percentagesAtTiers:[],isLinkToReviews:0==c.ta.tripAdvisorVariant&&!e.isInformationOnlyEnabled,isInformationOnly:e.isInformationOnlyEnabled};a=c.ta.tripAdvisorReviewSummaryData;c.ta.tripAdvisorReviewSummaryData.showGuestRecommendation=5<a.numReviews;-1!==c.normalizedReviewScore&&(c.ta.tripAdvisorReviewSummaryData.superlative=c.getSuperlative(a.ratingWithDecimal));c.ta.hasReviews=0<a.numReviews;c.ta.hasReviews?(a=g.templates["trip-advisor-rating-template-extended"](c.ta.tripAdvisorReviewSummaryData),l(".reviews-summary-box").removeClass("hidden"),l("#trip-advisor-summary").removeClass("hidden").html(a),f.publish("infosite.tripAdvisorRendered",c.ta.tripAdvisorReviewSummaryData)):0===c.urs.totalCount&&l(".tabs").hide()}})};c.ta.loadReviewSummary=function(a){var b=c.ta.tripAdvisorReviewSummaryData;if(0<a.length&&b){c.ta.tripAdvisorReviewSummaryData.reviewRatingCount.length=6;c.ta.tripAdvisorReviewSummaryData.reviewRatingCount=Array.prototype.slice.call(c.ta.tripAdvisorReviewSummaryData.reviewRatingCount).slice(1,6).reverse();for(a=0;a<c.ta.tripAdvisorReviewSummaryData.reviewRatingCount.length;a++)c.ta.tripAdvisorReviewSummaryData.percentagesAtTiers[a]=c.ta.parsePercentage(c.ta.tripAdvisorReviewSummaryData.reviewRatingCount[a],b.numReviews);0<b.numReviews&&(b=g.templates["trip-advisor-review-summary-template"](c.ta.tripAdvisorReviewSummaryData),l("#ta-review-summary").html(b));b=g.templates["trip-advisor-reviews-pagination-template"](c.ta.tripAdvisorReviewSummaryData);l(".nav-footer").html(b);l("#reviews-content .nav-footer").show()}}}k.registerExperiment(8100,1,function(){k.createChildAge=function(a,b,c,d){return{text:0===a?"\x3c 1":a,value:a,isSelected:b<d.length&&parseInt(d[b],10)===a}}});c.registerExperiment(4711,1,function(){n()});c.registerExperiment(4711,2,function(){n()});c.registerExperiment(4711,3,function(){n()});e.isInformationOnlyEnabled&&(c.registerInformationOnly=function(){n()});b.registerExperiment(8999,[0,2],function(){e.evaluateExperimentAndLog(8999)});b.registerExperiment(8999,1,function(){b.makeInfositeApiServiceCall=!0;f.subscribe("competitor.success",function(){var a=b.data,c=a.length-1,a=g.templates["compare-list"]({competitorPricing:a,expediaPrice:b.expediaPrice,numBelowFold:c,collapsible:0<c});l("#price-compare-list").removeClass("hidden").html(a);e.evaluateExperimentAndLog(8999)});f.subscribe("competitor.failure",function(){document.getElementById("price-compare-box").style.display="none"});l("body").on(f.clickEvent,".competitor-toggle-show",function(){l(".competitor-toggle-show").toggleClass("hidden");l(".competitor-toggle-below-fold").toggleClass("competitor-hidden")});l("body").on(f.clickEvent,"#competitor-close-button",function(){f.utils.focusElement(l(".page-content"))});l("body").on(f.clickEvent,"#compare-all-link",function(){l("#compare-all-link").attr("aria-hidden","true");l("#hide-link").attr("aria-hidden","false");f.utils.focusElement(l("#hide-link"))});l("body").on(f.clickEvent,"#hide-link",function(){l("#hide-link").attr("aria-hidden","true");l("#compare-all-link").attr("aria-hidden","false");f.utils.focusElement(l("#compare-all-link"))})});b.registerExperiment(8999,3,function(){b.makeIntentmediaServiceCall=!0;f.subscribe("intentmedia.impression.success",function(){e.evaluateExperimentAndLog(8999);l("#price-compare-list").removeClass("hidden").html(b.html)});f.subscribe("intentmedia.impression.failure",function(){document.getElementById("price-compare-list").style.display="none"})});return{}});define("exp7522",["jquery","infosite","experiments"],function(e,h,c){e=e("#show-more-recreation");0===c["7522"]?0<e.find("li").length&&h.evaluateExperimentAndLog(7522):1===c["7522"]&&(c=e.find("li"),0<c.length&&(h.evaluateExperimentAndLog(7522),e.find("p").first().remove(),(1<e.find("p").length||12<c.length)&&e.parent().find("a").remove()));return{}});require(["jquery"],function(e){var h=document.location.search.match(/rank=(\d+)/),c=document.location.search.match(/theme=([A-Za-z]+)/);h&&h[1]&&c&&c[1]&&(h=h[1],c=c[1],e("#hotel-name").prepend("#"+h+" match for "+c+" hotels:\x3cbr /\x3e"))});require(["infosite"],function(e){e.evaluateExperimentAndLog(8444)});define("exp8494","jquery reviewsConfig infosite uitk infositeData experiments".split(" "),function(e,h,c,b,d,l){if(h.isReviewTranslationEnabled&&!d.isPackageInfosite){var g=!1;b.subscribe("infosite.reviewDetailsRendered",function(b,a){var d,p=a.reviewCollection.review,n=!1,q="";1===l["8494"]&&require("handlebars",function(a){q=a.templates["review-translate-bar-template"]});for(d=0;d<p.length;d++){var r=p[d],s=r.contentLocale.substring(0,2);(0<r.positiveRemarks.length||0<r.locationRemarks.length||0<r.negativeRemarks.length||0<r.title.length||0<r.reviewText.length)&&s!==h.urs.langCode&&-1!==e.inArray(s,h.translatableLanguages)&&(1===l["8494"]&&e(".review[data-review-id\x3d"+r.reviewId+"] .date-posted:first").after(q),n=!0)}1===l["8494"]&&require("googleTranslateSingle",function(a){e(".translate-btn").on("click",a.onTranslateButtonClick);e(".show-original-btn").on("click",a.onOriginalButtonClick)});n&&!g&&(c.evaluateExperimentAndLog(8494),g=!0)})}});
define("exp9083","jquery infosite experiments handlebars uitk dctk urgency offersResponseModel infositeData urlModel".split(" "),function(e,h,c,b,d,l,g,f,a,k){function p(){return{clientId:"hotelinfosite",ids:a.hotelId,checkinDate:n.getCheckIn(),checkoutDate:n.getCheckOut()}}var n=k.getSingleton(),q=f.getSingleton(),r={};if(1===c["9122"]&&(4===c["9083"]||0===c["9083"]))if(d.subscribe("hotelPriceTrend:arrive",function(a,d){var f,h;if(f=d.status===g.statuscodes.SUCCESS_RESPONSE&&d.response)f=d.response,f=f.hotelTicker&&f.hotelTicker.length&&f.hotelTicker[0].datedPriceTrend&&f.hotelTicker[0].datedPriceTrend.trend&&f.hotelTicker[0].datedPriceTrend.days&&("HIGHEST"===f.hotelTicker[0].datedPriceTrend.trend||"LOWEST"===f.hotelTicker[0].datedPriceTrend.trend)&&1<f.hotelTicker[0].datedPriceTrend.days?!0:!1;f&&(f=d.response.hotelTicker[0].datedPriceTrend,4===c["9083"]&&(h=b.templates.priceTrendAlertTmpl({trendDays:f.days,trend:f.trend}),e("#priceTrendContainer").empty().append(h)),h="HIGHEST"===f.trend?"HOT.HIS.PriceTrends.UP.":"HOT.HIS.PriceTrends.DOWN.",h+=f.days,r.logExperiment(h))}),1===c[8100])q.on("change",function(){!1===q.get("isHotelSoldOut")&&e("#priceTrendContainer").length&&(e("#priceTrendContainer").empty(),g.getHotelPriceTrend(p()))});else g.getHotelPriceTrend(p());r.logExperiment=function(a){l.logExperiment({id:9083,value:c["9083"],pageName:l.omtr?l.omtr.pageName:"page.Hotels.Infosite.Information",tpid:Number(h.tpid),eapid:Number(h.eapid),guid:l.logging.guid,callback:function(b){void 0!==b&&void 0===b.error&&setTimeout(function(){l.trackImpression(a,{})},3E3)}})};return r});define("exp9590","jquery infosite experiments templates uitk recommendationsConfig infositeData".split(" "),function(e,h,c,b,d,l,g){if(!(g.isPackageInfosite||g.isDateless||g.isMutedHotel||g.isSoldOut)){var f;c=e("div.lead-price").find("a.link-to-rooms").text();void 0!==c&&""!==c&&(f=Number(c.replace(/[^0-9\.]+/g,"")));l=l.ajaxURL.replace("criteria\x3dpersona-item-item-xsell|0|5","criteria\x3dpersona-item-item-xsell|0|3");e.ajax({url:l,dataType:"json",success:function(a){if(0===a.errorCode&&!isNaN(f)&&0<a.recommendations[0].items.hotels.length){a=a.recommendations[0].items.hotels;h.evaluateExperimentAndLog(9590);var c=g.starRatingString,d=g.hotelName,l=g.url,l=l.slice(0,-6)+"_l.jpg";a.unshift({hotelId:g.hotelId,hotelName:d,starRating:c,averagePriceValue:f,urlToThumbnail:l,reviewTotal:g.reviewCount,currencyCode:g.currencyCode});for(c=0;c<a.length;c++){d=a[c].starRating;-1===d.indexOf(".")&&(d=d.concat(".0"));d=d.replace(".","-");a[c].starRating=d;if("USD"===a[c].currencyCode||"usd"===a[c].currencyCode)a[c].currencyCode="$";a[c].averagePriceValue=Math.round(a[c].averagePriceValue);0===c?(a[c].urlToHotelInfosite="",a[c].attributes='onclick\x3d"return false"'):a[c].attributes='target\x3d"_blank"'}a=b["jump-hotels"](a);e("#jump_hotels-box").removeClass("hidden");e("#jump-hotels-list").removeClass("hidden").html(a)}}})}return{}});define("InfositeExperiment","infosite logger experiments jquery underscore marionette".split(" "),function(e,h,c,b,d,l){var g=l.Object.extend({initialize:function(b){var a=this.getOption("experimentId");"number"===typeof a?this.experimentId=a:(this.experimentId=void 0,this.logError(Error("new InfositeExperiment expected 1 valid argument (experimentId:number)")));this.isRegistered=!1;this.criteria={};this.variant=c[this.experimentId];this.mergeOptions(b,d.keys(b))},addCriteria:function(){for(var b=0;b<arguments.length;b++){var a=arguments[b];void 0!==a&&null!==a&&"string"===typeof a?this.criteria[a]=!1:this.logError(Error("experimentId:"+this.experimentId+", addCritera method requires at least one valid argument (key:string)"))}},checkCriteria:function(){return d.every(this.criteria)},checkCriteriaAndRegister:function(){var b=this.checkCriteria();!0===b&&this.register();return b},passCriteria:function(b){"string"===typeof b?void 0!==this.criteria[b]?this.criteria[b]=!0:this.logError(Error("experimentId:"+this.experimentId+", passCriteria method, no such criteria for key: "+b)):this.logError(Error("experimentId:"+this.experimentId+", passCriteria method expected at least one valid argument (key:string)"))},getVariantById:function(b){if(0===arguments.length)return this.variant;if("number"===typeof b||"string"===typeof b)return c[b];this.logError(Error("experimentId:"+this.experimentId+", getVariant method expected one optional valid argument experimentId (experimentId:number|string"));return 0},itemInView:function(c){if(void 0===g.$window||null===g.$window)g.$window=b(window),g.$window.itemInView=function(){!1===c instanceof b&&(c=b(c));if(0===c.length)return!1;try{var a=this.height(),d=this.scrollTop();return c.offset().top<a+d}catch(e){return!1}};return g.$window.itemInView(c)},logError:function(b){h.logError("[InfositeExperiment Error]",b)},logMessage:function(b){h.logMessage("[InfositeExperiment Message]",b)},register:function(b){!0!==this.isRegistered&&(this.isRegistered=!0,void 0!==b&&"function"===typeof b?e.evaluateExperimentAndLog(this.experimentId,b):e.evaluateExperimentAndLog(this.experimentId))},run:function(){}});return g});define("exp9849",["jquery","experiments","exp11013"],function(e,h,c){var b={triesCount:0,order:function(){var b=e("#categoryIds");if(b&&b.length){var h=b.val();if(h&&""!==h){var h=","+h+",",g=e(".jumbo-hero img.hero"),b=e("#hotel-thumbnails").find(".hotel-thumbnail"),f=g.length;if(g.length===b.length){var a=[];e.each(b,function(b,c){var d=e(c).find("a").attr("data-track").replace(/.*Thumbnails\./,",")+",";a.push([h.indexOf(d),c,g[b]])});a.sort(function(a,b){return 0>b[0]?1:b[0]-a[0]});b.remove();g.remove();var k="#hotel-thumbnails";32<f&&(k="#see-more-thumbnails");e.each(a,function(a,b){e(b[1]).prependTo(e(k));e(b[2]).prependTo(e(".jumbo-hero"))});g=e(".jumbo-hero img.hero");g.removeClass("selected").attr("aria-hidden","true");b=g.first();e(b).attr("aria-hidden","false").addClass("selected").attr("src",e(b).attr("data-src"));e.each(e("#hotel-thumbnails").find(".hotel-thumbnail"),function(a,b){var c=e(b);32<f?0===a?c.attr("class","hotel-thumbnail selected"):32<=a?c.attr("class","hotel-thumbnail rm-hide"):20<=a?c.attr("class","hotel-thumbnail desktop"):c.attr("class","hotel-thumbnail"):0===a?c.attr("class","hotel-thumbnail selected"):c.attr("class","hotel-thumbnail")})}c.updateCollections()}}},intervalCallback:function(){b.triesCount++;var c=e("#categoryIds");c&&c.length?(b.order(),clearInterval(b.interval)):30<b.triesCount&&clearInterval(b.interval)},run:function(){1===h[9849]&&(b.interval=setInterval(b.intervalCallback,100))}};return b});define("exp8100","experiments availability search airAttach recommendations standardLayout soldOutLayout offersResponseModel urlModel logger hotelInfo utils".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n){function q(){}var r,s=f.getSingleton(),t=a.getSingleton();return{setLayout:function(){try{s.get("isHotelSoldOut")&&s.errors.set("availabilityErrors",[{messageKey:"roomsUnavailableForSelectedDates"}]),"undefined"!==typeof r&&r instanceof l||(r&&r.destroy(),r=(new l).render())}catch(a){k.logError("view initialization",a,{viewName:l.constructorName})}},run:function(){try{if(1===e["8100"]){c.run=q;h.run=q;d.run=q;b.run=q;if(1==e[11528])s.once("sync",function(){s.get("isHotelSoldOut")&&p.isDeeplink&&n.locationReplace(p.goToSearchUrl+"\x26selected\x3d"+p.id)});s.on("sync error",this.setLayout);this.setLayout();t.isDateless()||s.fetch()}}catch(a){k.logError("HIS_RedirectSoldoutToHSR",a)}}}});
define("exp9367",["jquery","photos","experiments","hammer","infosite"],function(e,h,c,b,d){c=c[9367];var l=.65;1===c?l=.4:2===c&&(l=1);d.evaluateExperimentAndLog(9367);h.bindHammerEvents=function(){var c=e("#toggle-banner").get(0);c&&(c=new b.Manager(c,{recognizers:[[b.Swipe,{direction:b.DIRECTION_HORIZONTAL,threshold:10,velocity:l}]]}),"function"===typeof c.on&&(c.on("swipeleft",function(){h.loadNextImage();d.track("Photo.SwipeLeft",this.context)}),c.on("swiperight",function(){h.loadPreviousImage();d.track("Photo.SwipeRight",this.context)})))}});define("exp9368",["jquery","modernizr","infosite","uitk"],function(e,h,c,b){var d={needToRegisterExperiment:!0,register:function(){d.needToRegisterExperiment&&c.evaluateExperimentAndLog(9368,function(){d.needToRegisterExperiment=!1})}};b.subscribe("modal.appended",function(b,c){if(("payment-choice-modal"===c.options.modalId||"deposit-choice-modal"===c.options.modalId)&&0<c.modalBodyHtml.length&&void 0!==c.modalBodyHtml.first){var f=c.modalBodyHtml.first().find("div[data-etpnights]").data();void 0!==f&&null!==f&&void 0!==f.etpnights&&2<=parseInt(f.etpnights,10)&&d.register()}});return d});define("exp9852","jquery uitk infosite experiments offersResponseModel searchData".split(" "),function(e,h,c,b,d,l){function g(){var a=e("#rooms-and-rates");0<a.length&&n.itemInView(a.first())&&(h.unsubscribe("debounced.scroll",r),p.ratesScroll=!0,p.ratesScroll&&p.datedSearch&&k.register())}function f(b){!0!==b.get("isHotelSoldOut")&&(a.off("change",f),p.datedSearch=!0,p.ratesScroll&&p.datedSearch&&k.register())}var a=d.getSingleton(),k={},p={ratesScroll:!1,datedSearch:!1},n=e(window),q=1===b[8100],r;n.itemInView=function(a){!1===a instanceof e&&(a=e(a));if(0===a.length)return!1;try{var b=this.height(),c=this.scrollTop();return a.offset().top<b+c}catch(d){return!1}};k.isRegistered=!1;k.register=function(){!0!==k.isRegistered&&c.evaluateExperimentAndLog(9852,function(){k.isRegistered=!0})};k.run=function(){if(q)if(a)a.on("change",f);else return;else p.datedSearch=!l.isDatelessSearch;r=h.subscribe("debounced.scroll",g);g()};return k});define("exp9716",["jquery","uitk","roomsAndRates"],function(e,h,c){c.registerExperiment(9716,2,function(){var b=e("body"),c=e("#tab-reviews");b.on(h.clickEvent,".room-review-count",function(){c.trigger(h.clickEvent)})});return{}});define("exp9784","infositeData offersResponseModel experiments infosite jquery uitk i18n".split(" "),function(e,h,c,b,d,l,g){h=h.getSingleton();var f={experimentValue:0,experimentEvaluated:d.Deferred(),renderVariant:function(a){if(0!==this.experimentValue&&!d(a).find(".room-description-menu-bar").hasClass("exp9784-"+this.experimentValue)){d(a).find(".room-description-menu-bar").addClass("exp9784-"+this.experimentValue);if(-1!==d.inArray(this.experimentValue,[1,2,3,4])){d(a).find(".room-basic-info").each(function(a,b){var c=d(b).find(".room-description-menu-bar .menu-trigger .btn-label").text(),c=d('\x3ch3 class\x3d"exp9784-'+f.experimentValue+' room-name"\x3e'+c+"\x3c/h3\x3e"),e=d(b).find(".room-description-menu-bar");d(e).replaceWith(c);d(b).append(e)});var b="";-1!==d.inArray(this.experimentValue,[1,3])?b=g.getMessage("roomtemplates.moreDetails"):-1!==d.inArray(this.experimentValue,[2,4])&&(b=g.getMessage("roomtemplates.showMore"));d(a).find(".room-description-menu-bar .menu-trigger .btn-label").text(b)}-1!==d.inArray(this.experimentValue,[3,4,5])&&(b=d('\x3cspan class\x3d"icon icon-info" aria-hidden\x3d"true"\x3e\x3c/span\x3e'),d(a).find(".room-description-menu-bar .menu-trigger .btn-label").prepend("\x26nbsp;").prepend(b))}}};if(1===c["8100"]){var a=d.Deferred();a.done(function(){d("body").removeClass("exp9784-0");b.evaluateExperimentAndLog(9784,function(a){f.experimentValue=a;f.experimentEvaluated.resolve()})});h.on("change",function(){"resolved"!==f.experimentEvaluated.state()&&(e.isPackageInfosite||a.resolve())});l.subscribe("ajaxroomsandratesrendered",function(a,b){"resolved"===f.experimentEvaluated.state()?f.renderVariant(b.el):f.experimentEvaluated.done(function(){f.renderVariant(b.el)})})}return f});define("exp9864",["uitk","dctk","experiments","jquery"],function(e,h,c,b){var d=c[9864];e.subscribe("infosite.ajaxRecommendationLx.renderCollection",function(c,e){0<d&&(h.onReady(function(){setTimeout(function(){h.trackImpression("HOT.HIS.LXRecsNumActivities."+e.collection.length);b("#lx_item").each(function(){var c=b(this);c.on("click",function(){var a="LX;Merchant LX:"+c.data("lxid")+";;;;eVar59\x3dRecommend:LX:IS";h.trackEvent({prop16:"LX.IS.Recommend",eVar28:"LX.IS.Recommend",Products:a,events:"event92"})})})})}),b("#recommendation-lx").removeClass("hidden"))})});define("recommendationsLxCollection","recommendationsConfig jquery infositeData dctk experiments templates backbone infosite".split(" "),function(e,h,c,b,d,l,g,f){var a=c.isPackageInfosite,k=d[10978];return g.Collection.extend({adaptModel:function(a){var b=this.getUrlToLxInfosite(a.activityId);return{lxName:decodeURIComponent(a.title),lxId:a.activityId,urlToLxInfosite:b,hasThumbnail:"undefined"!==typeof a.images&&0<a.images.length,urlToThumbnail:a.images[0].thumbnail,price:decodeURIComponent(a.fromPrice)}},getUrlToLxInfosite:function(a){return"/things-to-do/a.a"+a+".a?startDate\x3d"+e.startDate+"\x26endDate\x3d"+e.endDate+"\x26rfrr\x3dLX.IS.Hotel-IS"},processData:function(a){for(var b,c={activities:[]},d=0;4>c.activities.length&&d<a.length;)decodeURIComponent(a[d].fromPrice)&&(b=this.adaptModel(a[d]),c.activities.push(b)),d++;return c},handleResponse:function(a){if(!a)return{};(a=a.response)&&1<a.length&&(f.evaluateExperimentAndLog(9864),a=this.processData(a),this.reset(a.activities))},getRecommendations:function(){h.ajax({type:"GET",url:e.ajaxLxURL,dataType:"JSONP",jsonpCallback:"callback",success:h.proxy(this.handleResponse,this),error:function(){}})},run:function(){1===k&&!a&&e.ajaxURL&&1===c.siteId&&this.getRecommendations()}},{getSingleton:function(){this.singleton||(this.singleton=new this);return this.singleton}})});define("recommendationsLxView",["marionette","recommendationsLxCollection","uitk","recommendationsConfig","offersResponseModel"],function(e,h,c,b,d){var l=e.ItemView.extend({template:"recommendations-lx-template",tagName:"article",className:"col tile tile-no-header tile-no-footer"}),g=h.getSingleton(),f=d.getSingleton();return e.CompositeView.extend({initialize:function(){f.get("isHotelSoldOut")||(g.run(),g.listenTo(f,"change",g.run))},collection:g,template:"recommendations-lx",templateHelpers:function(){return{hasActivities:0<this.collection.length,multicityName:b.multicityName,seeAllUrl:decodeURIComponent(b.lxURL)}},collectionEvents:{reset:"render"},childView:l,childViewContainer:".recommendationslx-grid",onRenderCollection:function(){c.publish("infosite.ajaxRecommendationLx.renderCollection",{collection:this.collection,el:this.el})}})});define("exp9904",["infositeData","offersResponseModel","experiments","infosite","jquery"],function(e,h,c,b,d){var l=h.getSingleton(),g=d.Deferred();if(1===c["8100"]){var f=!1;l.on("change",function(){f||e.isPackageInfosite||!1!==l.get("isHotelSoldOut")||!l.leadOffer.get("showETPTooltip")||(f=!0,b.evaluateExperimentAndLog(9904,function(a){g.resolve(a);l.trigger("triggerViewRender")}))})}return g.promise()});define("exp10113",["emailSignUpView"],function(e){return e});
define("emailSignUpView","jquery underscore marionette infositeData experiments hotelInfo dctk/dctk".split(" "),function(e,h,c,b,d,l,g){var f=d[10113],a=null,k=0,p={},n=c.ItemView.extend({template:1===f?"email-sign-up-v1":"email-sign-up-v2",ui:{form:"form",email:'[name\x3d"email"]',thanks:"#thanks-email-modal",close:"#close-email-modal"},events:function(){return{"submit @ui.form":"submit","click @ui.close":"close","focusin @ui.email":h.partial(this.trackOnce,"HOT.HIS.EmailPopUp.EmailAddressField")}},behaviors:{Modal:{modalId:"email-sign-up-modal"}},templateHelpers:function(){return{brandName:b.brandName,location:l.city}},submit:function(a){a.preventDefault();this.trackOnce("HOT.HIS.EmailPopUp.SubmitButton");e.ajax({url:"//www.expedia-email.com/OptIn/DefaultE.aspx",dataType:"html",data:{email_addr:this.ui.email.val(),TPID:b.tpid,EAPID:b.eapid,LANGID:b.langId,CREATE_DATE:"",H_AIRPORT_CODE:"",source_code:"Infosite"}}).always(h.bind(this.showThankYou,this))},showThankYou:function(){this.ui.form.addClass("hidden");this.ui.thanks.removeClass("hidden")},trackOnce:function(a){p[a]||(g.trackAction(a),p[a]=!0)}},{run:function(){f&&(e("*").bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",function(){k=0}),a=window.setInterval(h.bind(this.checkIdleTime,this),1E3))},checkIdleTime:function(){k++;20<=k&&!this.isAnotherModalActive()&&(window.clearInterval(a),this.popModal())},isAnotherModalActive:function(){return!!e(".modal-wrap.active").length},popModal:function(){(new n).render()}});return n});define("exp10184","experiments infosite infositeData uitk recommendations hotelInfo dctk recommendationsConfig recommendationsCollection jquery recommendationsView offersResponseModel".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n){var q={experimentValue:0,experimentEvaluated:k.Deferred(),hasModelDataError:!1,trackRecommendationsError:function(){g.trackEvent("o","NPS API CALL FAILED",{prop16:"NPS API CALL FAILED",eVar28:"NPS API CALL FAILED"})},trackEmptyRecommendationsError:function(){g.trackEvent("o","NPS API NO RECOMMENDATIONS",{prop16:"NPS API NO RECOMMENDATIONS",eVar28:"NPS API NO RECOMMENDATIONS"})},trackMissingReviewRatingError:function(){g.trackEvent("o","NPS API MISSING REVIEW RATING",{prop16:"NPS API MISSING REVIEW RATING",eVar28:"NPS API MISSING REVIEW RATING"})},addFilterToUrl:function(a){return a+"\x26recFilters\x3d-1|guestRating,gte,4"}};if(0===e[8100]){var r=function(a,b){var c=0;b&&(c=parseInt(b,10),isNaN(c)||0>c)&&(c=0);c=Math.pow(10,c);return Math.round(a*c)/c},s=function(a,b){var c=b.recommendations[0].items.hotels;a.hotels.forEach(function(a,b){a.reviewRating=r(parseFloat(c[b].reviewRating),1);a.reviewRecommendationPercentage=r(parseFloat(c[b].reviewRecommendationPercentage),0);a.superlative=c[b].superlatives&&c[b].superlatives.reviewRatingCategory?c[b].superlatives.reviewRatingCategory:"";a.displayReviewRating=!1;a.reviewRating&&a.superlative||(q.hasModelDataError=!0)});q.hasModelDataError?q.trackMissingReviewRatingError():a.hotels.forEach(function(a){a.displayReviewRating=!0});return a};q.run=function(){if(0===e[10184])return!1;d.postProcessData=s;d.recomendUrl=q.addFilterToUrl(d.recomendUrl);d.trackRecommendationsError=q.trackRecommendationsError;d.trackEmptyRecommendationsError=q.trackEmptyRecommendationsError}}else{var t=!1,v=n.getSingleton(),m=a.getSingleton();0!==e[10531]||0!==e[10978]||c.isPackageInfosite||0!==l.ratingCategory||(f.autoFetchCollection=!1,v.on("change",function(){t||(t=!0,k("body").removeClass("exp10184-0"),h.evaluateExperimentAndLog(10184,function(a){q.experimentValue=a;0!==q.experimentValue&&(f.recommendationAjaxUrl=q.addFilterToUrl(f.recommendationAjaxUrl));q.experimentEvaluated.resolve()}))}));var w=function(a){3<q.experimentValue?(k(".exp10184-placeholder-underrooms").show(),a=a.getRegion("alternateRecommendations")):a=a.getRegion("bottom");a&&(a.show(new p),m.listenTo(v,"change",m.fetchRecommender),m.fetchRecommender())};b.subscribe("standardLayout.render",function(a,b){"resolved"===q.experimentEvaluated.state()?w(b):q.experimentEvaluated.done(function(){w(b)})});b.subscribe("infosite.recommendations.recommendationsError",function(){0!==q.experimentValue&&q.trackRecommendationsError()});b.subscribe("infosite.recommendations.emptyRecommendationsError",function(){0!==q.experimentValue&&q.trackEmptyRecommendationsError()});b.subscribe("infosite.ajaxRecommendation.renderCollection",function(a,b){0!==q.experimentValue&&(q.hasModelDataError=b.collection.models.reduce(function(a,b){return a||!b.get("reviewRating")||!b.get("superlative")},!1),q.hasModelDataError?q.trackMissingReviewRatingError():k(b.el).find(".exp10184-hasdataerror").removeClass("exp10184-hasdataerror"))})}return q});define("exp10196",["jquery","modernizr","uitk","experiments","infosite"],function(e,h,c,b,d){var l={},g=e(window);if(1===b[10196]||2===b[10196]){var f=304.8;2===b[10196]&&(f=609.6);c.subscribe("map.appended",function(a,b){if("hotel-map"===b.options.configId){var d=c.map.data["hotel-map"].markerData.markers[0].latlong.split(",");window.latlong=d;window.center={lat:d[0],lng:d[1]};c.map.data["hotel-map"].module.markers[0].setMap(null);new google.maps.Circle({strokeColor:"#616161",strokeOpacity:1,strokeWeight:1,fillColor:"#616161",fillOpacity:.6,map:c.mapObj,center:{lat:parseFloat(d[0]),lng:parseFloat(d[1])},radius:f})}})}g.itemInView=function(a){!1===a instanceof e&&(a=e(a));if(0===a.length)return!1;try{var b=this.height(),c=this.scrollTop(),d=a.offset().top;return"none"!==a.css("display")&&d<b+c}catch(f){return!1}};l.needToRegisterExperiment=!0;l.register=function(){l.needToRegisterExperiment&&d.evaluateExperimentAndLog(10196,function(){l.needToRegisterExperiment=!1})};var a=c.subscribe("debounced.scroll",function(){var b=e(".static-map-link").parent(),d;for(d=0;d<b.length;++d)g.itemInView(b[d])&&(c.unsubscribe("debounced.scroll",a),l.register())});return l});define("exp10228",["jquery","experiments"],function(e,h){1===h["10228"]&&e(function(){e(document).scrollTop(e("#availability-header").offset().top)});return{}});define("exp10255","jquery uitk infosite infositeData experiments offersResponseModel searchData".split(" "),function(e,h,c,b,d,l,g){function f(){n.ratesScroll&&n.datedSearch&&n.hasRoomPhotos&&p.register()}function a(){var a=e("#rooms-and-rates");0<a.length&&q.itemInView(a.first())&&(h.unsubscribe("debounced.scroll",s),n.ratesScroll=!0,f())}function k(a){!0!==a.get("isHotelSoldOut")&&!0===a.get("hasRoomPhotos")&&(v.off("change",k),n.datedSearch=!0,n.hasRoomPhotos=!0,f())}var p={},n={ratesScroll:!1,datedSearch:!1,hasRoomPhotos:!1},q=e(window),r=1===d[8100],s,t=!0===b.isPackageInfosite,v=l.getSingleton();q.itemInView=function(a){!1===a instanceof e&&(a=e(a));if(0===a.length)return!1;try{var b=this.height(),c=this.scrollTop();return a.offset().top<b+c}catch(d){return!1}};p.isRegistered=!1;p.register=function(){!0!==p.isRegistered&&c.evaluateExperimentAndLog(10255,function(){p.isRegistered=!0})};p.run=function(){if(!t){if(r)if(v)v.on("change",k);else return;else n.datedSearch=!g.isDatelessSearch,n.hasRoomPhotos=0<e("div[data-has-thumbnail-url]").length;s=h.subscribe("debounced.scroll",a);a()}};return p});define("exp10270",["jquery","infositeData","recommendationsConfig","experiments","templates"],function(e,h,c,b,d){function l(){try{var a=c.regionId;h.isDateless||h.isPackageInfosite||e.ajax({url:"/ugc/jarvis/api/stackranks/region/"+a+"/hotels/"+h.hotelId,dataType:"json",success:g})}catch(b){require("logger",function(a){a.logError("stackRankDisplayFail",b,{hotelId:h.hotelId})})}}function g(a){if(a.stackranks&&0<a.stackranks.length&&parseInt(a.stackranks[0].hotelId,10)===parseInt(h.hotelId,10)){var b=d["hotel-stack-rank"];a=void 0!==b?b(a.stackranks[0]):"";""!==a&&(1===f||2===f?e("#license-plate .stack-ranking").html(a):3!==f&&4!==f||e(".reviews-summary-box .stack-ranking").html(a))}}var f;return{run:function(){f=b[10270];void 0!==f&&0<f&&l()}}});
define("exp10398","jquery reviews experiments infosite uitk infositeData roomsAndRates".split(" "),function(e,h,c,b,d,l){var g=null,f=c[10398],a=e(window),k=function(b){!1===b instanceof e&&(b=e(b));if(0===b.length)return!1;try{var c=a.height(),d=a.scrollTop();return b.offset().top<c+d}catch(f){return!1}},p={needToRegisterExperiment:!0,register:function(){p.needToRegisterExperiment&&b.evaluateExperimentAndLog(10398,function(){p.needToRegisterExperiment=!1})}},n=function(){e.ajax({url:h.urs.apiURL+"/hotelreviews/hotel/"+l.hotelId+"/summary?_type\x3djson\x26caller\x3dExpedia",dataType:"jsonp",jsonp:"jsonpCallback",success:function(a){try{var b=a.reviewSummaryCollection.reviewSummary;0<b.length&&void 0!==b[0].roomTypeIdCounts&&(g=b[0].roomTypeIdCounts,q(g))}catch(c){require("logger",function(a){a.logError("exp10398",c)})}}})},q=function(a){var b=e(".room-basic-info a.room-level-reviews");e.each(b,function(b,c){var d=e(c),f=d.data("id"),f=a[f];void 0!==f?1===f?d.html("See 1 review"):d.html("See "+f+" reviews"):d.html("")})},r=null;e("body").on(d.clickEvent,".room-level-reviews",function(a){r=e(this).data("id");h.urs.scrollToReviews(a);b.track("HOT.HIS.RoomsAndRates.SeeReviews",this);0===e("#reviews-room-selector").length?d.subscribe("infosite.reviewDetailsRendered",function(){null!==r&&e("#reviews-room-selector").val()!==r&&(e("#reviews-room-selector").val(r).change(),r=null)}):(e("#reviews-room-selector").val(r).change(),r=null)});return{run:function(){function a(){k(e("#rooms-and-rates"))&&(d.unsubscribe("debounced.scroll",b),p.register())}if(!l.isDateless){if(1===f||2===f)0===c[8100]?n():1===c[8100]&&d.subscribe("ajaxroomsandratesrendered",function(){null===g?n():q(g)});var b=d.subscribe("debounced.scroll",a);a()}}}});define("rewardsPrimingView",["jquery","marionette","offersResponseModel","infositeData"],function(e,h,c,b){e=c.getSingleton();return h.ItemView.extend({tagName:"div",className:"rewards-priming",template:"rewards-priming-template",model:e.leadOffer,modelEvents:{change:"render"},serializeData:function(){var c=this.model.toJSON(),e=c.displayExpediaRewards?c.displayExpediaRewards:!1,g=0;c.loyaltyEarnPoints&&e&&(g=c.loyaltyEarnPoints.replace(/[^0-9.]/g,""));var c=!1,f=b.isDateless,a=b.isIdentifiedUser,h=b.isPackageInfosite;!1===b.isSoldOut&&!1===f&&!1===h&&!1===a&&!0===e&&""!==g&&(c=!0);return{rewardsPrimingValue:c,offerHasLoyaltyPoints:e,offerLoyaltyPoints:g}}})});
define("exp10711","jquery reviews experiments infosite infositeData uitk".split(" "),function(e,h,c,b,d,l){var g={},f=e(window),a={7:{rrHeader:"Choose your Accommodation",rrRoomType:"Condo Type",amenityTab:"About the Condo",amenityHeader:"Condo Amenities",policyHeader:"Condo Policies",amenityLinkoff:"Show all condo amenities",amenityLinkoffHide:"Hide condo amenities",propertyName:"Condo Name",otherNameLinkoff:"This condo has other names",priceChange:"We will let you know when prices change for this condo"},9:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Cabin",amenityHeader:"Cabin Amenities",policyHeader:"Cabin Policies",amenityLinkoff:"Show all cabin amenities",amenityLinkoffHide:"Hide cabin amenities",propertyName:"Cabin Name",otherNameLinkoff:"This cabin has other names",priceChange:"We will let you know when prices change for this cabin"},10:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Chalet",amenityHeader:"Chalet Amenities",policyHeader:"Chalet Policies",amenityLinkoff:"Show all chalet amenities",amenityLinkoffHide:"Hide chalet amenities",propertyName:"Chalet Name",otherNameLinkoff:"This chalet has other names",priceChange:"We will let you know when prices change for this chalet"},11:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Cottage",amenityHeader:"Cottage Amenities",policyHeader:"Cottage Policies",amenityLinkoff:"Show all cottage amenities",amenityLinkoffHide:"Hide cottage amenities",propertyName:"Cottage Name",otherNameLinkoff:"This cottage has other names",priceChange:"We will let you know when prices change for this cottage"},14:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Villa",amenityHeader:"Villa Amenities",policyHeader:"Villa Policies",amenityLinkoff:"Show all villa amenities",amenityLinkoffHide:"Hide villa amenities",propertyName:"Villa Name",otherNameLinkoff:"This villa has other names",priceChange:"We will let you know when prices change for this villa"},16:{rrHeader:"Choose your Accommodation",rrRoomType:"Apartment Type",amenityTab:"About the Apartment",amenityHeader:"Apartment Amenities",policyHeader:"Apartment Policies",amenityLinkoff:"Show all apartment amenities",amenityLinkoffHide:"Hide apartment amenities",propertyName:"Apartment Name",otherNameLinkoff:"This apartment has other names",priceChange:"We will let you know when prices change for this apartment"},17:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Home",amenityHeader:"Vacation Home Amenities",policyHeader:"Vacation Home Policies",amenityLinkoff:"Show all vacation home amenities",amenityLinkoffHide:"Hide vacation home amenities",propertyName:"Vacation Home Name",otherNameLinkoff:"This vacation home has other names",priceChange:"We will let you know when prices change for this vacation home"},23:{rrHeader:"Choose your Accommodation",rrRoomType:"Condo Type",amenityTab:"About the Condo",amenityHeader:"Condo Amenities",policyHeader:"Condo Policies",amenityLinkoff:"Show all condo amenities",amenityLinkoffHide:"Hide condo amenities",propertyName:"Condo Name",otherNameLinkoff:"This condo has other names",priceChange:"We will let you know when prices change for this condo"},33:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Residence",amenityHeader:"Residence Amenities",policyHeader:"Residence Policies",amenityLinkoff:"Show all residence amenities",amenityLinkoffHide:"Hide residence amenities",propertyName:"Residence Name",otherNameLinkoff:"This residence has other names",priceChange:"We will let you know when prices change for this residence"},34:{rrHeader:"Choose your Accommodation",rrRoomType:"Property Type",amenityTab:"About the Townhouse",amenityHeader:"Townhouse Amenities",policyHeader:"Townhouse Policies",amenityLinkoff:"Show all townhouse amenities",amenityLinkoffHide:"Hide townhouse amenities",propertyName:"Townhouse Name",otherNameLinkoff:"This townhouse has other names",priceChange:"We will let you know when prices change for this townhouse"}};f.itemInView=function(a){!1===a instanceof e&&(a=e(a));if(0===a.length)return!1;try{var b=this.height(),c=this.scrollTop();return a.offset().top<b+c}catch(d){return!1}};g.needToRegisterExperiment=!0;g.register=function(){g.needToRegisterExperiment&&b.evaluateExperimentAndLog(10711,function(){g.needToRegisterExperiment=!1})};g.run=function(){function b(){f.itemInView(e("#rooms-and-rates"))&&(l.unsubscribe("debounced.scroll",h),g.register())}1===c[10711]&&(e("#hotel-amenities").find(":contains('Hotel Amenities')").each(function(){e(this).text(a[d.structureType].amenityHeader)}),e("#tabs \x3e ul \x3e li:first-of-type").find(":contains('About the Hotel')").each(function(){e(this).text(a[d.structureType].amenityTab)}),e("#policies-and-fees \x3e h2").text(a[d.structureType].policyHeader),e("#policies-and-fees").find(":contains('Hotel Name')").each(function(){e(this).text(a[d.structureType].propertyName)}),e("article").find(":contains('Show all hotel amenities')").children("span").text(a[d.structureType].amenityLinkoff),l.subscribe("toggle.opened",function(b,c){c.find(":contains('Hide hotel amenities')").each(function(){e(this).text(a[d.structureType].amenityLinkoffHide)})}),l.subscribe("toggle.closed",function(b,c){c.find(":contains('Show all hotel amenities')").each(function(){e(this).text(a[d.structureType].amenityLinkoff)})}),e("article").find(":contains('This hotel has other names')").children("span").text(a[d.structureType].otherNameLinkoff),l.subscribe("toggle.closed",function(b,c){c.find(":contains('This hotel has other names')").each(function(){e(this).text(a[d.structureType].otherNameLinkoff)})}),0===c[8100]?(e("#rooms-header #room-type-header").text(a[d.structureType].rrRoomType),e("#availability-header").text(a[d.structureType].rrHeader)):1===c[8100]&&(l.subscribe("ajaxroomsandrates.attach",function(){e("#rooms-header #room-type-header").text(a[d.structureType].rrRoomType);e("#availability-header").text(a[d.structureType].rrHeader)}),l.subscribe("ajaxroomsandrates.domrefresh",function(){e("#rooms-header #room-type-header").text(a[d.structureType].rrRoomType);e("#availability-header").text(a[d.structureType].rrHeader)})));if(void 0!==a[d.structureType]){var h=l.subscribe("debounced.scroll",b);b()}};return g});define("exp10380","jquery experiments uitk searchData shortlistModels backbone shortlistController ShortListToolsView userInfo infositeData infosite offersResponseModel".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n){var q=h[10380],r=1===h[8100],s={},t;s.needToRegisterExperiment=!0;s.register=function(){s.needToRegisterExperiment&&p.evaluateExperimentAndLog(10380,function(){s.needToRegisterExperiment=!1})};s.displayShortlistToolbar=function(){d.shortlistToolbarModel.set({hotelId:k.hotelId});d.wizardModel.set(b);d.travelerModel.set({tuid:a.userTuid,expUserId:a.expUserId});g.updateSavedStatus();t=(new f).render()};s.run=function(){if(void 0!==q)if(!1===r&&!1===b.isDatelessSearch)s.register(),1===q&&s.displayShortlistToolbar();else if(!0===r)n.getSingleton().on("change",function(a){a=void 0===a.get("fromStayDate");!1===a&&!0===s.needToRegisterExperiment&&(s.register(),1===q&&s.displayShortlistToolbar());void 0!==t&&(!1===a?t.$el.show():t.$el.hide())})};return s});
define("ShortListToolsView","ShortlistItemView shortlistController shortlistModels marionette handlebars uitk".split(" "),function(e,h,c,b,d,l){return e.extend({el:"#short-list-tools-container",template:"shortlist_tools",model:c.shortlistToolbarModel,selfTriggeredRender:!1,onDomRefresh:function(){if(!0===this.selfTriggeredRender){var b=this.model.toJSON(),c=this.model.previousAttributes();if(!0===b.isFavorite&&!0!==c.isFavorite){var a=this.$el.find(this.ui.shortListHotelRemove);1===a.length&&l.utils.focusElement(a)}else!1===b.isFavorite&&!0===c.isFavorite&&(a=this.$el.find(this.ui.shortListHotelAdd),1===a.length&&l.utils.focusElement(a));!0===b.isEditing&&!0!==c.isEditing?(b=this.$el.find(this.ui.shortListNoteEntry),1===b.length&&l.utils.focusElement(b)):!1===b.isEditing&&!0===c.isEditing&&(b=this.$el.find(this.ui.shortListNoteEdit).add(this.ui.shortListNoteAdd),1===b.length&&l.utils.focusElement(b));this.selfTriggeredRender=!1}},ui:{shortListHotelAdd:".shortlist-hotel-add",shortListHotelRemove:".shortlist-hotel-remove",shortListNoteAdd:".shortlist-note-add",shortListNoteEdit:".shortlist-note-edit",shortListNoteSave:".shortlist-note-save",shortListNoteCancel:".shortlist-note-cancel",shortListNoteEntry:".shortlist-note-entry"},events:{"click @ui.shortListHotelAdd":"shortListHotelAddHandler","click @ui.shortListHotelRemove":"shortListHotelRemoveHandler","click @ui.shortListNoteAdd":"shortListNoteAddHandler","click @ui.shortListNoteSave":"shortListNoteSaveHandler","click @ui.shortListNoteEdit":"shortListNoteEditHandler","click @ui.shortListNoteCancel":"shortListNoteCancelHandler"},shortListHotelAddHandler:function(b){h.addHotel();this.trackUser("e","user saving hotel","HOT.HIS.Scratchpad.Save","HOT.HIS.Scratchpad.Save");b.preventDefault()},shortListHotelRemoveHandler:function(b){h.removeFromFavoriteHotel();this.trackUser("e","user unsaving hotel","HOT.HIS.Scratchpad.Unsave","HOT.HIS.Scratchpad.Unsave");b.preventDefault()},shortListNoteAddHandler:function(b){this.model.set("isEditing",!0);this.model.set("isFavorite",!0);b.preventDefault()},shortListNoteSaveHandler:function(b){h.addNote(this.ui.shortListNoteEntry.val());this.trackUser("e","user saving hotel note","HOT.HIS.Scratchpad.SaveNote","HOT.HIS.Scratchpad.SaveNote");b.preventDefault()},shortListNoteEditHandler:function(b){this.model.set("isEditing",!0);this.trackUser("e","user added note to hotel","HOT.HIS.Scratchpad.AddNote","HOT.HIS.Scratchpad.AddNote");b.preventDefault()},shortListNoteCancelHandler:function(b){this.model.set("isEditing",!1);b.preventDefault()},trackUser:function(b,c,a,d){require("dctk",function(e){e.trackEvent(b,c,{prop16:a,eVar28:d})})}})});define("ShortlistItemView",["marionette","underscore"],function(e,h){return e.ItemView.extend({modelEvents:{change:"modelChangeHandler"},modelChangeHandler:function(){1===h.keys(this.model.changed).length&&void 0!==this.model.changedAttributes().uid||this.render()}})});define("exp10796","infositeData offersResponseModel experiments infosite jquery templates uitk".split(" "),function(e,h,c,b,d,l,g){var f=h.getSingleton(),a={experimentValue:0,experimentEvaluated:d.Deferred(),render_templates:function(a){if(0!==this.experimentValue){var b={numberOfNights:f.leadOffer.get("numberOfNights"),oneNight:1===f.leadOffer.get("numberOfNights"),classname:"nights-under-price"},c=l["nights-under-price-template"](b);d(a).find(".exp10796-placeholder").replaceWith(c);b.classname="nights-over-lead-price";a=l["nights-under-price-template"](b);a=d('\x3cdiv class\x3d"price-per-night-wrapper"\x3e').append(a).append(d(".exp10796-leadprice-placeholder").html());d(".exp10796-leadprice-placeholder").replaceWith(d("\x3cdiv\x3e").append(a).html())}}};if(1===c["8100"]){var k=d.Deferred();k.done(function(){d("body").removeClass("exp10796-0");b.evaluateExperimentAndLog(10796,function(b){a.experimentValue=b;a.experimentEvaluated.resolve()})});f.on("change",function(){"resolved"!==a.experimentEvaluated.state()&&(e.isPackageInfosite||!1!==f.get("isHotelSoldOut")||k.resolve())});g.subscribe("ajaxroomsandratesrendered",function(b,c){"resolved"===a.experimentEvaluated.state()?a.render_templates(c.el):a.experimentEvaluated.done(function(){a.render_templates(c.el)})})}return a});define("exp10821",["jquery","uitk","infosite"],function(e,h,c){var b=e(".show-map-poi.map"),d=!1,l=h.subscribe("mediaquery.matched",function(g,f){"deviceLessThan491"!==f.key||d||(d=!0,h.unsubscribe("mediaquery.matched",l),c.evaluateExperimentAndLog(10821,function(a){if(1===a){a=b.clone(!0);var c=e(".hotel-overview .map");a.css("display","");b.css("display","");a.insertAfter(c)}}))});h.mediaquery.register("(max-width: 30.6875em)","deviceLessThan491")});define("exp11165","InfositeExperiment jquery uitk infosite experiments templates".split(" "),function(e,h,c,b,d,l){var g=new e({experimentId:11165,$jumplinks:void 0,run:function(){this.addCriteria("isMobile");c.subscribe("mediaquery.matched",this,this.mediaCallback);c.mediaquery.publishAgain();2===this.variant&&c.subscribe("notifier.complete",this,this.notifierCallback)},mediaCallback:function(b,a){if("mobile"===a.key&&(this.passCriteria("isMobile"),this.checkCriteriaAndRegister(),(1===this.variant||2===this.variant)&&void 0===this.$jumplinks)){c.unsubscribe("mediaquery.matched",this.mediaCallback);var d=l["jumplinks-hotels"](),e=h("#availability-header"),n=h("#toggle-banner").find("button.jumbo-image-prev"),q=h("#tabs"),r=h("#tab-details"),s=h("#tab-reviews");this.$jumplinks=h(d).insertAfter(".site-header-primary");h("#choose-link").click(function(){g.scroll(e)});h("#photos-link").click(function(){g.scroll(n)});h("#amenities-link").click(function(){r.click();g.scroll(q)});h("#reviews-link").click(function(){s.click();g.scroll(q)})}},notifierCallback:function(){void 0!==this.$jumplinks&&this.$jumplinks.slideDown()},scroll:function(b){h("html, body").animate({scrollTop:b.offset().top},{duration:300,complete:function(){c.utils.focusElement(b)}})}});return g});define("exp10566","infositeData offersResponseModel experiments infosite jquery uitk i18n".split(" "),function(e,h,c,b,d,l,g){var f=h.getSingleton();if(1===c["8100"]){var a=d.Deferred();a.done(function(){-1===d.inArray(e.locale,"da_DK fi_FI en_IE it_IT nb_NO es_ES es_MX".split(" "))?b.evaluateExperimentAndLog(10566,function(a){k.experimentValue=a;k.experimentEvaluated.resolve()}):b.evaluateExperimentAndLog(10619,function(a){p.experimentValue=a;p.experimentEvaluated.resolve()})});f.on("change",function(){"resolved"!==k.experimentEvaluated.state()&&(e.isPackageInfosite||!1!==f.get("isHotelSoldOut")||a.resolve())});l.subscribe("ajaxroomsandratesrendered",function(){"resolved"===k.experimentEvaluated.state()?k.render_templates():"resolved"===p.experimentEvaluated.state()?p.render_templates():(k.experimentEvaluated.done(function(){k.render_templates()}),p.experimentEvaluated.done(function(){p.render_templates()}))})}var k={experimentValue:0,experimentEvaluated:d.Deferred(),render_templates:function(){if(0!==this.experimentValue){var a;1===this.experimentValue?a=g.getMessage("roomtemplates.iWillreserveButtonText"):2===this.experimentValue&&(a=g.getMessage("roomtemplates.reserveMyRoomButtonText"));d(".exp-10566").text(a);d(".mock-book-button-wrapper .btn-label").text(a)}}},p={experimentValue:0,experimentEvaluated:d.Deferred(),render_templates:function(){if(0!==this.experimentValue){var a;1===this.experimentValue&&(a=g.getMessage("roomtemplates.reserveMyRoomButtonText"));d(".exp-10619").text(a);d(".mock-book-button-wrapper .btn-label").text(a)}}}});
define("exp11060","infositeData offersResponseModel roomCollection experiments infosite roomsAndRatesData jquery templates uitk".split(" "),function(e,h,c,b,d,l,g,f,a){var k=h.getSingleton(),p=c.getSingleton(),n={experimentValue:0,experimentEvaluated:g.Deferred(),render_templates:function(a){if(!(0===this.experimentValue||1>=p.length)){var b=f["average-rate-per-room-template"]({classname:"nights-under-price"});g(a).find(".exp11060-placeholder").replaceWith(b);a=f["average-rate-per-room-template"]({classname:"nights-over-lead-price"});a=g('\x3cdiv class\x3d"price-per-night-wrapper"\x3e').append(a).append(g(".exp11060-leadprice-placeholder").html());g(".exp11060-leadprice-placeholder").replaceWith(g("\x3cdiv\x3e").append(a).html())}}};if(1===b["8100"]){var q=g.Deferred();q.done(function(){g("body").removeClass("exp11060-0");d.evaluateExperimentAndLog(11060,function(a){n.experimentValue=a;n.experimentEvaluated.resolve()})});k.on("change",function(){"resolved"!==n.experimentEvaluated.state()&&!e.isPackageInfosite&&!1===k.get("isHotelSoldOut")&&1<p.length&&q.resolve()});a.subscribe("ajaxroomsandratesrendered",function(a,b){"resolved"===n.experimentEvaluated.state()?n.render_templates(b.el):n.experimentEvaluated.done(function(){n.render_templates(b.el)})})}return n});define("exp11061","infositeData offersResponseModel roomCollection experiments infosite jquery templates uitk".split(" "),function(e,h,c,b,d,l,g,f){var a=h.getSingleton(),k=c.getSingleton(),p={experimentValue:0,experimentEvaluated:l.Deferred(),render_templates:function(b){if(!(0===this.experimentValue||1>=k.length)){var c={numberOfRooms:k.length,numberOfNights:a.leadOffer.attributes.numberOfNights,oneNight:1===a.leadOffer.attributes.numberOfNights,classname:"rooms-and-nights-under-price"},d=g["rooms-and-nights-under-price-template"](c);l(b).find(".exp11061-placeholder").replaceWith(d);c.classname="rooms-and-nights-over-lead-price";b=g["rooms-and-nights-under-price-template"](c);b=l('\x3cdiv class\x3d"price-per-night-wrapper"\x3e').append(b).append(l(".exp11061-leadprice-placeholder").html());l(".exp11061-leadprice-placeholder").replaceWith(l("\x3cdiv\x3e").append(b).html())}}};if(1===b["8100"]){var n=!1;a.on("change",function(){!n&&!e.isPackageInfosite&&!1===a.get("isHotelSoldOut")&&1<k.length&&(n=!0,d.evaluateExperimentAndLog(11061,function(a){p.experimentValue=a;p.experimentEvaluated.resolve()}))});f.subscribe("ajaxroomsandratesrendered",function(a,b){"resolved"===p.experimentEvaluated.state()?p.render_templates(b.el):p.experimentEvaluated.done(function(){p.render_templates(b.el)})})}return p});define("exp10842",["jquery","uitk","infosite","competitors","experiments"],function(e,h,c,b,d){1===d["11110"]&&(d=d["10842"],1!==d&&0!==d||c.evaluateExperimentAndLog(10842),1===d&&(b.makeIntentmediaServiceCall=!0,h.subscribe("intentmedia.impression.success",function(){e("#price-compare-list").removeClass("hidden").html(b.html)}),h.subscribe("intentmedia.impression.failure",function(){document.getElementById("price-compare-list").style.display="none"})));return{}});define("exp11120",["jquery","experiments","uitk","infosite","infosite/env"],function(e,h,c,b,d){var l=h[11120],g=1===h[8100],f=d.isCloud,a={needToRegisterExperiment:!0,register:function(){a.needToRegisterExperiment&&b.evaluateExperimentAndLog(11120,function(){a.needToRegisterExperiment=!1})},run:function(){void 0!==l&&!f&&g&&(a.$showRoomOptionsLink=e(".show-room-options-link"),a.$childrenSelector=e(".children-selector"),a.$travelerAges=e("#traveler-ages"),1===l&&a.registerShowRoomOptionsLinkClick(),c.subscribe("mediaquery.matched",function(b,c){"HISslimChangeSearchMobile"===c.key?(a.register(),1===l&&a.hideTravelerAges()):"HISslimChangeSearchDesktop"===c.key&&1===l&&a.showTravelerAges()}),c.mediaquery.register("(min-width: 20em) and (max-width: 37.4375em)","HISslimChangeSearchMobile"),c.mediaquery.register("(min-width: 37.5em)","HISslimChangeSearchDesktop"))},hideTravelerAges:function(){a.$showRoomOptionsLink.length&&!a.$showRoomOptionsLink.hasClass("hidden")&&a.$travelerAges.hide()},showTravelerAges:function(){a.$childrenSelector.length&&0<parseInt(a.$childrenSelector.val(),10)&&a.$travelerAges.show()},registerShowRoomOptionsLinkClick:function(){if(a.$showRoomOptionsLink.length)a.$showRoomOptionsLink.on("click",function(){e(".traveler-options").show();a.showTravelerAges();e(this).addClass("hidden")})}};return a});define("exp11013","jquery underscore photos experiments hammer handlebars infosite modernizr".split(" "),function(e,h,c,b,d,l,g,f){var a=b[11013],k=e(".jumbo-wrapper").get(0),p=new d(k),n=0,q={},r=[],s=e(k),t=s.find(".hero"),v=s.find("#hotel-thumbnails"),m=v.find(".hotel-thumbnail"),w=function(a){return a.map(function(a,b){return e(b)})},u=w(t),z=w(m);q.updateCollections=function(){k=e(".jumbo-wrapper").get(0);p=new d(k);s=e(k);t=s.find(".hero");v=s.find("#hotel-thumbnails");m=v.find(".hotel-thumbnail");u=w(t);z=w(m)};q.bindEvents=function(){var a=e(document),b=e(window),c=s.find(".jumbo-image-next"),f=s.find(".jumbo-image-prev");a.on("keydown",q.updateGallery);c.on("click",{adv:!0},q.updateGallery);f.on("click",{adv:!1},q.updateGallery);v.on("mouseenter click",".hotel-thumbnail",{thumb:!0},q.updateGallery);b.on("resize",h.debounce(q.updateGallery,250,!0));p.on("panstart panmove panend pancancel",d.bindFn(q.updateGallery,this))};q.gallerySetup=function(){s.addClass("animate");q.updateImagePosition(n)};q.updateCaption=function(a){var b=s.find(".image-caption"),c=u[a];a={photoNumber:a+1,totalNumber:m.length,photoCaption:c.attr("alt"),bookThisRoom:c.attr("id")};a=l.templates["hero-photo-caption"](a);b.html(a)};q.updateGallery=function(a){var b,c;"click"===a.type&&(a.data.thumb?(s.removeClass("animate"),q.updateIndex(null,e(this).index()),s.addClass("animate")):(c=a.data.adv?"HOT.HIS.Photo.Jumbo.FlipRight":"HOT.HIS.Photo.Jumbo.FlipLeft",q.updateIndex(a.data.adv)));"keydown"===a.type&&(37===a.which&&(g.track("HOT.HIS.Photo.Jumbo.FlipLeft"),q.updateIndex()),39===a.which&&(g.track("HOT.HIS.Photo.Jumbo.FlipRight"),q.updateIndex(!0)));"mouseenter"===a.type&&(s.removeClass("animate"),q.updateIndex(null,e(this).index()),s.addClass("animate"));if("panstart"===a.type||"panmove"===a.type)b=100/s.width()*a.deltaX,s.removeClass("animate"),q.updateImagePosition(n,b);if("panend"===a.type||"pancancel"===a.type)b=100/s.width()*a.deltaX,s.addClass("animate"),30<Math.abs(b)?q.updateIndex(0>b):q.updateImagePosition(n),2===a.offsetDirection&&(c="HOT.HIS.Photo.Jumbo.SwipeLeft"),4===a.offsetDirection&&(c="HOT.HIS.Photo.Jumbo.SwipeRight");"resize"===a.type&&(s.removeClass("animate"),q.updateImagePosition(n),s.addClass("animate"));q.updateTracking(c)};q.updateImage=function(a){var b=u[a];t.attr("aria-hidden","false");b.attr("aria-hidden","true");q.updateImagePosition(a)};q.updateImagePosition=function(a,b){for(var c=b||0,d,e=0;e<t.length;e++)t[e].src||(t[e].src=t[e].dataset.src),d=s.width()/100*(100*(e-n)+c),d="translate3d("+d+"px, 0, 0)",t[e].style.opacity=1,t[e].style.webkitTransform=d,t[e].style.transform=d};q.updateIndex=function(a,b){var c=function(a){0===a?a=t.length-1:a--;return a},d=function(a){a===t.length-1?a=0:a++;return a};n=b?b:a?d(n):c(n);q.updateCaption(n);q.updateImage(n);q.updateThumbnails(n)};q.updateThumbnails=function(a){a=z[a];m.removeClass("selected");a.addClass("selected")};q.updateTracking=function(a){a&&-1===e.inArray(a,r)&&(r.push(a),g.track(a))};q.run=function(){f.csstransforms3d&&f.touch&&(g.evaluateExperimentAndLog(11013),1===a&&(c.bindEvents=e.noop(),q.gallerySetup(),q.bindEvents()))};return q});
define("exp11059","jquery experiments infosite infositeData templates uitk urgency offersResponseModel infositeNotifier".split(" "),function(e,h,c,b,d,l,g,f,a){function k(a){if(0!==p.experimentValue){var b=e("#price-trend-container-placeholder-v1");2===p.experimentValue&&(b=e("#price-trend-container-placeholder-v2"));b.empty();var c;if(c=a.status===g.statuscodes.SUCCESS_RESPONSE&&a.response)c=a.response,c=c.hotelTicker&&c.hotelTicker.length&&c.hotelTicker[0].datedPriceTrend&&c.hotelTicker[0].datedPriceTrend.trend&&c.hotelTicker[0].datedPriceTrend.days&&("HIGHEST"===c.hotelTicker[0].datedPriceTrend.trend||"LOWEST"===c.hotelTicker[0].datedPriceTrend.trend)&&1<c.hotelTicker[0].datedPriceTrend.days;c&&(a=a.response.hotelTicker[0].datedPriceTrend,a=d["price-trend-alert-banner"]({trendDays:a.days,trend:a.trend}),b.html(a),b.removeClass("hidden"))}}var p={experimentValue:0,experimentEvaluated:e.Deferred()},n=f.getSingleton();l.subscribe("hotelPriceTrend:arrive",function(a,b){h["11059"]?(p.experimentValue=h["11059"],k(b)):1===h["8100"]&&p.experimentEvaluated.done(function(){k(b)})});if(1===h["8100"]){var q=!1;n.on("change",function(){"resolved"===p.experimentEvaluated.state()?a.getPriceTrendMessages():p.experimentEvaluated.done(function(){a.getPriceTrendMessages()})});var r=function(){q?n.off("change",r):b.isPackageInfosite||!1!==n.get("isHotelSoldOut")||(e("body").removeClass("exp11059-0"),q=!0,c.evaluateExperimentAndLog(11059,function(a){p.experimentValue=a;1===a&&e(".exp11059-0").addClass("exp11059-1").removeClass("exp11059-0");p.experimentEvaluated.resolve()}))};n.on("change",r)}else a.getPriceTrendMessages();return p});define("exp10834",["experiments"],function(e){1===e[10834]&&require("expads",function(e){if(e&&e.extensions&&e.extensions.clingyAds){var c=document.getElementById("RIGHT2"),b=document.getElementById("R2");(c=c||b)&&e.extensions.clingyAds.init("#"+c.id,"#ads-column","#dcol-adsense-container","#site-footer-background")}})});define("exp10894","InfositeExperiment jquery experiments uitk offersResponseModel infositeData".split(" "),function(e,h,c,b,d,l){var g=d.getSingleton();return new e({experimentId:10894,$roomsAndRates:h("#rooms-and-rates"),scrollToken:void 0,roomsScrollCallback:function(){this.itemInView(this.$roomsAndRates)&&(void 0!==this.scrollToken&&b.unsubscribe("debounced.scroll",this,this.scrollToken),this.passCriteria("scrolledRoomsAndRates"),this.checkCriteriaAndRegister())},offersResponseChangeCallback:function(b){var a=b.get("rooms");void 0!==a&&0<a.length&&(b.off("change",this.offersResponseChangeCallback,this),this.passCriteria("hasRoomData"),this.checkCriteriaAndRegister())},expandClickCallback:function(b){this.toggleCardExpand(h(b.currentTarget))},toggleCardExpand:function(c,a){void 0!==a?(c.toggleClass("active",a),c.closest(".room").find("tr.rate-plan").toggleClass("rate-plan-collapse",a)):(c.toggleClass("active"),c.closest(".room").find("tr.rate-plan").toggleClass("rate-plan-collapse"));b.utils.loadMedia()},roomsViewUpdateCallback:function(){var b=h("#rooms-and-rates .room-expand-title");1===this.variant?b.each(h.proxy(function(a,b){this.toggleCardExpand(h(b))},this)):2===this.variant&&0<b.length&&this.toggleCardExpand(b.eq(0))},run:function(){this.addCriteria("scrolledRoomsAndRates","hasRoomData","localeEnUS");"en_US"===l.locale&&this.passCriteria("localeEnUS");this.scrollToken=b.subscribe("debounced.scroll",this,this.roomsScrollCallback);if(void 0!==g)g.on("change",this.offersResponseChangeCallback,this);0<this.variant&&(this.$roomsAndRates.on("click",".room-expand-title",h.proxy(this.expandClickCallback,this)),b.subscribe("ajaxroomsandrates.attach",this,this.roomsViewUpdateCallback),b.subscribe("ajaxroomsandrates.domrefresh",this,this.roomsViewUpdateCallback));this.roomsScrollCallback()}})});define("exp11301","infositeData offersResponseModel experiments infosite jquery urlModel".split(" "),function(e,h,c,b,d,l){var g=h.getSingleton(),f=l.getSingleton(),a=d.Deferred();if(1===c["8100"]){var k=!1,p=function(){if(k)g.off("change",p);else{var c=g.get("rooms").reduce(function(a,b){return a||b.hasRoomView},!1);e.isPackageInfosite||!1!==g.get("isHotelSoldOut")||!c||f.isDateless()||(k=!0,b.evaluateExperimentAndLog(11301,function(b){a.resolve(b);g.trigger("triggerViewRender")}))}};g.on("change",p)}return a.promise()});define("exp11268","jquery experiments infosite infositeData urlModel offersResponseModel exp11268View".split(" "),function(e,h,c,b,d,l,g){function f(b){b=b.DRRDiscount&&b.DRRDiscount.descriptionId;if(443===b||445===b)c.evaluateExperimentAndLog(a.experiment),0<a.variant&&(new g).render()}var a={experiment:11268};a.variant=h[a.experiment];var k=d.getSingleton(),p=l.getSingleton();return{run:function(){if(!(b.isPackageInfosite||b.isDateless||b.isIdentifiedUser||b.isAuthenticatedUser)&&5===b.marketChannel)p.on("change",function(){if(p.get("isThereABookableOffer")){var a=b.hotelId,c=k.getCheckIn(),d=k.getCheckOut();e.ajax("api/hotels/pricehotel/"+a+"?start\x3d"+c+"\x26end\x3d"+d+"\x26channel\x3d2",{type:"GET",cache:!1,dataType:"json",success:f})}})}}});define("exp11268View","marionette jquery experiments uitk infositeData dctk exp11268FormValidator".split(" "),function(e,h,c,b,d,l,g){var f;f=c[11268];var a=e.ItemView.extend({template:"mer-signup-module"}),k=e.ItemView.extend({initialize:function(){2===f&&b.subscribe("toggle.opened",this.focus)},template:"mer-signup-banner",ui:{signupLink:".mer-signup-link",toggle:"#mer-banner-toggle"},events:{"click @ui.signupLink":"goToForm"},templateHelpers:function(){return{isVariant2:2===f}},goToForm:function(){2===f?this.ui.toggle.uitk_toggle("toggle"):this.focus()},focus:function(a,b){1!==f&&"mer-banner-toggle"!==b.context.id||h("#mer-email-input")[0].focus()}});return e.LayoutView.extend({el:"body",template:!1,ui:{module:"#mer-signup-module",banner:"#mer-signup-banner",email:"#mer-email-input",submit:"#mer-form-submit",signinLink:".mer-signin-link"},regions:{module:"@ui.module",banner:"@ui.banner"},events:{"keyup @ui.email":"submitIfEnterKey","click @ui.submit":"submit","click @ui.signinLink":"appendRedirectionUrl"},onRender:function(){1===f&&this.getRegion("module").show(new a);this.getRegion("banner").show(new k);g.hideError()},submitIfEnterKey:function(a){13===a.keyCode&&this.submit()},submit:function(){var a=h("#mer-email-input").val();if(g.validate(a)){var a="//www.expedia-email.com/OptIn/DefaultE.aspx?email_addr\x3d"+a+"\x26TPID\x3d"+window.tpid+"\x26EAPID\x3d"+window.eapid+"\x26LANG_ID\x3d"+d.langId+"\x26P/CREATE_DATE\x3d"+(new Date).getTime()+"\x26P/H_AIRPORT_CODE\x3d999\x26source_code\x3dPriceAlerts",b=this;h.ajax({type:"POST",url:a,dataType:"html",complete:function(){window.location.search=b.getQueryStringWithNewMctc("2")}})}},getQueryStringWithNewMctc:function(a){var b=/([?&])mctc=.*?(&|$)/i;return b.test(window.location.search)?window.location.search.replace(b,"$1mctc\x3d"+a+"$2"):window.location.search+(0<window.location.search.length?"\x26":"?")+"mctc\x3d"+a},appendRedirectionUrl:function(){var a=window.location.pathname+this.getQueryStringWithNewMctc("-1")+window.location.hash,a="/user/signin?ckoflag\x3d0\x26uurl\x3d"+encodeURIComponent("e3id\x3dredr\x26rurl\x3d"+a);window.location.href=a.replace(/\'/g,"").replace(/\"/g,"")}})});define("exp11268FormValidator",["jquery","uitk"],function(e,h){return{validate:function(c){(c=/^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i.test(c))?this.hideError():this.showError();return c},showError:function(){e("#mer-email-input").parent().addClass("invalid");e("#mer-email-invalid").removeClass("visuallyhidden");h.utils.liveAnnounce("Please enter a valid email address")},hideError:function(){e("#mer-email-input").parent().removeClass("invalid");e("#mer-email-invalid").addClass("visuallyhidden")}}});
define("exp11357",["InfositeExperiment","jquery","uitk","underscore"],function(e,h,c,b){return new e({experimentId:11357,$moveRecommender:void 0,run:function(){this.addCriteria("isTrivago");if(0<this.variant&&this.checkIsTrivago()){this.passCriteria("isTrivago");this.checkCriteriaAndRegister();c.subscribe("infosite.ajaxRecommendation.domRefresh",this,b.debounce(this.recommendCallback,200));var d=h("#recommendation").addClass("moveRecommender");1!==this.variant&&3!==this.variant||h("#rooms-and-rates").before(d);2!==this.variant&&4!==this.variant||h("#rooms-and-rates").after(d)}},recommendCallback:function(){1!==this.variant&&2!==this.variant||h("#recommendations-slider").uitk_contentSlider()},checkIsTrivago:function(){var b=this.getParams();return void 0!==b.mdpcid&&0<=b.mdpcid.indexOf("TRIVAGO")},getParams:function(){var c=location.search.split("?")[1];return b.isUndefined(c)?{}:b.chain(c.split("\x26")).map(function(b){if(b)return b.split("\x3d")}).compact().object().value()}})});define("exp11419",["infosite","jquery","uitk"],function(e,h,c){c=c.mediaquery.getMediaQueries();c.desktop&&c.desktop.matches||e.evaluateExperimentAndLog(11419,function(b){if(2==b){b=h(".poi-map-link:not(.hidden):not(.poi-right-column)");var c=h(".poi-map-link.hidden:not(.poi-right-column)");b.addClass("hidden");c.removeClass("hidden")}})});define("exp11369","jquery infositeData infosite uitk utils experiments templates offersResponseModel".split(" "),function(e,h,c,b,d,l,g,f){var a=!1;d=-1<window.location.href.indexOf("rfrr\x3dpage.Global-Merch");var k="true"===b.readCookie("isUserNavigatedFromGMT"),p=d||k;return{run:function(){f.getSingleton().on("change",function(d){var f="en_US"===h.locale,k=h.isCouponBlacklisted;d=!0===d.leadOffer.get("airAttach");var s=h.isPackageInfosite,t=void 0!==l[11369];f&&p&&!k&&!d&&!s&&t&&(f=1===l[11369],k={couponCode:"SUMMER10",couponDiscount:"10%",termsAndConditionLink:"https://www.expedia.com/g/rf/summer10#page-tandc"},d={couponCode:"SUMMERTIME",couponDiscount:"15%",termsAndConditionLink:"https://www.orbitz.com/g/rf/summertime-15percent-coupon-terms#simpleBox"},s={couponCode:"SUMMERSAVINGS",couponDiscount:"15%",termsAndConditionLink:"https://www.travelocity.com/g/rf/summersavings#simpleBox"},k=1===h.siteId?k:70201===h.siteId?d:80001===h.siteId?s:null,f&&!a&&null!==k&&(f=g["coupon-info-template"],f=void 0!==f?f(k):"",""!==f&&(e(".sub-header").css("margin-bottom",0),e("#couponMVPContainer").html(f))),p&&!a&&null!==k&&("true"!==b.readCookie("isUserNavigatedFromGMT")&&b.createCookie("isUserNavigatedFromGMT","true",0),c.evaluateExperimentAndLog(11369),a=!0))})}}});define("shortlistService","jquery underscore uitk shortlistModels shortlistConfig dctk shortlistToolbarModel userHistoryService deferredUtils".split(" "),function(e,h,c,b,d,l,g,f,a){function k(a,b){var c=[];if(!a||0===a.length)return c;for(var d=0;d<b;d++){var e=a[d].childAges,f="",f=f+a[d].adults;e&&0<e.length&&(f+=h.reduce(e,function(a,b){return a+","+b},""));c.push(f)}return c}function p(a,c){var d=b.wizardModel,e=k(d.get("rooms"),d.get("selRoomIndex")),e=h.map(e,function(a,b){return"room"+(b+1)+"\x3d"+a}),e=h.reduce(e,function(a,b){return a+b+"\x26"},""),f=d.get("checkInISO"),d=d.get("checkOutISO");return"/m/api/hotel/offers?hotelId\x3d"+a+"\x26"+("checkInDate\x3d"+f+"\x26checkOutDate\x3d"+d+"\x26"+e)+"\x26favorite\x3d"+c}var n=Error("Invalid response from service");c=function(){};c.prototype.saveFavoriteHotel=function(b){b=p(b,!0);return e.ajax(b).then(a.isValid(function(a){return a.errors&&0<a.errors.length?(a=e.map(a.errors,function(a){return a.errorCode}),-1<e.inArray("HOTEL_ROOM_UNAVAILABLE",a)):!0},n))};c.prototype.removeFromFavoriteHotel=function(b){b=p(b,!1);return e.ajax(b).then(a.isValid(function(a){return a.errors&&0<a.errors.length?!1:!0},n))};c.prototype.search=function(c,f){function g(){var a="off",c=b.travelerModel.get("isRewardsMember");b.swpToggleModel.get("swpToggledOn")&&c&&(a="on");return a}if(0<f.length){var k=d.dataUrl;c+="\x26group\x3d"+h.reduce(f,function(a,b){return a+","+b});c+="\x26hashParam\x3d"+d.hashParam+"\x26useRewards\x3d"+g();return e.ajax(k,{type:"POST",data:c,cache:!1}).then(function(a){return a.results},function(){return[]})}return a.resolveDeferred([])};return new c});define("geoService",["jquery"],function(e){function h(){}var c=new h;h.prototype.getRegion=function(b){return e.getJSON("/api/geo/getregion/"+b)};h.prototype.getParentRegion=function(b){return e.getJSON("/api/geo/getparentmc/"+b)};h.prototype.getChildrenRegion=function(b){return e.getJSON("/api/geo/getchildren/"+b)};return c});define("userHistoryService","jquery underscore shortlistConfig dctk logger shortlistModels deferredUtils".split(" "),function(e,h,c,b,d,l,g){function f(a){var b="";a=k.exec(a);null!==a&&6===a.length&&(a.shift(),b=a.join("-"));return b}function a(a){this.options=h.extend(p,a)}var k=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/m,p={siteId:1,isOverrideGuid:!1,domain:"userhistory-web.us-east-1.prod.expedia.com",path:"/userHistory/jsonp",limit:0,lob:"HOTEL_DETAIL"};Date.prototype.toISOString||function(){function a(b){return 10>b?"0"+b:b}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1E3).toFixed(3).slice(2,5)+"Z"}}();c=new a({siteId:c.siteId,domain:c.userHistoryServiceUrl});a.prototype.getUserHistory=function(){var a,c,h;c=l.travelerModel.get("tuid");h=l.travelerModel.get("expUserId");a=this.options.isOverrideGuid?this.options.guid:f(b.logging.guid);a=this.url(a,c,h);return e.ajax({url:a,dataType:"jsonp"}).then(g.isValid(function(a){return!("undefined"===typeof a||"undefined"===typeof a.responsestatus||"SUCCESS"!==a.responsestatus.status&&"NODATAFOUND"!==a.responsestatus.status)})).fail(function(a){d.logError("[USERHISTORY] Failed or invalid response",a)})};a.prototype.getFilteredUserHistory=function(){return this.getUserHistory().then(this.processResponse)};a.prototype._processResponse=function(a,b){b=b.concat(l.neighborhoodCollection.map(function(a){return a.id}));var c=l.wizardModel,d=c.get("regionId"),e=c.get("checkInISO"),f=c.get("checkOutISO");return h.filter(a.userhistory,function(a){var c=(new Date(a.checkindate)).toISOString().slice(0,10),g=(new Date(a.checkoutdate)).toISOString().slice(0,10),k=a.regionId.toString(),l=!1;"undefined"!==typeof b&&null!==b&&0<b.length&&(l=-1<h.indexOf(b,k));k=d===k||l;c=e===c&&f===g;return"DETAIL"===a.type&&k&&c})};a.prototype.processResponse=e.proxy(a.prototype._processResponse,c);a.prototype.url=function(a,b,c){var d="";return d=void 0!==b&&void 0!==c&&"-1"!==c?this.options.domain+this.options.path+"?tuid\x3d"+b+"\x26expuserid\x3d"+c+"\x26siteid\x3d"+this.options.siteId+"\x26lobs\x3d"+this.options.lob+"\x26limit\x3d"+this.options.limit+"\x26format\x3djsonp":this.options.domain+this.options.path+"?guid\x3d"+a+"\x26siteid\x3d"+this.options.siteId+"\x26lobs\x3d"+this.options.lob+"\x26limit\x3d"+this.options.limit+"\x26format\x3djsonp"};return c});
define("scratchpadService",["jquery","logger","deferredUtils"],function(e,h,c){function b(){}function d(b){return b.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(b).replace("(","").replace(")","").replace("[","").replace("]","").replace("{","").replace("}","").replace("\x3c","").replace("\x3e","").replace("\x3d","")})}function l(b){var a=[];b=b.replace(/[<>]+/g,"");var c=b.length-1;for(c;0<=c;c--)a.unshift(["\x26#",b[c].charCodeAt(),";"].join(""));return a.join("")}var g=Error("Invalid request");h=new b;b.prototype.addNote=function(b,a){if("undefined"===typeof b||null===b||""===b||"undefined"===typeof a||null===a)return c.errorDeferred(g);var h={uid:b,note:d(l(a))};return e.ajax("/scratchpad/addnote",{type:"POST",data:h}).then(c.isValid(function(a){return!0===a}))};b.prototype.removeHotel=function(b){return"undefined"===typeof b||null===b||""===b?c.errorDeferred(g):e.ajax("/scratchpad/clearactivity",{type:"POST",data:{uid:b}}).then(c.isValid(function(a){return!0===a}))};b.prototype.clearShortlist=function(b){return"undefined"===typeof b||null===b||""===b?c.errorDeferred(g):e.ajax("/scratchpad/clearviewedhotels",{type:"POST",data:{uid:b}}).then(c.isValid(function(a){return!0===a}))};return h});define("deferredUtils",["jquery"],function(e){var h=Error("Failed condition check");return{isValid:function(c,b){return function(d){var l=c(d),g=b||h;return e.Deferred(function(b){return l?b.resolve(d):b.reject(g)}).promise()}},errorDeferred:function(c){return e.Deferred(function(b){return b.reject(c||h)})},resolveDeferred:function(c){return e.Deferred(function(b){return b.resolve(c||{})})},delay:function(c){return function(b){var d=e.Deferred();setTimeout(function(){d.resolveWith(this,[b])},c);return d}}}});define("shortlistToolbarModel",["backbone"],function(e){return e.Model.extend({defaults:{uid:"",hotelId:"0",hotelName:"",note:"",isFavorite:!1,isEditing:!1,timestamp:0}})});define("shortlistController","jquery uitk underscore logger shortlistModels utils infositeData hotelInfo deferredUtils userHistoryService geoService shortlistService scratchpadService".split(" "),function(e,h,c,b,d,l,g,f,a,k,p,n,q){function r(){this.hotelId=g.hotelId;this.shortlistToolbarModel=d.shortlistToolbarModel;this.$shortlistToolsContainer=e("#short-list-tools-container")}var s=new r;r.prototype.addHotel=function(){b.logMessage("Add hotel to favorites",{hotelId:this.hotelId});this.shortlistToolbarModel.set({isFavorite:!0});return n.saveFavoriteHotel(this.hotelId).then(function(){b.logMessage("Added hotel to favorites");return s.updateSavedStatus()}).fail(function(a){b.logError("Failed to save hotel as favorite",a)})};r.prototype.removeFromFavoriteHotel=function(){b.logMessage("Remove hotel from favorites",{hotelId:this.hotelId});this.shortlistToolbarModel.set({isFavorite:!1});n.removeFromFavoriteHotel(this.hotelId).then(function(){b.logMessage("Removed favorite flag...")}).fail(function(a){b.logError("Failed to remove hotel from favorites",a)})};r.prototype.addNote=function(c){function d(){q.addNote(e.get("uid"),c).then(function(a){b.logMessage("Successfully added a note to a new favorite hotel");return a},function(a){b.logError("Failed to add note to hotel",a)})}b.logMessage("Add note to hotel",{hotelId:this.hotelId,note:c});var e=this.shortlistToolbarModel;e.set({note:c,isEditing:!1});e.get("isFavorite")?d():s.addHotel(this.hotelId).then(a.delay(200)).then(function(){d()})};r.prototype.updateSavedStatus=function(){function a(b){c.filter(b,function(a){var b=-1<e.inArray("favorite",a.tags)||d.shortlistToolbarModel.get("isFavorite"),c=a.hotelid.toString();if(c===d.hotelId){var f=d.shortlistToolbarModel.get("note");void 0!==a.notes&&null!==a.notes&&0<a.notes.length&&(f=a.notes[0].note);d.shortlistToolbarModel.set({hotelId:c,note:f,uid:a._id,isFavorite:b})}})}b.logMessage("Fetching user history");var d=this,g=k.getUserHistory();return e.when(g).then(function(c){c=k.processResponse(c,[f.cityRegionId.toString()]);b.logMessage("User history",{favoriteHotels:c});a(c);d.$shortlistToolsContainer.removeClass("hidden")},function(){b.logMessage("Failed retrieving user history or child regions",{args:arguments})})};return s});define("shortlistModels",["backbone","shortlistToolbarModel"],function(e,h){return{shortlistToolbarModel:new h,wizardModel:new e.Model,travelerModel:new e.Model,neighborhoodCollection:new e.Collection,swpToggleModel:new e.Model}});define("shortlistConfig",["infositeData"],function(e){return{siteId:e.siteId,userHistoryServiceUrl:e.userHistoryServiceUrl}});define("allExperiments",["underscore","logger"],function(e,h){return{run:function(){e.each("legacyExperiments exp9784 exp10184 exp10566 exp10796 exp11060 exp11061 exp9904 exp11059 exp11301 exp11419 exp8100 exp8494 exp9083 exp9367 exp9368 exp9590 exp9852 exp9716 exp9864 exp10113 exp10196 exp10228 exp10255 exp10398 exp10270 exp10380 exp10711 exp10821 exp10842 exp11013 exp11120 exp9849 exp11165 exp10834 exp10894 exp11268 exp11357 exp11369".split(" "),function(c){try{var b=require(c);if(b)"function"===typeof b.run&&b.run();else throw Error("dependencies not met: "+c);}catch(d){h.logError("experiment",d,{experiment:c})}})}}});define("liveCodeReporter",["underscore","logger","roomsAndRates"],function(e,h,c){return{run:function(){c.handleChoiceSelection=e.wrap(c.handleChoiceSelection,function(b){b._logged||(h.logMessage("liveCodeReporter",{method:"roomsAndRates.handleChoiceSelection"}),b._logged=!0);return b.apply(c,Array.prototype.splice.call(arguments,1))})}}});
//# sourceMappingURL=infosite-script.js.map